<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL 进阶教程（二）数据库约束详解 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL 进阶教程（二）数据库约束详解数据库约束用于保证数据的完整性、一致性和有效性。本文将详细讲解 MySQL 中的各种约束类型及其使用方法。 一、约束概述1.1 什么是约束？约束（Constraint） 是施加在数据库表上的规则，用于限制可以存储在表中的数据，确保数据的准确性和可靠性。 1.2 约束的作用 保证数据完整性：防止无效或不一致的数据 维护数据一致性：确保相关表之间的数据关系正确">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 进阶教程（二）数据库约束详解">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="MySQL 进阶教程（二）数据库约束详解数据库约束用于保证数据的完整性、一致性和有效性。本文将详细讲解 MySQL 中的各种约束类型及其使用方法。 一、约束概述1.1 什么是约束？约束（Constraint） 是施加在数据库表上的规则，用于限制可以存储在表中的数据，确保数据的准确性和可靠性。 1.2 约束的作用 保证数据完整性：防止无效或不一致的数据 维护数据一致性：确保相关表之间的数据关系正确">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-23T08:00:00.000Z">
<meta property="article:modified_time" content="2026-02-23T03:54:22.133Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="外键">
<meta property="article:tag" content="约束">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL 进阶教程（二）数据库约束详解",
  "url": "https://brian-lin-c.github.io/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-23T08:00:00.000Z",
  "dateModified": "2026-02-23T03:54:22.133Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 进阶教程（二）数据库约束详解',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL 进阶教程（二）数据库约束详解</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 进阶教程（二）数据库约束详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-23T08:00:00.000Z" title="发表于 2026-02-23 16:00:00">2026-02-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-23T03:54:22.133Z" title="更新于 2026-02-23 11:54:22">2026-02-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL-%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B/">MySQL 进阶教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">4.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MySQL-进阶教程（二）数据库约束详解"><a href="#MySQL-进阶教程（二）数据库约束详解" class="headerlink" title="MySQL 进阶教程（二）数据库约束详解"></a>MySQL 进阶教程（二）数据库约束详解</h1><p>数据库约束用于保证数据的完整性、一致性和有效性。本文将详细讲解 MySQL 中的各种约束类型及其使用方法。</p>
<h2 id="一、约束概述"><a href="#一、约束概述" class="headerlink" title="一、约束概述"></a>一、约束概述</h2><h3 id="1-1-什么是约束？"><a href="#1-1-什么是约束？" class="headerlink" title="1.1 什么是约束？"></a>1.1 什么是约束？</h3><p><strong>约束（Constraint）</strong> 是施加在数据库表上的规则，用于限制可以存储在表中的数据，确保数据的准确性和可靠性。</p>
<h3 id="1-2-约束的作用"><a href="#1-2-约束的作用" class="headerlink" title="1.2 约束的作用"></a>1.2 约束的作用</h3><ol>
<li><strong>保证数据完整性</strong>：防止无效或不一致的数据</li>
<li><strong>维护数据一致性</strong>：确保相关表之间的数据关系正确</li>
<li><strong>提高数据质量</strong>：强制执行业务规则</li>
<li><strong>减少应用层验证</strong>：在数据库层面进行数据验证</li>
</ol>
<h3 id="1-3-约束的分类"><a href="#1-3-约束的分类" class="headerlink" title="1.3 约束的分类"></a>1.3 约束的分类</h3><table>
<thead>
<tr>
<th>约束类型</th>
<th>关键字</th>
<th>说明</th>
<th>列级&#x2F;表级</th>
</tr>
</thead>
<tbody><tr>
<td>主键约束</td>
<td>PRIMARY KEY</td>
<td>唯一标识每条记录</td>
<td>两者</td>
</tr>
<tr>
<td>外键约束</td>
<td>FOREIGN KEY</td>
<td>建立表与表之间的关系</td>
<td>表级</td>
</tr>
<tr>
<td>唯一约束</td>
<td>UNIQUE</td>
<td>列值必须唯一</td>
<td>两者</td>
</tr>
<tr>
<td>非空约束</td>
<td>NOT NULL</td>
<td>列值不能为空</td>
<td>列级</td>
</tr>
<tr>
<td>默认约束</td>
<td>DEFAULT</td>
<td>列的默认值</td>
<td>列级</td>
</tr>
<tr>
<td>检查约束</td>
<td>CHECK</td>
<td>满足指定条件</td>
<td>表级</td>
</tr>
</tbody></table>
<h3 id="1-4-约束的定义时机"><a href="#1-4-约束的定义时机" class="headerlink" title="1.4 约束的定义时机"></a>1.4 约束的定义时机</h3><ul>
<li><strong>列级约束</strong>：在定义列时指定，直接跟在列名后面</li>
<li><strong>表级约束</strong>：在所有列定义完成后，在表末尾指定</li>
</ul>
<h2 id="二、约束演示"><a href="#二、约束演示" class="headerlink" title="二、约束演示"></a>二、约束演示</h2><h3 id="2-1-创建表时添加约束"><a href="#2-1-创建表时添加约束" class="headerlink" title="2.1 创建表时添加约束"></a>2.1 创建表时添加约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 完整示例：员工表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    <span class="comment">-- 主键约束</span></span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;员工 ID&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 非空约束</span></span><br><span class="line">    emp_no <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;员工编号&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 非空 + 唯一约束</span></span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span> COMMENT <span class="string">&#x27;邮箱&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 默认约束</span></span><br><span class="line">    gender ENUM(<span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;女&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span> COMMENT <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">    status TINYINT <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;状态：1 在职 0 离职&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 检查约束（MySQL 8.0.16+ 支持）</span></span><br><span class="line">    age TINYINT <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">65</span>) COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">CHECK</span> (salary <span class="operator">&gt;=</span> <span class="number">0</span>) COMMENT <span class="string">&#x27;工资&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 日期约束</span></span><br><span class="line">    hire_date <span class="type">DATE</span> <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;入职日期&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;员工表&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-2-表级约束语法"><a href="#2-2-表级约束语法" class="headerlink" title="2.2 表级约束语法"></a>2.2 表级约束语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">    emp_no <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    dept_id <span class="type">INT</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 表级约束（使用 CONSTRAINT 命名）</span></span><br><span class="line">    <span class="keyword">CONSTRAINT</span> pk_employees <span class="keyword">PRIMARY KEY</span> (id),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_employees_emp_no <span class="keyword">UNIQUE</span> (emp_no),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_employees_email <span class="keyword">UNIQUE</span> (email),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_employees_age <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">65</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_employees_salary <span class="keyword">CHECK</span> (salary <span class="operator">&gt;=</span> <span class="number">0</span>)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>

<p><strong>约束命名规范</strong>：</p>
<ul>
<li>主键约束：<code>pk_表名</code> 或 <code>pk_表名_列名</code></li>
<li>外键约束：<code>fk_表名_关联表名</code> 或 <code>fk_表名_列名</code></li>
<li>唯一约束：<code>uk_表名_列名</code></li>
<li>检查约束：<code>chk_表名_列名</code></li>
</ul>
<h3 id="2-3-修改表添加约束"><a href="#2-3-修改表添加约束" class="headerlink" title="2.3 修改表添加约束"></a>2.3 修改表添加约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加主键约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">ADD</span> <span class="keyword">PRIMARY KEY</span> (id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加唯一约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> (emp_no);</span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">ADD CONSTRAINT</span> uk_email <span class="keyword">UNIQUE</span> (email);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加非空约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees MODIFY <span class="keyword">COLUMN</span> name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加默认约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> status <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> status <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加检查约束（MySQL 8.0.16+）</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">ADD CONSTRAINT</span> chk_age <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">65</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">DROP</span> <span class="keyword">PRIMARY KEY</span>;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">DROP</span> INDEX uk_email;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">DROP</span> <span class="keyword">CHECK</span> chk_age;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-查看约束信息"><a href="#2-4-查看约束信息" class="headerlink" title="2.4 查看约束信息"></a>2.4 查看约束信息</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看表结构（显示约束）</span></span><br><span class="line"><span class="keyword">DESC</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看详细表结构</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE TABLE</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看表的所有约束</span></span><br><span class="line"><span class="keyword">SELECT</span> CONSTRAINT_NAME, CONSTRAINT_TYPE, TABLE_NAME</span><br><span class="line"><span class="keyword">FROM</span> information_schema.TABLE_CONSTRAINTS</span><br><span class="line"><span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> <span class="string">&#x27;your_database&#x27;</span> <span class="keyword">AND</span> TABLE_NAME <span class="operator">=</span> <span class="string">&#x27;employees&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看外键约束</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    CONSTRAINT_NAME,</span><br><span class="line">    TABLE_NAME,</span><br><span class="line">    COLUMN_NAME,</span><br><span class="line">    REFERENCED_TABLE_NAME,</span><br><span class="line">    REFERENCED_COLUMN_NAME</span><br><span class="line"><span class="keyword">FROM</span> information_schema.KEY_COLUMN_USAGE</span><br><span class="line"><span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> <span class="string">&#x27;your_database&#x27;</span> <span class="keyword">AND</span> TABLE_NAME <span class="operator">=</span> <span class="string">&#x27;employees&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> REFERENCED_TABLE_NAME <span class="keyword">IS</span> <span class="keyword">NOT NULL</span>;</span><br></pre></td></tr></table></figure>

<h2 id="三、主键约束（PRIMARY-KEY）"><a href="#三、主键约束（PRIMARY-KEY）" class="headerlink" title="三、主键约束（PRIMARY KEY）"></a>三、主键约束（PRIMARY KEY）</h2><h3 id="3-1-主键的特点"><a href="#3-1-主键的特点" class="headerlink" title="3.1 主键的特点"></a>3.1 主键的特点</h3><ol>
<li><strong>唯一性</strong>：主键值必须唯一</li>
<li><strong>非空性</strong>：主键值不能为 NULL</li>
<li><strong>单一性</strong>：一张表只能有一个主键</li>
<li><strong>可组合</strong>：主键可以由多列组成（复合主键）</li>
</ol>
<h3 id="3-2-创建主键"><a href="#3-2-创建主键" class="headerlink" title="3.2 创建主键"></a>3.2 创建主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单列主键</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 CONSTRAINT 命名</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> pk_users <span class="keyword">PRIMARY KEY</span> (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 复合主键（不推荐，建议使用单列主键）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> order_items (</span><br><span class="line">    order_id <span class="type">INT</span>,</span><br><span class="line">    product_id <span class="type">INT</span>,</span><br><span class="line">    quantity <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">PRIMARY KEY</span> (order_id, product_id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 自增主键（最常用）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="3-3-修改主键"><a href="#3-3-修改主键" class="headerlink" title="3.3 修改主键"></a>3.3 修改主键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加主键</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">ADD</span> <span class="keyword">PRIMARY KEY</span> (id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除主键</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">DROP</span> <span class="keyword">PRIMARY KEY</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改主键（先删除再添加）</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">DROP</span> <span class="keyword">PRIMARY KEY</span>;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">ADD</span> <span class="keyword">PRIMARY KEY</span> (new_id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改为复合主键</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> order_items</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">PRIMARY KEY</span> (order_id, product_id);</span><br></pre></td></tr></table></figure>

<h3 id="3-4-主键选择建议"><a href="#3-4-主键选择建议" class="headerlink" title="3.4 主键选择建议"></a>3.4 主键选择建议</h3><ol>
<li><strong>使用无业务意义的列</strong>：如自增 ID、UUID</li>
<li><strong>避免使用业务字段</strong>：如身份证号、手机号可能变化</li>
<li><strong>优先使用单列主键</strong>：简化外键引用</li>
<li><strong>避免使用过长主键</strong>：影响索引性能</li>
</ol>
<h2 id="四、唯一约束（UNIQUE）"><a href="#四、唯一约束（UNIQUE）" class="headerlink" title="四、唯一约束（UNIQUE）"></a>四、唯一约束（UNIQUE）</h2><h3 id="4-1-唯一约束的特点"><a href="#4-1-唯一约束的特点" class="headerlink" title="4.1 唯一约束的特点"></a>4.1 唯一约束的特点</h3><ol>
<li><strong>唯一性</strong>：列值必须唯一</li>
<li><strong>允许 NULL</strong>：可以有多个 NULL 值（但有些数据库只允许一个）</li>
<li><strong>多列唯一</strong>：可以创建复合唯一索引</li>
</ol>
<h3 id="4-2-创建唯一约束"><a href="#4-2-创建唯一约束" class="headerlink" title="4.2 创建唯一约束"></a>4.2 创建唯一约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列级唯一约束</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表级唯一约束</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span> (username),</span><br><span class="line">    <span class="keyword">UNIQUE</span> (email)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 命名唯一约束</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span>,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_username <span class="keyword">UNIQUE</span> (username),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_email <span class="keyword">UNIQUE</span> (email)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 复合唯一约束（多列组合唯一）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> user_roles (</span><br><span class="line">    user_id <span class="type">INT</span>,</span><br><span class="line">    role_id <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> uk_user_role <span class="keyword">UNIQUE</span> (user_id, role_id)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 同一个用户不能有相同的角色，但不同用户可以有相同角色</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-唯一约束与主键的区别"><a href="#4-3-唯一约束与主键的区别" class="headerlink" title="4.3 唯一约束与主键的区别"></a>4.3 唯一约束与主键的区别</h3><table>
<thead>
<tr>
<th>对比项</th>
<th>主键约束</th>
<th>唯一约束</th>
</tr>
</thead>
<tbody><tr>
<td>NULL 值</td>
<td>不允许</td>
<td>允许（可以有多个 NULL）</td>
</tr>
<tr>
<td>数量</td>
<td>一张表只能有一个</td>
<td>一张表可以有多个</td>
</tr>
<tr>
<td>索引类型</td>
<td>创建聚簇索引（InnoDB）</td>
<td>创建唯一索引</td>
</tr>
<tr>
<td>用途</td>
<td>唯一标识记录</td>
<td>保证列值唯一</td>
</tr>
</tbody></table>
<h2 id="五、非空约束（NOT-NULL）"><a href="#五、非空约束（NOT-NULL）" class="headerlink" title="五、非空约束（NOT NULL）"></a>五、非空约束（NOT NULL）</h2><h3 id="5-1-非空约束的特点"><a href="#5-1-非空约束的特点" class="headerlink" title="5.1 非空约束的特点"></a>5.1 非空约束的特点</h3><ul>
<li>列值不能为 NULL</li>
<li>只能在列级定义，不能在表级定义</li>
<li>插入或更新时必须提供值</li>
</ul>
<h3 id="5-2-创建非空约束"><a href="#5-2-创建非空约束" class="headerlink" title="5.2 创建非空约束"></a>5.2 创建非空约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建时指定非空</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">20</span>),  <span class="comment">-- 允许 NULL</span></span><br><span class="line">    age <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改为非空</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users MODIFY <span class="keyword">COLUMN</span> age <span class="type">INT</span> <span class="keyword">NOT NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改为允许 NULL</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users MODIFY <span class="keyword">COLUMN</span> age <span class="type">INT</span>;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-非空约束实战"><a href="#5-3-非空约束实战" class="headerlink" title="5.3 非空约束实战"></a>5.3 非空约束实战</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 尝试插入 NULL 值（会报错）</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, username) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="comment">-- ERROR: Column &#x27;username&#x27; cannot be null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 正确插入</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, username, email) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;john&#x27;</span>, <span class="string">&#x27;john@example.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 IFNULL 处理可能为 NULL 的查询</span></span><br><span class="line"><span class="keyword">SELECT</span> username, IFNULL(phone, <span class="string">&#x27;未填写&#x27;</span>) <span class="keyword">AS</span> phone <span class="keyword">FROM</span> users;</span><br></pre></td></tr></table></figure>

<h2 id="六、默认约束（DEFAULT）"><a href="#六、默认约束（DEFAULT）" class="headerlink" title="六、默认约束（DEFAULT）"></a>六、默认约束（DEFAULT）</h2><h3 id="6-1-默认约束的特点"><a href="#6-1-默认约束的特点" class="headerlink" title="6.1 默认约束的特点"></a>6.1 默认约束的特点</h3><ul>
<li>插入数据时如果不指定该列，则使用默认值</li>
<li>默认值可以是常量、表达式或函数</li>
</ul>
<h3 id="6-2-创建默认约束"><a href="#6-2-创建默认约束" class="headerlink" title="6.2 创建默认约束"></a>6.2 创建默认约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 常量默认值</span></span><br><span class="line">    status TINYINT <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    gender ENUM(<span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;女&#x27;</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 函数默认值</span></span><br><span class="line">    create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    update_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- NULL 默认值（显式指定）</span></span><br><span class="line">    remark <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="6-3-默认约束实战"><a href="#6-3-默认约束实战" class="headerlink" title="6.3 默认约束实战"></a>6.3 默认约束实战</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用默认值插入</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, username) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"><span class="comment">-- status=1, gender=&#x27;男&#x27;, create_time=当前时间</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 显式指定值</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, username, status, gender)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;jane&#x27;</span>, <span class="number">0</span>, <span class="string">&#x27;女&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用 DEFAULT 关键字显式使用默认值</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, username, status)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;bob&#x27;</span>, <span class="keyword">DEFAULT</span>);</span><br></pre></td></tr></table></figure>

<h3 id="6-4-修改默认约束"><a href="#6-4-修改默认约束" class="headerlink" title="6.4 修改默认约束"></a>6.4 修改默认约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加默认约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> status <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除默认约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> status <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改默认值（先删除再添加）</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> status <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</span><br><span class="line"><span class="keyword">ALTER TABLE</span> users <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> status <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<h2 id="七、检查约束（CHECK）"><a href="#七、检查约束（CHECK）" class="headerlink" title="七、检查约束（CHECK）"></a>七、检查约束（CHECK）</h2><h3 id="7-1-检查约束的特点"><a href="#7-1-检查约束的特点" class="headerlink" title="7.1 检查约束的特点"></a>7.1 检查约束的特点</h3><ul>
<li><strong>MySQL 8.0.16+</strong> 才开始支持 CHECK 约束</li>
<li>旧版本会忽略 CHECK 约束（不报错但不生效）</li>
<li>用于确保列值满足特定条件</li>
</ul>
<h3 id="7-2-创建检查约束"><a href="#7-2-创建检查约束" class="headerlink" title="7.2 创建检查约束"></a>7.2 创建检查约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建时添加检查约束</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">65</span>),</span><br><span class="line">    salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">CHECK</span> (salary <span class="operator">&gt;=</span> <span class="number">0</span>),</span><br><span class="line">    gender ENUM(<span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;女&#x27;</span>),</span><br><span class="line">    hire_date <span class="type">DATE</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_hire_date <span class="keyword">CHECK</span> (hire_date <span class="operator">&lt;=</span> CURDATE())</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用多条件检查约束</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    amount <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">CHECK</span> (amount <span class="operator">&gt;</span> <span class="number">0</span>),</span><br><span class="line">    status <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">CHECK</span> (status <span class="keyword">IN</span> (<span class="string">&#x27;PENDING&#x27;</span>, <span class="string">&#x27;PAID&#x27;</span>, <span class="string">&#x27;SHIPPED&#x27;</span>, <span class="string">&#x27;CANCELLED&#x27;</span>)),</span><br><span class="line">    discount <span class="type">DECIMAL</span>(<span class="number">5</span>, <span class="number">2</span>) <span class="keyword">CHECK</span> (discount <span class="operator">&gt;=</span> <span class="number">0</span> <span class="keyword">AND</span> discount <span class="operator">&lt;=</span> <span class="number">100</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="7-3-修改检查约束"><a href="#7-3-修改检查约束" class="headerlink" title="7.3 修改检查约束"></a>7.3 修改检查约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加检查约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees</span><br><span class="line"><span class="keyword">ADD CONSTRAINT</span> chk_age <span class="keyword">CHECK</span> (age <span class="operator">&gt;=</span> <span class="number">18</span> <span class="keyword">AND</span> age <span class="operator">&lt;=</span> <span class="number">65</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除检查约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">CHECK</span> chk_age;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-检查约束实战"><a href="#7-4-检查约束实战" class="headerlink" title="7.4 检查约束实战"></a>7.4 检查约束实战</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 尝试插入违反约束的数据（会报错）</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> employees (id, name, age, salary) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">17</span>, <span class="number">8000</span>);</span><br><span class="line"><span class="comment">-- ERROR: CHECK constraint &#x27;chk_age&#x27; is violated</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> employees (id, name, age, salary) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">30</span>, <span class="number">-5000</span>);</span><br><span class="line"><span class="comment">-- ERROR: CHECK constraint &#x27;chk_salary&#x27; is violated</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 正确插入</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> employees (id, name, age, salary) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">30</span>, <span class="number">8000</span>);</span><br></pre></td></tr></table></figure>

<h2 id="八、外键约束（FOREIGN-KEY）"><a href="#八、外键约束（FOREIGN-KEY）" class="headerlink" title="八、外键约束（FOREIGN KEY）"></a>八、外键约束（FOREIGN KEY）</h2><h3 id="8-1-外键概述"><a href="#8-1-外键概述" class="headerlink" title="8.1 外键概述"></a>8.1 外键概述</h3><p><strong>外键（Foreign Key）</strong> 用于建立两个表之间的链接，保证数据的参照完整性。</p>
<p><strong>外键的特点</strong>：</p>
<ol>
<li>外键列的值必须存在于被引用表的主键列中，或者为 NULL</li>
<li>外键约束可以防止无效的数据插入</li>
<li>外键约束可以级联更新和删除</li>
</ol>
<h3 id="8-2-创建外键约束"><a href="#8-2-创建外键约束" class="headerlink" title="8.2 创建外键约束"></a>8.2 创建外键约束</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建部门表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> departments (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    dept_name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    dept_location <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建员工表（带外键）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    emp_no <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    dept_id <span class="type">INT</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 外键约束</span></span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_dept</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (dept_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> departments(id)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 简写形式（不命名）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">FOREIGN KEY</span> (dept_id) <span class="keyword">REFERENCES</span> departments(id)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br></pre></td></tr></table></figure>

<p><strong>重要提示</strong>：</p>
<ul>
<li>外键约束只在 InnoDB 引擎中生效</li>
<li>外键列和被引用列的数据类型必须相同</li>
<li>被引用列必须是主键或唯一索引</li>
</ul>
<h3 id="8-3-外键约束的参照完整性"><a href="#8-3-外键约束的参照完整性" class="headerlink" title="8.3 外键约束的参照完整性"></a>8.3 外键约束的参照完整性</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 插入部门</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> departments (dept_name, dept_location) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;技术部&#x27;</span>, <span class="string">&#x27;北京&#x27;</span>),</span><br><span class="line">(<span class="string">&#x27;市场部&#x27;</span>, <span class="string">&#x27;上海&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入员工（有效的外键值）</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> employees (emp_no, name, dept_id) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;E001&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="number">1</span>),  <span class="comment">-- 有效</span></span><br><span class="line">(<span class="string">&#x27;E002&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="number">2</span>);  <span class="comment">-- 有效</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入员工（无效的外键值，会报错）</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> employees (emp_no, name, dept_id) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;E003&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="number">99</span>);  <span class="comment">-- ERROR: 部门 99 不存在</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入员工（NULL 值，允许）</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> employees (emp_no, name, dept_id) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">&#x27;E003&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>, <span class="keyword">NULL</span>);  <span class="comment">-- 允许，表示该员工暂无部门</span></span><br></pre></td></tr></table></figure>

<h3 id="8-4-添加和删除外键"><a href="#8-4-添加和删除外键" class="headerlink" title="8.4 添加和删除外键"></a>8.4 添加和删除外键</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 添加外键约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees</span><br><span class="line"><span class="keyword">ADD CONSTRAINT</span> fk_emp_dept</span><br><span class="line"><span class="keyword">FOREIGN KEY</span> (dept_id) <span class="keyword">REFERENCES</span> departments(id);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除外键约束</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FOREIGN KEY</span> fk_emp_dept;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除外键后，还需要删除对应的外键索引</span></span><br><span class="line"><span class="keyword">ALTER TABLE</span> employees <span class="keyword">DROP</span> INDEX dept_id;</span><br></pre></td></tr></table></figure>

<h3 id="8-5-查看外键信息"><a href="#8-5-查看外键信息" class="headerlink" title="8.5 查看外键信息"></a>8.5 查看外键信息</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看表的外键</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE TABLE</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 从 information_schema 查询外键</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    TABLE_NAME,</span><br><span class="line">    COLUMN_NAME,</span><br><span class="line">    CONSTRAINT_NAME,</span><br><span class="line">    REFERENCED_TABLE_NAME,</span><br><span class="line">    REFERENCED_COLUMN_NAME</span><br><span class="line"><span class="keyword">FROM</span> information_schema.KEY_COLUMN_USAGE</span><br><span class="line"><span class="keyword">WHERE</span> TABLE_SCHEMA <span class="operator">=</span> <span class="string">&#x27;your_database&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> TABLE_NAME <span class="operator">=</span> <span class="string">&#x27;employees&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> REFERENCED_TABLE_NAME <span class="keyword">IS</span> <span class="keyword">NOT NULL</span>;</span><br></pre></td></tr></table></figure>

<h2 id="九、外键的删除和更新行为"><a href="#九、外键的删除和更新行为" class="headerlink" title="九、外键的删除和更新行为"></a>九、外键的删除和更新行为</h2><h3 id="9-1-外键行为选项"><a href="#9-1-外键行为选项" class="headerlink" title="9.1 外键行为选项"></a>9.1 外键行为选项</h3><p>当父表（被引用表）的记录被更新或删除时，子表（引用表）如何处理？</p>
<table>
<thead>
<tr>
<th>行为</th>
<th>说明</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td>RESTRICT</td>
<td>拒绝删除&#x2F;更新父表记录（默认）</td>
<td>严格参照完整性</td>
</tr>
<tr>
<td>NO ACTION</td>
<td>同 RESTRICT（在 MySQL 中）</td>
<td>严格参照完整性</td>
</tr>
<tr>
<td>CASCADE</td>
<td>级联删除&#x2F;更新</td>
<td>强关联数据</td>
</tr>
<tr>
<td>SET NULL</td>
<td>将外键设为 NULL</td>
<td>可选关联</td>
</tr>
<tr>
<td>SET DEFAULT</td>
<td>设为默认值（MySQL 不支持）</td>
<td>-</td>
</tr>
</tbody></table>
<h3 id="9-2-CASCADE（级联）"><a href="#9-2-CASCADE（级联）" class="headerlink" title="9.2 CASCADE（级联）"></a>9.2 CASCADE（级联）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建带级联删除/更新的外键</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_dept</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (dept_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> departments(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE    <span class="comment">-- 删除部门时，级联删除员工</span></span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE    <span class="comment">-- 更新部门 ID 时，级联更新员工</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 演示级联删除</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> departments <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 所有 dept_id=1  的员工也会被删除</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 演示级联更新</span></span><br><span class="line"><span class="keyword">UPDATE</span> departments <span class="keyword">SET</span> id <span class="operator">=</span> <span class="number">10</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 所有 dept_id=1 的员工，dept_id 会更新为 10</span></span><br></pre></td></tr></table></figure>

<h3 id="9-3-SET-NULL（设为空）"><a href="#9-3-SET-NULL（设为空）" class="headerlink" title="9.3 SET NULL（设为空）"></a>9.3 SET NULL（设为空）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建带 SET NULL 的外键</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">INT</span> <span class="keyword">NULL</span>,  <span class="comment">-- 必须允许 NULL</span></span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_dept</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (dept_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> departments(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>  <span class="comment">-- 删除部门时，员工的 dept_id 设为 NULL</span></span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 演示 SET NULL 删除</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> departments <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 所有 dept_id=1 的员工，dept_id 会被设为 NULL</span></span><br></pre></td></tr></table></figure>

<h3 id="9-4-RESTRICT-NO-ACTION（限制）"><a href="#9-4-RESTRICT-NO-ACTION（限制）" class="headerlink" title="9.4 RESTRICT &#x2F; NO ACTION（限制）"></a>9.4 RESTRICT &#x2F; NO ACTION（限制）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建带 RESTRICT 的外键（默认行为）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    dept_id <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_emp_dept</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (dept_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> departments(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT  <span class="comment">-- 或直接省略，默认就是 RESTRICT</span></span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> RESTRICT</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 尝试删除有员工关联的部门（会报错）</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> departments <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- ERROR: Cannot delete or update a parent row:</span></span><br><span class="line"><span class="comment">-- a foreign key constraint fails</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 必须先删除或更新子表记录</span></span><br><span class="line"><span class="keyword">UPDATE</span> employees <span class="keyword">SET</span> dept_id <span class="operator">=</span> <span class="keyword">NULL</span> <span class="keyword">WHERE</span> dept_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 或者</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> dept_id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 然后才能删除部门</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> departments <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="9-5-外键行为选择建议"><a href="#9-5-外键行为选择建议" class="headerlink" title="9.5 外键行为选择建议"></a>9.5 外键行为选择建议</h3><table>
<thead>
<tr>
<th>关系类型</th>
<th>推荐行为</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>强依赖关系</td>
<td>CASCADE</td>
<td>订单和订单明细</td>
</tr>
<tr>
<td>可选关联</td>
<td>SET NULL</td>
<td>员工和部门（允许暂无部门）</td>
</tr>
<tr>
<td>严格参照</td>
<td>RESTRICT</td>
<td>用户和账户（不允许删除有账户的用户）</td>
</tr>
<tr>
<td>历史数据</td>
<td>RESTRICT + 逻辑删除</td>
<td>不允许物理删除，只标记状态</td>
</tr>
</tbody></table>
<h3 id="9-6-外键实战案例"><a href="#9-6-外键实战案例" class="headerlink" title="9.6 外键实战案例"></a>9.6 外键实战案例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 案例 1：订单系统（级联删除）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    user_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    order_no <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_orders_user</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (user_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> users(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">UPDATE</span> CASCADE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> order_items (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    product_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    quantity <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_items_order</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (order_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> orders(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除用户时，自动删除其所有订单和订单明细</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例 2：文章评论系统（SET NULL）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> articles (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    title <span class="type">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">    author_id <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_articles_author</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (author_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> users(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>  <span class="comment">-- 作者删除后，文章保留但作者为空</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 案例 3：学生选课系统（限制删除）</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> enrollments (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span>,</span><br><span class="line">    student_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    course_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_enroll_student</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (student_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> students(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT,  <span class="comment">-- 有选课记录时不能删除学生</span></span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_enroll_course</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (course_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> courses(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT   <span class="comment">-- 有选课记录时不能删除课程</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="十、约束综合实战"><a href="#十、约束综合实战" class="headerlink" title="十、约束综合实战"></a>十、约束综合实战</h2><h3 id="10-1-电商数据库设计"><a href="#10-1-电商数据库设计" class="headerlink" title="10.1 电商数据库设计"></a>10.1 电商数据库设计</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用户表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    password <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    status TINYINT <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_status <span class="keyword">CHECK</span> (status <span class="keyword">IN</span> (<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 商品分类表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> categories (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    parent_id <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    sort_order <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_sort <span class="keyword">CHECK</span> (sort_order <span class="operator">&gt;=</span> <span class="number">0</span>)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 商品表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> products (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">200</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    category_id <span class="type">INT</span>,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    stock <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    status TINYINT <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_price <span class="keyword">CHECK</span> (price <span class="operator">&gt;=</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_stock <span class="keyword">CHECK</span> (stock <span class="operator">&gt;=</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_status <span class="keyword">CHECK</span> (status <span class="keyword">IN</span> (<span class="number">0</span>, <span class="number">1</span>)),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_prod_category</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (category_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> categories(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 订单表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    order_no <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    user_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    total_amount <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    status TINYINT <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">    create_time DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_amount <span class="keyword">CHECK</span> (total_amount <span class="operator">&gt;=</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_order_status <span class="keyword">CHECK</span> (status <span class="keyword">IN</span> (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_orders_user</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (user_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> users(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 订单明细表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> order_items (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    product_id <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT NULL</span>,</span><br><span class="line">    quantity <span class="type">INT</span> <span class="keyword">NOT NULL</span>,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_quantity <span class="keyword">CHECK</span> (quantity <span class="operator">&gt;</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> chk_item_price <span class="keyword">CHECK</span> (price <span class="operator">&gt;=</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_items_order</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (order_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> orders(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE,</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> fk_items_product</span><br><span class="line">        <span class="keyword">FOREIGN KEY</span> (product_id)</span><br><span class="line">        <span class="keyword">REFERENCES</span> products(id)</span><br><span class="line">        <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>

<h3 id="10-2-约束测试"><a href="#10-2-约束测试" class="headerlink" title="10.2 约束测试"></a>10.2 约束测试</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 测试 1：插入有效数据</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (username, password, email)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;pwd123&#x27;</span>, <span class="string">&#x27;test@example.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试 2：违反唯一约束</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (username, password, email)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;pwd456&#x27;</span>, <span class="string">&#x27;test2@example.com&#x27;</span>);  <span class="comment">-- ERROR: 用户名重复</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试 3：违反非空约束</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (username, email) <span class="keyword">VALUES</span> (<span class="keyword">NULL</span>, <span class="string">&#x27;test@example.com&#x27;</span>);  <span class="comment">-- ERROR</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试 4：违反检查约束</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> products (name, price, stock) <span class="keyword">VALUES</span> (<span class="string">&#x27;商品&#x27;</span>, <span class="number">-100</span>, <span class="number">10</span>);  <span class="comment">-- ERROR</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试 5：违反外键约束</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> orders (order_no, user_id, total_amount)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;ORD001&#x27;</span>, <span class="number">999</span>, <span class="number">100</span>);  <span class="comment">-- ERROR: 用户不存在</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 测试 6：级联删除</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 该用户的所有订单也会被删除</span></span><br></pre></td></tr></table></figure>

<h2 id="十一、小结"><a href="#十一、小结" class="headerlink" title="十一、小结"></a>十一、小结</h2><h3 id="约束类型总结"><a href="#约束类型总结" class="headerlink" title="约束类型总结"></a>约束类型总结</h3><table>
<thead>
<tr>
<th>约束</th>
<th>关键字</th>
<th>作用</th>
<th>可否命名</th>
</tr>
</thead>
<tbody><tr>
<td>主键</td>
<td>PRIMARY KEY</td>
<td>唯一标识记录</td>
<td>是</td>
</tr>
<tr>
<td>外键</td>
<td>FOREIGN KEY</td>
<td>建立表间关系</td>
<td>是</td>
</tr>
<tr>
<td>唯一</td>
<td>UNIQUE</td>
<td>保证列值唯一</td>
<td>是</td>
</tr>
<tr>
<td>非空</td>
<td>NOT NULL</td>
<td>禁止 NULL 值</td>
<td>否</td>
</tr>
<tr>
<td>默认</td>
<td>DEFAULT</td>
<td>设置默认值</td>
<td>否</td>
</tr>
<tr>
<td>检查</td>
<td>CHECK</td>
<td>验证数据有效性</td>
<td>是</td>
</tr>
</tbody></table>
<h3 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h3><ol>
<li><strong>主键选择</strong>：使用无业务意义的自增 ID</li>
<li><strong>外键使用</strong>：明确指定 ON DELETE&#x2F;UPDATE 行为</li>
<li><strong>约束命名</strong>：使用有意义的约束名便于维护</li>
<li><strong>检查约束</strong>：在数据库层面验证业务规则</li>
<li><strong>适度使用</strong>：不要过度约束影响性能</li>
</ol>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ol>
<li>外键只在 InnoDB 引擎中生效</li>
<li>MySQL 8.0.16 之前不支持 CHECK 约束</li>
<li>外键会影响插入、删除、更新性能</li>
<li>级联删除要小心使用，避免误删数据</li>
</ol>
<hr>
<p><strong>下一篇</strong>：[MySQL 进阶教程（三）：多表查询详解](&#x2F;2026&#x2F;02&#x2F;23&#x2F;MySQL 进阶教程（三）多表查询详解&#x2F;)</p>
<p><strong>上一篇</strong>：[MySQL 进阶教程（一）：常用函数详解](&#x2F;2026&#x2F;02&#x2F;23&#x2F;MySQL 进阶教程（一）常用函数详解&#x2F;)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3/">https://brian-lin-c.github.io/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E7%BA%A6%E6%9D%9F/">约束</a><a class="post-meta__tags" href="/tags/%E5%A4%96%E9%94%AE/">外键</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（三）多表查询详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">MySQL 进阶教程（三）多表查询详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程（三）多表查询详解在实际应用中，数据通常分布在多个表中。多表查询是 SQL 中最重要、最实用的技能之一。本文将详细讲解多表关系、连接查询、联合查询和子查询。 一、多表关系介绍1.1 表与表之间的关系数据库中的表不是孤立的，它们之间通过各种关系相互关联。主要有三种关系：    关系类型 说明 示例    一对一（1:1） 一个表的一条记录对应另一个表的一条记录 用户和用户详情   一对多（1:N） 一个表的一条记录对应另一个表的多条记录 部门和员工   多对多（N:M） 一个表的多条记录对应另一个表的多条记录 学生和课程   1.2 一对一关系（1:1）特点：  表 A 的一条记录对应表 B 的一条记录 通常用于拆分大表，提高性能 外键可以放在任意一方  1234567891011121314151617181920-- 用户表CREATE TABLE users (    id INT PRIMARY KEY AUTO_INCREMENT,    username VARCHAR(50) NOT NULL,    password VARCHAR(255) N...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（一）常用函数详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 进阶教程（一）常用函数详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程（一）常用函数详解在基础教程中，我们学习了 SQL 的基本查询和操作。本文将系统讲解 MySQL 提供的常用内置函数，包括字符串函数、数值函数、日期函数和流程函数。 一、函数概述MySQL 函数是对数据进行特定操作的预定义程序，可以简化 SQL 语句，提高开发效率。 函数的分类：  字符串函数：处理字符串数据 数值函数：处理数值数据 日期时间函数：处理日期和时间 流程函数：条件判断和流程控制 聚合函数：对一组数据进行计算（已在 DQL 章节讲解） 加密函数：数据加密和哈希 其他函数：信息函数、加锁函数等  二、字符串函数2.1 字符串连接与长度123456789101112131415-- CONCAT(s1, s2, ...)：连接字符串SELECT CONCAT(&#x27;Hello&#x27;, &#x27; &#x27;, &#x27;World&#x27;) AS result;  -- &#x27;Hello World&#x27;SELECT CONCAT(&#x27;姓名：&#x27;, name) FROM employees;-- CON...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/23/MySQL%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E4%B8%8E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="MySQL 基础教程（一）数据库基础与环境搭建"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 基础教程（一）数据库基础与环境搭建</div></div><div class="info-2"><div class="info-item-1">MySQL 基础教程（一）数据库基础与环境搭建欢迎来到 MySQL 基础教程系列的第一篇！在本篇文章中，我们将从零开始了解数据库的基本概念，完成 MySQL 的安装配置，并了解数据模型和 SQL 的分类。 一、数据库相关概念1.1 什么是数据库？数据库（Database） 是按照数据结构来组织、存储和管理数据的仓库。它可以持久化存储数据，并且支持高效的数据访问和管理。 简单来说，数据库就是一个电子化的文件柜，用于存储和管理数据。 1.2 什么是 DBMS？DBMS（Database Management System，数据库管理系统） 是用于创建、管理和维护数据库的软件。 常见的 DBMS 有：  MySQL：开源、轻量、流行，适合中小型项目 Oracle：功能强大、性能优异，适合大型企业 SQL Server：微软出品，与 Windows 生态集成良好 PostgreSQL：开源、功能丰富，支持复杂查询 SQLite：嵌入式数据库，适合移动端和小型应用  1.3 数据库的优势   对比项 文件系统 数据库系统    数据结构 松散，由应用程序定义 结构化，由 DBMS 统一管理...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%94%EF%BC%89DCL%20%E6%95%B0%E6%8D%AE%E6%8E%A7%E5%88%B6%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3/" title="MySQL 基础教程（五）DCL 数据控制语言详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 基础教程（五）DCL 数据控制语言详解</div></div><div class="info-2"><div class="info-item-1">MySQL 基础教程（五）DCL 数据控制语言详解DCL（Data Control Language，数据控制语言）用于管理数据库权限和事务控制。本文我们将学习如何创建用户、管理权限，以及事务控制的相关知识。 一、DCL 概述DCL 主要包含两类操作：  权限管理：GRANT（授权）、REVOKE（撤销权限） 事务控制：COMMIT（提交）、ROLLBACK（回滚）、SAVEPOINT（保存点）     命令 功能 分类    GRANT 授予用户权限 权限管理   REVOKE 撤销用户权限 权限管理   COMMIT 提交事务 事务控制   ROLLBACK 回滚事务 事务控制   SAVEPOINT 设置保存点 事务控制   二、用户管理2.1 用户表结构MySQL 的用户信息存储在 mysql.user 表中： 12345-- 查看所有用户SELECT user, host FROM mysql.user;-- 查看用户详细信息SELECT user, host, authentication_string, plugin FROM mysql.user;  用户名的组成...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（三）多表查询详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 进阶教程（三）多表查询详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程（三）多表查询详解在实际应用中，数据通常分布在多个表中。多表查询是 SQL 中最重要、最实用的技能之一。本文将详细讲解多表关系、连接查询、联合查询和子查询。 一、多表关系介绍1.1 表与表之间的关系数据库中的表不是孤立的，它们之间通过各种关系相互关联。主要有三种关系：    关系类型 说明 示例    一对一（1:1） 一个表的一条记录对应另一个表的一条记录 用户和用户详情   一对多（1:N） 一个表的一条记录对应另一个表的多条记录 部门和员工   多对多（N:M） 一个表的多条记录对应另一个表的多条记录 学生和课程   1.2 一对一关系（1:1）特点：  表 A 的一条记录对应表 B 的一条记录 通常用于拆分大表，提高性能 外键可以放在任意一方  1234567891011121314151617181920-- 用户表CREATE TABLE users (    id INT PRIMARY KEY AUTO_INCREMENT,    username VARCHAR(50) NOT NULL,    password VARCHAR(255) N...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E5%9B%9B%EF%BC%89DQL%20%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3%EF%BC%88%E4%B8%8B%EF%BC%89/" title="MySQL 基础教程（四）DQL 数据查询语言详解（下）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 基础教程（四）DQL 数据查询语言详解（下）</div></div><div class="info-2"><div class="info-item-1">MySQL 基础教程（四）DQL 数据查询语言详解（下）承接上文，本文继续讲解 DQL 的排序查询、分页查询、综合案例以及 SQL 执行顺序。 七、排序查询（ORDER BY）ORDER BY 用于对查询结果进行排序。 7.1 基础排序1234567891011-- 升序排序（ASC，默认）SELECT name, salary FROM employeesORDER BY salary ASC;-- 降序排序（DESC）SELECT name, salary FROM employeesORDER BY salary DESC;-- 按字符串排序SELECT name FROM employeesORDER BY name ASC;  -- 按拼音排序  7.2 多列排序123456789-- 先按部门排序，部门相同按工资降序SELECT name, dept_id, salaryFROM employeesORDER BY dept_id ASC, salary DESC;-- 先按在职状态排序，再按工资降序SELECT name, status, salaryFROM em...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%94%EF%BC%89%E5%9F%BA%E7%A1%80%E7%AF%87%E6%80%BB%E7%BB%93/" title="MySQL 进阶教程（五）基础篇总结"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 进阶教程（五）基础篇总结</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程（五）基础篇总结至此，MySQL 基础篇和进阶教程全部完成！本文将对整个系列进行系统总结，并提供学习路线建议。 一、系列文章回顾基础教程系列   篇目 主题 核心内容    基础（一） 数据库基础与环境搭建 数据库概念、MySQL 安装、数据模型、SQL 分类   基础（二） DDL 数据定义语言 数据库操作、表操作、数据类型、DataGrip   基础（三） DML 数据操作语言 INSERT、UPDATE、DELETE、事务基础   基础（四） DQL 数据查询语言 基础查询、条件查询、聚合函数、分组、排序、分页、连接查询、子查询   基础（五） DCL 数据控制语言 用户管理、权限控制、事务控制   进阶教程系列   篇目 主题 核心内容    进阶（一） 常用函数详解 字符串函数、数值函数、日期函数、流程函数   进阶（二） 数据库约束 主键、外键、唯一、非空、默认、检查约束   进阶（三） 多表查询 表关系、连接查询、联合查询、子查询   进阶（四） 事务 ACID 特性、并发问题、隔离级别、锁机制   二、知识体系思维导图2.1 SQL 语言分类1...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E5%9B%9B%EF%BC%89DQL%20%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3%EF%BC%88%E4%B8%8A%EF%BC%89/" title="MySQL 基础教程（四）DQL 数据查询语言详解（上）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 基础教程（四）DQL 数据查询语言详解（上）</div></div><div class="info-2"><div class="info-item-1">MySQL 基础教程（四）DQL 数据查询语言详解（上）DQL（Data Query Language，数据查询语言）是 SQL 中使用频率最高的部分。本文将系统讲解 DQL 的各种查询技巧，由于内容较多，分为上下两部分。 上半部分：基础查询、条件查询、聚合函数、分组查询下半部分：排序查询、分页查询、综合案例、执行顺序 一、DQL 概述DQL 主要用于从数据库中查询数据，核心命令是 SELECT。 完整的 SELECT 语法结构： 1234567SELECT [DISTINCT] 列名 1 [AS 别名 1], 列名 2 [AS 别名 2], ...FROM 表名 1 [AS 别名 1][INNER | LEFT | RIGHT | FULL] JOIN 表名 2 ON 连接条件[WHERE 条件][GROUP BY 分组列 [HAVING 分组过滤]][ORDER BY 排序列 [ASC | DESC]][LIMIT 起始位置，返回条数];  二、基础查询2.1 准备测试数据1234567891011121314151617181920212223242526272829303...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">MySQL 进阶教程（二）数据库约束详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%BA%A6%E6%9D%9F%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">一、约束概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%A6%E6%9D%9F%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 什么是约束？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E7%BA%A6%E6%9D%9F%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 约束的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 约束的分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%AE%9A%E4%B9%89%E6%97%B6%E6%9C%BA"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 约束的定义时机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%BA%A6%E6%9D%9F%E6%BC%94%E7%A4%BA"><span class="toc-number">1.2.</span> <span class="toc-text">二、约束演示</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E6%B7%BB%E5%8A%A0%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 创建表时添加约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%A1%A8%E7%BA%A7%E7%BA%A6%E6%9D%9F%E8%AF%AD%E6%B3%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 表级约束语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%B7%BB%E5%8A%A0%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 修改表添加约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E6%9F%A5%E7%9C%8B%E7%BA%A6%E6%9D%9F%E4%BF%A1%E6%81%AF"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 查看约束信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F%EF%BC%88PRIMARY-KEY%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">三、主键约束（PRIMARY KEY）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%B8%BB%E9%94%AE%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 主键的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%88%9B%E5%BB%BA%E4%B8%BB%E9%94%AE"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 创建主键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E4%BF%AE%E6%94%B9%E4%B8%BB%E9%94%AE"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 修改主键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E4%B8%BB%E9%94%AE%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 主键选择建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F%EF%BC%88UNIQUE%EF%BC%89"><span class="toc-number">1.4.</span> <span class="toc-text">四、唯一约束（UNIQUE）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 唯一约束的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%88%9B%E5%BB%BA%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 创建唯一约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F%E4%B8%8E%E4%B8%BB%E9%94%AE%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 唯一约束与主键的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F%EF%BC%88NOT-NULL%EF%BC%89"><span class="toc-number">1.5.</span> <span class="toc-text">五、非空约束（NOT NULL）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 非空约束的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%88%9B%E5%BB%BA%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 创建非空约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F%E5%AE%9E%E6%88%98"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 非空约束实战</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F%EF%BC%88DEFAULT%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">六、默认约束（DEFAULT）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 默认约束的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%88%9B%E5%BB%BA%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 创建默认约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F%E5%AE%9E%E6%88%98"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 默认约束实战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E4%BF%AE%E6%94%B9%E9%BB%98%E8%AE%A4%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 修改默认约束</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F%EF%BC%88CHECK%EF%BC%89"><span class="toc-number">1.7.</span> <span class="toc-text">七、检查约束（CHECK）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F%E7%9A%84%E7%89%B9%E7%82%B9"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 检查约束的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E5%88%9B%E5%BB%BA%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 创建检查约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E4%BF%AE%E6%94%B9%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 修改检查约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-%E6%A3%80%E6%9F%A5%E7%BA%A6%E6%9D%9F%E5%AE%9E%E6%88%98"><span class="toc-number">1.7.4.</span> <span class="toc-text">7.4 检查约束实战</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%EF%BC%88FOREIGN-KEY%EF%BC%89"><span class="toc-number">1.8.</span> <span class="toc-text">八、外键约束（FOREIGN KEY）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%A4%96%E9%94%AE%E6%A6%82%E8%BF%B0"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 外键概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%88%9B%E5%BB%BA%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 创建外键约束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F%E7%9A%84%E5%8F%82%E7%85%A7%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 外键约束的参照完整性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-4-%E6%B7%BB%E5%8A%A0%E5%92%8C%E5%88%A0%E9%99%A4%E5%A4%96%E9%94%AE"><span class="toc-number">1.8.4.</span> <span class="toc-text">8.4 添加和删除外键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-5-%E6%9F%A5%E7%9C%8B%E5%A4%96%E9%94%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">1.8.5.</span> <span class="toc-text">8.5 查看外键信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%A4%96%E9%94%AE%E7%9A%84%E5%88%A0%E9%99%A4%E5%92%8C%E6%9B%B4%E6%96%B0%E8%A1%8C%E4%B8%BA"><span class="toc-number">1.9.</span> <span class="toc-text">九、外键的删除和更新行为</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%A4%96%E9%94%AE%E8%A1%8C%E4%B8%BA%E9%80%89%E9%A1%B9"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 外键行为选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-CASCADE%EF%BC%88%E7%BA%A7%E8%81%94%EF%BC%89"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 CASCADE（级联）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-SET-NULL%EF%BC%88%E8%AE%BE%E4%B8%BA%E7%A9%BA%EF%BC%89"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 SET NULL（设为空）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-RESTRICT-NO-ACTION%EF%BC%88%E9%99%90%E5%88%B6%EF%BC%89"><span class="toc-number">1.9.4.</span> <span class="toc-text">9.4 RESTRICT &#x2F; NO ACTION（限制）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-5-%E5%A4%96%E9%94%AE%E8%A1%8C%E4%B8%BA%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.9.5.</span> <span class="toc-text">9.5 外键行为选择建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-6-%E5%A4%96%E9%94%AE%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B"><span class="toc-number">1.9.6.</span> <span class="toc-text">9.6 外键实战案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E7%BA%A6%E6%9D%9F%E7%BB%BC%E5%90%88%E5%AE%9E%E6%88%98"><span class="toc-number">1.10.</span> <span class="toc-text">十、约束综合实战</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E7%94%B5%E5%95%86%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.10.1.</span> <span class="toc-text">10.1 电商数据库设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E7%BA%A6%E6%9D%9F%E6%B5%8B%E8%AF%95"><span class="toc-number">1.10.2.</span> <span class="toc-text">10.2 约束测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.11.</span> <span class="toc-text">十一、小结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F%E7%B1%BB%E5%9E%8B%E6%80%BB%E7%BB%93"><span class="toc-number">1.11.1.</span> <span class="toc-text">约束类型总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.11.2.</span> <span class="toc-text">最佳实践</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.11.3.</span> <span class="toc-text">注意事项</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%94%EF%BC%89%E5%9F%BA%E7%A1%80%E7%AF%87%E6%80%BB%E7%BB%93/" title="MySQL 进阶教程（五）基础篇总结">MySQL 进阶教程（五）基础篇总结</a><time datetime="2026-02-23T11:00:00.000Z" title="发表于 2026-02-23 19:00:00">2026-02-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BA%8B%E5%8A%A1%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（四）事务详解">MySQL 进阶教程（四）事务详解</a><time datetime="2026-02-23T10:00:00.000Z" title="发表于 2026-02-23 18:00:00">2026-02-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（三）多表查询详解">MySQL 进阶教程（三）多表查询详解</a><time datetime="2026-02-23T09:00:00.000Z" title="发表于 2026-02-23 17:00:00">2026-02-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BA%A6%E6%9D%9F%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（二）数据库约束详解">MySQL 进阶教程（二）数据库约束详解</a><time datetime="2026-02-23T08:00:00.000Z" title="发表于 2026-02-23 16:00:00">2026-02-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程（一）常用函数详解">MySQL 进阶教程（一）常用函数详解</a><time datetime="2026-02-23T07:00:00.000Z" title="发表于 2026-02-23 15:00:00">2026-02-23</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>