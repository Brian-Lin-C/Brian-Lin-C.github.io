<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Python 数据科学（二）Pandas 数据处理 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Python 数据科学（二）Pandas 数据处理Pandas 是 Python 数据分析的核心库。本篇将详细介绍 DataFrame 操作、数据清洗、数据转换等核心技能。 一、Pandas 简介1.1 为什么使用 Pandas？ 数据处理强大：支持 CSV、Excel、SQL、JSON 等多种格式 DataFrame 结构：类似 Excel 表格，直观易用 数据清洗方便：处理缺失值、重复值、异常">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 数据科学（二）Pandas 数据处理">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="Python 数据科学（二）Pandas 数据处理Pandas 是 Python 数据分析的核心库。本篇将详细介绍 DataFrame 操作、数据清洗、数据转换等核心技能。 一、Pandas 简介1.1 为什么使用 Pandas？ 数据处理强大：支持 CSV、Excel、SQL、JSON 等多种格式 DataFrame 结构：类似 Excel 表格，直观易用 数据清洗方便：处理缺失值、重复值、异常">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T07:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T03:35:16.630Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="DataFrame">
<meta property="article:tag" content="Pandas">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="数据分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Python 数据科学（二）Pandas 数据处理",
  "url": "https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T07:00:00.000Z",
  "dateModified": "2026-02-24T03:35:16.630Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python 数据科学（二）Pandas 数据处理',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">Python 数据科学（二）Pandas 数据处理</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Python 数据科学（二）Pandas 数据处理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T07:00:00.000Z" title="发表于 2026-02-24 15:00:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T03:35:16.630Z" title="更新于 2026-02-24 11:35:16">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python-%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/">Python 数据科学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>17分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Python-数据科学（二）Pandas-数据处理"><a href="#Python-数据科学（二）Pandas-数据处理" class="headerlink" title="Python 数据科学（二）Pandas 数据处理"></a>Python 数据科学（二）Pandas 数据处理</h1><p>Pandas 是 Python 数据分析的核心库。本篇将详细介绍 DataFrame 操作、数据清洗、数据转换等核心技能。</p>
<h2 id="一、Pandas-简介"><a href="#一、Pandas-简介" class="headerlink" title="一、Pandas 简介"></a>一、Pandas 简介</h2><h3 id="1-1-为什么使用-Pandas？"><a href="#1-1-为什么使用-Pandas？" class="headerlink" title="1.1 为什么使用 Pandas？"></a>1.1 为什么使用 Pandas？</h3><ul>
<li><strong>数据处理强大</strong>：支持 CSV、Excel、SQL、JSON 等多种格式</li>
<li><strong>DataFrame 结构</strong>：类似 Excel 表格，直观易用</li>
<li><strong>数据清洗方便</strong>：处理缺失值、重复值、异常值</li>
<li><strong>数据分析功能</strong>：分组、聚合、透视表</li>
<li><strong>与 NumPy 兼容</strong>：底层使用 NumPy，性能优秀</li>
</ul>
<h3 id="1-2-安装与导入"><a href="#1-2-安装与导入" class="headerlink" title="1.2 安装与导入"></a>1.2 安装与导入</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pandas</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line"><span class="built_in">print</span>(pd.__version__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置显示选项</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="literal">None</span>)  <span class="comment"># 显示所有列</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.width&#x27;</span>, <span class="literal">None</span>)        <span class="comment"># 自适应宽度</span></span><br></pre></td></tr></table></figure>

<h2 id="二、Series-和-DataFrame"><a href="#二、Series-和-DataFrame" class="headerlink" title="二、Series 和 DataFrame"></a>二、Series 和 DataFrame</h2><h3 id="2-1-Series（系列）"><a href="#2-1-Series（系列）" class="headerlink" title="2.1 Series（系列）"></a>2.1 Series（系列）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从列表创建</span></span><br><span class="line">s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定索引</span></span><br><span class="line">s = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从字典创建</span></span><br><span class="line">s = pd.Series(&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问元素</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">0</span>])        <span class="comment"># 1 位置索引</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="string">&#x27;a&#x27;</span>])      <span class="comment"># 1 标签索引</span></span><br><span class="line"><span class="built_in">print</span>(s[<span class="number">0</span>:<span class="number">3</span>])      <span class="comment"># 切片</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Series 运算</span></span><br><span class="line">s1 = pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">s2 = pd.Series([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"><span class="built_in">print</span>(s1 + s2)     <span class="comment"># [5, 7, 9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：Series 是一维带标签的数组</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-DataFrame（数据框）"><a href="#2-2-DataFrame（数据框）" class="headerlink" title="2.2 DataFrame（数据框）"></a>2.2 DataFrame（数据框）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从字典创建</span></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>],</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span>: [<span class="string">&#x27;北京&#x27;</span>, <span class="string">&#x27;上海&#x27;</span>, <span class="string">&#x27;广州&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从列表嵌套创建</span></span><br><span class="line">df = pd.DataFrame([</span><br><span class="line">    [<span class="string">&#x27;张三&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;北京&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;李四&#x27;</span>, <span class="number">30</span>, <span class="string">&#x27;上海&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;王五&#x27;</span>, <span class="number">35</span>, <span class="string">&#x27;广州&#x27;</span>]</span><br><span class="line">], columns=[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;city&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从 CSV 文件读取</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从 Excel 文件读取</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看数据</span></span><br><span class="line"><span class="built_in">print</span>(df.head())      <span class="comment"># 前 5 行</span></span><br><span class="line"><span class="built_in">print</span>(df.tail(<span class="number">3</span>))     <span class="comment"># 后 3 行</span></span><br><span class="line"><span class="built_in">print</span>(df.sample(<span class="number">2</span>))   <span class="comment"># 随机 2 行</span></span><br><span class="line"><span class="built_in">print</span>(df.info())      <span class="comment"># 数据信息</span></span><br><span class="line"><span class="built_in">print</span>(df.describe())  <span class="comment"># 统计摘要</span></span><br><span class="line"><span class="built_in">print</span>(df.shape)       <span class="comment"># 形状 (行，列)</span></span><br><span class="line"><span class="built_in">print</span>(df.columns)     <span class="comment"># 列名</span></span><br><span class="line"><span class="built_in">print</span>(df.index)       <span class="comment"># 索引</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - read_csv 是最常用的数据读取方式</span></span><br><span class="line"><span class="comment"># - info() 快速了解数据结构和缺失情况</span></span><br></pre></td></tr></table></figure>

<h2 id="三、数据选择与索引"><a href="#三、数据选择与索引" class="headerlink" title="三、数据选择与索引"></a>三、数据选择与索引</h2><h3 id="3-1-列选择"><a href="#3-1-列选择" class="headerlink" title="3.1 列选择"></a>3.1 列选择</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择单列（返回 Series）</span></span><br><span class="line">col = df[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">col = df.name  <span class="comment"># 也可以这样</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择多列（返回 DataFrame）</span></span><br><span class="line">cols = df[[<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：选择单列用 df[&#x27;col&#x27;]，多列用 df[[&#x27;col1&#x27;, &#x27;col2&#x27;]]</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-行选择"><a href="#3-2-行选择" class="headerlink" title="3.2 行选择"></a>3.2 行选择</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按位置选择</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">0</span>])      <span class="comment"># 第一行</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">0</span>:<span class="number">3</span>])    <span class="comment"># 前三行</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[-<span class="number">1</span>])     <span class="comment"># 最后一行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按标签选择</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="number">0</span>])       <span class="comment"># 索引为 0 的行</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="number">0</span>:<span class="number">2</span>])     <span class="comment"># 索引 0 到 2 的行（包含 2）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 条件选择</span></span><br><span class="line">adults = df[df[<span class="string">&#x27;age&#x27;</span>] &gt; <span class="number">25</span>]</span><br><span class="line">beijing = df[df[<span class="string">&#x27;city&#x27;</span>] == <span class="string">&#x27;北京&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多条件</span></span><br><span class="line">result = df[(df[<span class="string">&#x27;age&#x27;</span>] &gt; <span class="number">25</span>) &amp; (df[<span class="string">&#x27;city&#x27;</span>] == <span class="string">&#x27;北京&#x27;</span>)]</span><br><span class="line">result = df[(df[<span class="string">&#x27;age&#x27;</span>] &lt; <span class="number">25</span>) | (df[<span class="string">&#x27;age&#x27;</span>] &gt; <span class="number">35</span>)]</span><br><span class="line">result = df[~(df[<span class="string">&#x27;age&#x27;</span>] == <span class="number">25</span>)]  <span class="comment"># 非</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - iloc 按整数位置</span></span><br><span class="line"><span class="comment"># - loc 按标签</span></span><br><span class="line"><span class="comment"># - 多条件用 &amp; | ~，不用 and or not</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-单元格选择"><a href="#3-3-单元格选择" class="headerlink" title="3.3 单元格选择"></a>3.3 单元格选择</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按位置</span></span><br><span class="line">val = df.iloc[<span class="number">0</span>, <span class="number">1</span>]      <span class="comment"># 第 0 行第 1 列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按标签</span></span><br><span class="line">val = df.loc[<span class="number">0</span>, <span class="string">&#x27;name&#x27;</span>]  <span class="comment"># 索引 0，name 列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改值</span></span><br><span class="line">df.loc[<span class="number">0</span>, <span class="string">&#x27;age&#x27;</span>] = <span class="number">26</span></span><br><span class="line">df.iloc[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">26</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-布尔索引进阶"><a href="#3-4-布尔索引进阶" class="headerlink" title="3.4 布尔索引进阶"></a>3.4 布尔索引进阶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># isin 判断是否在列表中</span></span><br><span class="line">df[df[<span class="string">&#x27;city&#x27;</span>].isin([<span class="string">&#x27;北京&#x27;</span>, <span class="string">&#x27;上海&#x27;</span>])]</span><br><span class="line"></span><br><span class="line"><span class="comment"># str.contains 字符串包含</span></span><br><span class="line">df[df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;张&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># between 范围判断</span></span><br><span class="line">df[df[<span class="string">&#x27;age&#x27;</span>].between(<span class="number">25</span>, <span class="number">35</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># isnull/notnull 空值判断</span></span><br><span class="line">df[df[<span class="string">&#x27;age&#x27;</span>].isnull()]</span><br><span class="line">df[df[<span class="string">&#x27;age&#x27;</span>].notnull()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：这些方法在数据筛选中非常常用</span></span><br></pre></td></tr></table></figure>

<h2 id="四、数据清洗"><a href="#四、数据清洗" class="headerlink" title="四、数据清洗"></a>四、数据清洗</h2><h3 id="4-1-处理缺失值"><a href="#4-1-处理缺失值" class="headerlink" title="4.1 处理缺失值"></a>4.1 处理缺失值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建含缺失值的数据</span></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, np.nan, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: [<span class="number">5</span>, np.nan, np.nan, <span class="number">8</span>],</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: [<span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查缺失值</span></span><br><span class="line"><span class="built_in">print</span>(df.isnull())       <span class="comment"># 布尔矩阵</span></span><br><span class="line"><span class="built_in">print</span>(df.isnull().<span class="built_in">sum</span>()) <span class="comment"># 每列缺失数量</span></span><br><span class="line"><span class="built_in">print</span>(df.notnull())      <span class="comment"># 非缺失</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除缺失值</span></span><br><span class="line">df_dropped = df.dropna()           <span class="comment"># 删除任何含缺失的行</span></span><br><span class="line">df_dropped = df.dropna(axis=<span class="number">1</span>)     <span class="comment"># 删除含缺失的列</span></span><br><span class="line">df_dropped = df.dropna(thresh=<span class="number">2</span>)   <span class="comment"># 至少 2 个非缺失值才保留</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 填充缺失值</span></span><br><span class="line">df_filled = df.fillna(<span class="number">0</span>)           <span class="comment"># 填充为 0</span></span><br><span class="line">df_filled = df.fillna(df.mean())   <span class="comment"># 填充为均值</span></span><br><span class="line">df_filled = df.fillna(method=<span class="string">&#x27;ffill&#x27;</span>)  <span class="comment"># 向前填充</span></span><br><span class="line">df_filled = df.fillna(method=<span class="string">&#x27;bfill&#x27;</span>)  <span class="comment"># 向后填充</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 插值</span></span><br><span class="line">df_interpolated = df.interpolate()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - 删除缺失值会丢失数据</span></span><br><span class="line"><span class="comment"># - 填充策略要根据业务场景选择</span></span><br><span class="line"><span class="comment"># - 均值填充会改变数据分布</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-处理重复值"><a href="#4-2-处理重复值" class="headerlink" title="4.2 处理重复值"></a>4.2 处理重复值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查重复</span></span><br><span class="line"><span class="built_in">print</span>(df.duplicated())      <span class="comment"># 布尔序列</span></span><br><span class="line"><span class="built_in">print</span>(df.duplicated().<span class="built_in">sum</span>()) <span class="comment"># 重复数量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除重复</span></span><br><span class="line">df_unique = df.drop_duplicates()</span><br><span class="line">df_unique = df.drop_duplicates(subset=[<span class="string">&#x27;A&#x27;</span>])  <span class="comment"># 按指定列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 保留最后一个</span></span><br><span class="line">df_unique = df.drop_duplicates(keep=<span class="string">&#x27;last&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不删除（保留所有）</span></span><br><span class="line">df_unique = df.drop_duplicates(keep=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="4-3-数据类型转换"><a href="#4-3-数据类型转换" class="headerlink" title="4.3 数据类型转换"></a>4.3 数据类型转换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: [<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>],</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>: [<span class="string">&#x27;2021-01-01&#x27;</span>, <span class="string">&#x27;2021-01-02&#x27;</span>, <span class="string">&#x27;2021-01-03&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类型转换</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].astype(<span class="built_in">int</span>)</span><br><span class="line">df[<span class="string">&#x27;b&#x27;</span>] = df[<span class="string">&#x27;b&#x27;</span>].astype(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 日期转换</span></span><br><span class="line">df[<span class="string">&#x27;c&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分类类型（节省内存）</span></span><br><span class="line">df[<span class="string">&#x27;category&#x27;</span>] = df[<span class="string">&#x27;a&#x27;</span>].astype(<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数值转换（处理非数值）</span></span><br><span class="line">df[<span class="string">&#x27;a&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;a&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>)  <span class="comment"># 无法转换的变为 NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - category 类型适合取值有限的列（如性别、状态）</span></span><br><span class="line"><span class="comment"># - 可以显著减少内存占用</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-字符串处理"><a href="#4-4-字符串处理" class="headerlink" title="4.4 字符串处理"></a>4.4 字符串处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;  Zhang San &#x27;</span>, <span class="string">&#x27;li si&#x27;</span>, <span class="string">&#x27;WANG wu&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除空格</span></span><br><span class="line">df[<span class="string">&#x27;name&#x27;</span>] = df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">str</span>.strip()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 大小写</span></span><br><span class="line">df[<span class="string">&#x27;name&#x27;</span>] = df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">str</span>.lower()</span><br><span class="line">df[<span class="string">&#x27;name&#x27;</span>] = df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">str</span>.upper()</span><br><span class="line">df[<span class="string">&#x27;name&#x27;</span>] = df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">str</span>.title()  <span class="comment"># 首字母大写</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;full_name&#x27;</span>: [<span class="string">&#x27;Zhang San&#x27;</span>, <span class="string">&#x27;Li Si&#x27;</span>]&#125;)</span><br><span class="line">df[[<span class="string">&#x27;first&#x27;</span>, <span class="string">&#x27;last&#x27;</span>]] = df[<span class="string">&#x27;full_name&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27; &#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换</span></span><br><span class="line">df[<span class="string">&#x27;name&#x27;</span>] = df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">str</span>.replace(<span class="string">&#x27;Zhang&#x27;</span>, <span class="string">&#x27;张&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取（正则）</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;phone&#x27;</span>: [<span class="string">&#x27;138-0000-0000&#x27;</span>, <span class="string">&#x27;139-1111-1111&#x27;</span>]&#125;)</span><br><span class="line">df[<span class="string">&#x27;area&#x27;</span>] = df[<span class="string">&#x27;phone&#x27;</span>].<span class="built_in">str</span>.extract(<span class="string">r&#x27;(\d&#123;3&#125;)-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - str 访问器提供所有字符串方法</span></span><br><span class="line"><span class="comment"># - expand=True 返回 DataFrame</span></span><br></pre></td></tr></table></figure>

<h2 id="五、数据转换"><a href="#五、数据转换" class="headerlink" title="五、数据转换"></a>五、数据转换</h2><h3 id="5-1-添加-删除列"><a href="#5-1-添加-删除列" class="headerlink" title="5.1 添加&#x2F;删除列"></a>5.1 添加&#x2F;删除列</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>],</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: [<span class="number">10000</span>, <span class="number">15000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加列</span></span><br><span class="line">df[<span class="string">&#x27;bonus&#x27;</span>] = df[<span class="string">&#x27;salary&#x27;</span>] * <span class="number">0.1</span></span><br><span class="line">df[<span class="string">&#x27;total&#x27;</span>] = df[<span class="string">&#x27;salary&#x27;</span>] + df[<span class="string">&#x27;bonus&#x27;</span>]</span><br><span class="line">df[<span class="string">&#x27;city&#x27;</span>] = <span class="string">&#x27;北京&#x27;</span>  <span class="comment"># 常量列</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 assign（链式调用）</span></span><br><span class="line">df = df.assign(</span><br><span class="line">    tax=df[<span class="string">&#x27;salary&#x27;</span>] * <span class="number">0.1</span>,</span><br><span class="line">    net_salary=<span class="keyword">lambda</span> x: x[<span class="string">&#x27;salary&#x27;</span>] - x[<span class="string">&#x27;tax&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除列</span></span><br><span class="line">df = df.drop(<span class="string">&#x27;bonus&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">df.drop([<span class="string">&#x27;city&#x27;</span>, <span class="string">&#x27;total&#x27;</span>], axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名列</span></span><br><span class="line">df = df.rename(columns=&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;姓名&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="string">&#x27;年龄&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="5-2-apply-和-map"><a href="#5-2-apply-和-map" class="headerlink" title="5.2 apply 和 map"></a>5.2 apply 和 map</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;score&#x27;</span>: [<span class="number">85</span>, <span class="number">92</span>, <span class="number">78</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># apply 应用函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">grade</span>(<span class="params">score</span>):</span><br><span class="line">    <span class="keyword">if</span> score &gt;= <span class="number">90</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> score &gt;= <span class="number">80</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;grade&#x27;</span>] = df[<span class="string">&#x27;score&#x27;</span>].apply(grade)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 lambda</span></span><br><span class="line">df[<span class="string">&#x27;score_doubled&#x27;</span>] = df[<span class="string">&#x27;score&#x27;</span>].apply(<span class="keyword">lambda</span> x: x * <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按行应用</span></span><br><span class="line">df[<span class="string">&#x27;info&#x27;</span>] = df.apply(<span class="keyword">lambda</span> row: <span class="string">f&quot;<span class="subst">&#123;row[<span class="string">&#x27;name&#x27;</span>]&#125;</span> - <span class="subst">&#123;row[<span class="string">&#x27;score&#x27;</span>]&#125;</span>&quot;</span>, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># map 映射（Series）</span></span><br><span class="line">mapping = &#123;<span class="string">&#x27;张三&#x27;</span>: <span class="string">&#x27;Male&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>: <span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>: <span class="string">&#x27;Male&#x27;</span>&#125;</span><br><span class="line">df[<span class="string">&#x27;gender&#x27;</span>] = df[<span class="string">&#x27;name&#x27;</span>].<span class="built_in">map</span>(mapping)</span><br><span class="line"></span><br><span class="line"><span class="comment"># replace 替换</span></span><br><span class="line">df[<span class="string">&#x27;grade&#x27;</span>] = df[<span class="string">&#x27;grade&#x27;</span>].replace(&#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;优秀&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;良好&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;及格&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - apply 可用于 Series 和 DataFrame</span></span><br><span class="line"><span class="comment"># - map 只用于 Series</span></span><br><span class="line"><span class="comment"># - 向量化操作比 apply 快，优先使用向量化</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-排序"><a href="#5-3-排序" class="headerlink" title="5.3 排序"></a>5.3 排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;score&#x27;</span>: [<span class="number">85</span>, <span class="number">92</span>, <span class="number">78</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">22</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按值排序</span></span><br><span class="line">df_sorted = df.sort_values(<span class="string">&#x27;score&#x27;</span>)           <span class="comment"># 升序</span></span><br><span class="line">df_sorted = df.sort_values(<span class="string">&#x27;score&#x27;</span>, ascending=<span class="literal">False</span>)  <span class="comment"># 降序</span></span><br><span class="line">df_sorted = df.sort_values([<span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;score&#x27;</span>])  <span class="comment"># 多列排序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按索引排序</span></span><br><span class="line">df_sorted = df.sort_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排名</span></span><br><span class="line">df[<span class="string">&#x27;rank&#x27;</span>] = df[<span class="string">&#x27;score&#x27;</span>].rank(ascending=<span class="literal">False</span>)  <span class="comment"># 排名</span></span><br></pre></td></tr></table></figure>

<h2 id="六、数据聚合"><a href="#六、数据聚合" class="headerlink" title="六、数据聚合"></a>六、数据聚合</h2><h3 id="6-1-基础统计"><a href="#6-1-基础统计" class="headerlink" title="6.1 基础统计"></a>6.1 基础统计</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用统计</span></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">sum</span>())        <span class="comment"># 求和</span></span><br><span class="line"><span class="built_in">print</span>(df.mean())       <span class="comment"># 均值</span></span><br><span class="line"><span class="built_in">print</span>(df.median())     <span class="comment"># 中位数</span></span><br><span class="line"><span class="built_in">print</span>(df.std())        <span class="comment"># 标准差</span></span><br><span class="line"><span class="built_in">print</span>(df.var())        <span class="comment"># 方差</span></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">min</span>())        <span class="comment"># 最小值</span></span><br><span class="line"><span class="built_in">print</span>(df.<span class="built_in">max</span>())        <span class="comment"># 最大值</span></span><br><span class="line"><span class="built_in">print</span>(df.count())      <span class="comment"># 计数</span></span><br><span class="line"><span class="built_in">print</span>(df.quantile(<span class="number">0.25</span>))  <span class="comment"># 25% 分位数</span></span><br><span class="line"><span class="built_in">print</span>(df.describe())   <span class="comment"># 完整统计摘要</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 相关系数</span></span><br><span class="line"><span class="built_in">print</span>(df.corr())</span><br></pre></td></tr></table></figure>

<h3 id="6-2-groupby-分组聚合"><a href="#6-2-groupby-分组聚合" class="headerlink" title="6.2 groupby 分组聚合"></a>6.2 groupby 分组聚合</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;department&#x27;</span>: [<span class="string">&#x27;HR&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>, <span class="string">&#x27;HR&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: [<span class="number">5000</span>, <span class="number">10000</span>, <span class="number">6000</span>, <span class="number">12000</span>, <span class="number">8000</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">27</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单列分组</span></span><br><span class="line">grouped = df.groupby(<span class="string">&#x27;department&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(grouped[<span class="string">&#x27;salary&#x27;</span>].mean())  <span class="comment"># 各部门平均工资</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多列分组</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby([<span class="string">&#x27;department&#x27;</span>, <span class="string">&#x27;age&#x27;</span>])[<span class="string">&#x27;salary&#x27;</span>].<span class="built_in">sum</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个聚合函数</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;department&#x27;</span>)[<span class="string">&#x27;salary&#x27;</span>].agg([<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;count&#x27;</span>]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不同列不同聚合</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;department&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: [<span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;sum&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;max&#x27;</span>]</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义聚合</span></span><br><span class="line"><span class="built_in">print</span>(df.groupby(<span class="string">&#x27;department&#x27;</span>)[<span class="string">&#x27;salary&#x27;</span>].agg(<span class="keyword">lambda</span> x: x.<span class="built_in">max</span>() - x.<span class="built_in">min</span>()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重置索引</span></span><br><span class="line">result = df.groupby(<span class="string">&#x27;department&#x27;</span>)[<span class="string">&#x27;salary&#x27;</span>].mean().reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - groupby 是数据分析的核心操作</span></span><br><span class="line"><span class="comment"># - agg 可以应用多个聚合函数</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-pivot-table-透视表"><a href="#6-3-pivot-table-透视表" class="headerlink" title="6.3 pivot_table 透视表"></a>6.3 pivot_table 透视表</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;date&#x27;</span>: [<span class="string">&#x27;2024-01&#x27;</span>, <span class="string">&#x27;2024-01&#x27;</span>, <span class="string">&#x27;2024-02&#x27;</span>, <span class="string">&#x27;2024-02&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;region&#x27;</span>: [<span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>, <span class="string">&#x27;North&#x27;</span>, <span class="string">&#x27;South&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;sales&#x27;</span>: [<span class="number">100</span>, <span class="number">150</span>, <span class="number">120</span>, <span class="number">180</span>],</span><br><span class="line">    <span class="string">&#x27;profit&#x27;</span>: [<span class="number">20</span>, <span class="number">30</span>, <span class="number">25</span>, <span class="number">35</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基础透视表</span></span><br><span class="line">pivot = pd.pivot_table(</span><br><span class="line">    df,</span><br><span class="line">    values=<span class="string">&#x27;sales&#x27;</span>,</span><br><span class="line">    index=<span class="string">&#x27;region&#x27;</span>,</span><br><span class="line">    columns=<span class="string">&#x27;date&#x27;</span>,</span><br><span class="line">    aggfunc=<span class="string">&#x27;sum&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多值多聚合</span></span><br><span class="line">pivot = pd.pivot_table(</span><br><span class="line">    df,</span><br><span class="line">    values=[<span class="string">&#x27;sales&#x27;</span>, <span class="string">&#x27;profit&#x27;</span>],</span><br><span class="line">    index=<span class="string">&#x27;region&#x27;</span>,</span><br><span class="line">    aggfunc=&#123;<span class="string">&#x27;sales&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;profit&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 填充缺失值</span></span><br><span class="line">pivot = pd.pivot_table(</span><br><span class="line">    df,</span><br><span class="line">    values=<span class="string">&#x27;sales&#x27;</span>,</span><br><span class="line">    index=<span class="string">&#x27;region&#x27;</span>,</span><br><span class="line">    columns=<span class="string">&#x27;date&#x27;</span>,</span><br><span class="line">    fill_value=<span class="number">0</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="七、数据合并"><a href="#七、数据合并" class="headerlink" title="七、数据合并"></a>七、数据合并</h2><h3 id="7-1-concat-连接"><a href="#7-1-concat-连接" class="headerlink" title="7.1 concat 连接"></a>7.1 concat 连接</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]&#125;)</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">3</span>, <span class="number">4</span>], <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 垂直连接</span></span><br><span class="line">result = pd.concat([df1, df2], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 水平连接</span></span><br><span class="line">result = pd.concat([df1, df2], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略索引</span></span><br><span class="line">result = pd.concat([df1, df2], ignore_index=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加键</span></span><br><span class="line">result = pd.concat([df1, df2], keys=[<span class="string">&#x27;first&#x27;</span>, <span class="string">&#x27;second&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h3 id="7-2-merge-合并"><a href="#7-2-merge-合并" class="headerlink" title="7.2 merge 合并"></a>7.2 merge 合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>],</span><br><span class="line">    <span class="string">&#x27;score&#x27;</span>: [<span class="number">85</span>, <span class="number">92</span>, <span class="number">78</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 内连接（默认）</span></span><br><span class="line">merged = pd.merge(df1, df2, on=<span class="string">&#x27;id&#x27;</span>)  <span class="comment"># 只有 id 1, 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 左连接</span></span><br><span class="line">merged = pd.merge(df1, df2, on=<span class="string">&#x27;id&#x27;</span>, how=<span class="string">&#x27;left&#x27;</span>)  <span class="comment"># 保留 df1 所有行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 右连接</span></span><br><span class="line">merged = pd.merge(df1, df2, on=<span class="string">&#x27;id&#x27;</span>, how=<span class="string">&#x27;right&#x27;</span>)  <span class="comment"># 保留 df2 所有行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 外连接</span></span><br><span class="line">merged = pd.merge(df1, df2, on=<span class="string">&#x27;id&#x27;</span>, how=<span class="string">&#x27;outer&#x27;</span>)  <span class="comment"># 保留所有行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 不同列名合并</span></span><br><span class="line">merged = pd.merge(df1, df2, left_on=<span class="string">&#x27;id1&#x27;</span>, right_on=<span class="string">&#x27;id2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多列合并</span></span><br><span class="line">merged = pd.merge(df1, df2, on=[<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;date&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - merge 类似 SQL 的 JOIN</span></span><br><span class="line"><span class="comment"># - how 参数决定连接类型</span></span><br></pre></td></tr></table></figure>

<h2 id="八、文件读写"><a href="#八、文件读写" class="headerlink" title="八、文件读写"></a>八、文件读写</h2><h3 id="8-1-CSV-文件"><a href="#8-1-CSV-文件" class="headerlink" title="8.1 CSV 文件"></a>8.1 CSV 文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, sep=<span class="string">&#x27;\t&#x27;</span>)  <span class="comment"># TSV</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, header=<span class="number">0</span>)  <span class="comment"># 第一行为表头</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, names=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>])  <span class="comment"># 指定列名</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, usecols=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>])  <span class="comment"># 只读取部分列</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, nrows=<span class="number">100</span>)  <span class="comment"># 只读前 100 行</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, dtype=&#123;<span class="string">&#x27;A&#x27;</span>: <span class="built_in">str</span>&#125;)  <span class="comment"># 指定类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入</span></span><br><span class="line">df.to_csv(<span class="string">&#x27;output.csv&#x27;</span>, index=<span class="literal">False</span>)  <span class="comment"># 不保存索引</span></span><br><span class="line">df.to_csv(<span class="string">&#x27;output.csv&#x27;</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>)  <span class="comment"># Excel 兼容</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2-Excel-文件"><a href="#8-2-Excel-文件" class="headerlink" title="8.2 Excel 文件"></a>8.2 Excel 文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>)</span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>)</span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;data.xlsx&#x27;</span>, sheet_name=[<span class="string">&#x27;Sheet1&#x27;</span>, <span class="string">&#x27;Sheet2&#x27;</span>])  <span class="comment"># 多个 sheet</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入</span></span><br><span class="line">df.to_excel(<span class="string">&#x27;output.xlsx&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">df.to_excel(<span class="string">&#x27;output.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;数据&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个 DataFrame 写入不同 sheet</span></span><br><span class="line"><span class="keyword">with</span> pd.ExcelWriter(<span class="string">&#x27;output.xlsx&#x27;</span>) <span class="keyword">as</span> writer:</span><br><span class="line">    df1.to_excel(writer, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">    df2.to_excel(writer, sheet_name=<span class="string">&#x27;Sheet2&#x27;</span>, index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="8-3-其他格式"><a href="#8-3-其他格式" class="headerlink" title="8.3 其他格式"></a>8.3 其他格式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JSON</span></span><br><span class="line">df = pd.read_json(<span class="string">&#x27;data.json&#x27;</span>)</span><br><span class="line">df.to_json(<span class="string">&#x27;output.json&#x27;</span>, force_ascii=<span class="literal">False</span>)  <span class="comment"># 保留中文</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL（需要 SQLAlchemy）</span></span><br><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line">engine = create_engine(<span class="string">&#x27;sqlite:///database.db&#x27;</span>)</span><br><span class="line">df = pd.read_sql(<span class="string">&#x27;SELECT * FROM table&#x27;</span>, engine)</span><br><span class="line">df.to_sql(<span class="string">&#x27;table&#x27;</span>, engine, if_exists=<span class="string">&#x27;replace&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Parquet（高效列式存储）</span></span><br><span class="line">df = pd.read_parquet(<span class="string">&#x27;data.parquet&#x27;</span>)</span><br><span class="line">df.to_parquet(<span class="string">&#x27;output.parquet&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pickle</span></span><br><span class="line">df.to_pickle(<span class="string">&#x27;data.pkl&#x27;</span>)</span><br><span class="line">df = pd.read_pickle(<span class="string">&#x27;data.pkl&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="九、实用技巧"><a href="#九、实用技巧" class="headerlink" title="九、实用技巧"></a>九、实用技巧</h2><h3 id="9-1-时间序列处理"><a href="#9-1-时间序列处理" class="headerlink" title="9.1 时间序列处理"></a>9.1 时间序列处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建日期范围</span></span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;2024-01-01&#x27;</span>, periods=<span class="number">365</span>, freq=<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置日期索引</span></span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;date&#x27;</span>])</span><br><span class="line">df = df.set_index(<span class="string">&#x27;date&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 日期提取</span></span><br><span class="line">df[<span class="string">&#x27;year&#x27;</span>] = df.index.year</span><br><span class="line">df[<span class="string">&#x27;month&#x27;</span>] = df.index.month</span><br><span class="line">df[<span class="string">&#x27;day&#x27;</span>] = df.index.day</span><br><span class="line">df[<span class="string">&#x27;weekday&#x27;</span>] = df.index.weekday  <span class="comment"># 0=周一</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重采样（降采样）</span></span><br><span class="line">daily = df.resample(<span class="string">&#x27;D&#x27;</span>).<span class="built_in">sum</span>()  <span class="comment"># 按天</span></span><br><span class="line">monthly = df.resample(<span class="string">&#x27;M&#x27;</span>).<span class="built_in">sum</span>()  <span class="comment"># 按月</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 移动平均</span></span><br><span class="line">df[<span class="string">&#x27;MA7&#x27;</span>] = df[<span class="string">&#x27;value&#x27;</span>].rolling(window=<span class="number">7</span>).mean()</span><br></pre></td></tr></table></figure>

<h3 id="9-2-条件格式化"><a href="#9-2-条件格式化" class="headerlink" title="9.2 条件格式化"></a>9.2 条件格式化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 样式显示</span></span><br><span class="line">df.style.<span class="built_in">format</span>(&#123;<span class="string">&#x27;salary&#x27;</span>: <span class="string">&#x27;$&#123;:,.0f&#125;&#x27;</span>&#125;)  <span class="comment"># 格式化</span></span><br><span class="line">df.style.background_gradient(cmap=<span class="string">&#x27;Blues&#x27;</span>)  <span class="comment"># 热力图</span></span><br><span class="line">df.style.highlight_max(color=<span class="string">&#x27;yellow&#x27;</span>)  <span class="comment"># 高亮最大值</span></span><br></pre></td></tr></table></figure>

<h3 id="9-3-内存优化"><a href="#9-3-内存优化" class="headerlink" title="9.3 内存优化"></a>9.3 内存优化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看内存使用</span></span><br><span class="line"><span class="built_in">print</span>(df.memory_usage(deep=<span class="literal">True</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 优化数据类型</span></span><br><span class="line">df[<span class="string">&#x27;category&#x27;</span>] = df[<span class="string">&#x27;category&#x27;</span>].astype(<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;int_col&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;int_col&#x27;</span>], downcast=<span class="string">&#x27;integer&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;float_col&#x27;</span>] = pd.to_numeric(df[<span class="string">&#x27;float_col&#x27;</span>], downcast=<span class="string">&#x27;float&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="十、实践建议"><a href="#十、实践建议" class="headerlink" title="十、实践建议"></a>十、实践建议</h2><blockquote>
<p><strong>提醒自己</strong>：</p>
<ol>
<li><strong>先了解数据</strong>：用 head()、info()、describe() 快速了解</li>
<li><strong>处理缺失值</strong>：根据业务选择合适的填充策略</li>
<li><strong>类型优化</strong>：使用 category 等节省内存</li>
<li><strong>链式调用</strong>：提高代码可读性</li>
<li><strong>保存中间结果</strong>：复杂处理时分步保存</li>
<li><strong>向量化优先</strong>：避免使用循环</li>
</ol>
</blockquote>
<h2 id="十一、练习"><a href="#十一、练习" class="headerlink" title="十一、练习"></a>十一、练习</h2><ol>
<li>读取 CSV 文件，统计每列的缺失值比例</li>
<li>对数据进行分组聚合，计算各组的均值、总和、计数</li>
<li>使用 pivot_table 创建销售数据透视表</li>
<li>合并两个 DataFrame，比较不同连接方式的结果</li>
<li>对时间序列数据进行重采样和移动平均计算</li>
</ol>
<hr>
<p><strong>上一篇</strong>：[Python 数据科学（一）：NumPy 数值计算](&#x2F;2026&#x2F;02&#x2F;24&#x2F;Python-数据科学（一）NumPy 数值计算&#x2F;)</p>
<p><strong>下一篇</strong>：[Python 数据科学（三）：PyArrow 高性能数据操作](&#x2F;2026&#x2F;02&#x2F;24&#x2F;Python-数据科学（三）PyArrow 高性能数据操作&#x2F;)</p>
<p><strong>参考资源</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/">Pandas 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/user_guide/10min.html">Pandas 10 分钟入门</a></li>
<li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/docs/user_guide/cookbook.html">Pandas 烹饪书</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/DataFrame/">DataFrame</a><a class="post-meta__tags" href="/tags/Pandas/">Pandas</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2004-07%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" title="MySQL 进阶教程 04-07 窗口函数实战案例"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">MySQL 进阶教程 04-07 窗口函数实战案例</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 04-07 窗口函数实战案例本文通过综合实战案例，展示如何运用窗口函数解决实际业务问题。案例涵盖连续登录、Top N 问题、累计分析、复杂报表等常见场景。 一、连续登录问题1.1 问题描述场景：用户签到系统，找出连续签到 3 天以上的用户。 1234567891011121314-- 准备签到数据DROP TABLE IF EXISTS user_signin;CREATE TABLE user_signin (    id INT PRIMARY KEY AUTO_INCREMENT,    user_id INT NOT NULL,    signin_date DATE NOT NULL,    UNIQUE KEY uk_user_date (user_id, signin_date)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;INSERT INTO user_signin (user_id, signin_date) VALUES(1, &#x27;2024-01-01&#x27;), (1, &#x27;202...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2012-01%20%E8%A7%86%E5%9B%BE%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 12-01 视图详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 进阶教程 12-01 视图详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 12-01 视图详解视图是数据库中的虚拟表，可以简化复杂查询、提高安全性。本文将详细介绍视图的概念、创建、使用和限制。 一、视图介绍及语法1.1 什么是视图？视图（View） 是基于 SQL 查询结果的虚拟表，视图本身不存储数据，只存储查询定义。 123视图 vs 表：├── 表：存储实际数据└── 视图：存储查询定义，数据来自基表  1.2 视图的作用   作用 说明    简化查询 将复杂查询封装为视图   数据安全 只暴露部分字段给用户   逻辑独立 基表结构变化不影响应用   重用 SQL 避免重复编写相同查询   1.3 创建视图语法12345678910111213-- 基本语法CREATE [OR REPLACE] VIEW view_name [(column_list)]AS select_statement[WITH [CASCADED | LOCAL] CHECK OPTION];-- 示例：创建员工信息视图CREATE VIEW v_emp_info ASSELECT e.id, e.name, e.salary, d.dept_na...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/" title="Python 数据科学（三）PyArrow 高性能数据操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 数据科学（三）PyArrow 高性能数据操作</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（三）PyArrow 高性能数据操作PyArrow 是一个高性能的数据处理库，提供列式内存格式和快速的数据 I&#x2F;O。本篇将介绍 PyArrow 的核心功能和使用技巧。 一、PyArrow 简介1.1 为什么使用 PyArrow？ 高性能：列式存储，比 Pandas 快数倍到数十倍 零拷贝：与 Pandas、NumPy 无缝集成，无需数据复制 跨语言：支持 Python、C++、Java、R 等 大文件处理：支持流式处理超大文件 现代格式：Parquet、Feather 等高效格式支持  1.2 安装与导入1pip install pyarrow  1234567import pyarrow as paimport pyarrow.parquet as pqimport pyarrow.csv as csvimport pandas as pd# 查看版本print(pa.__version__)  二、PyArrow 数据结构2.1 Table（表格）1234567891011121314151617181920import pyarrow as ...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 常用库（三）logging 日志模块</div></div><div class="info-2"><div class="info-item-1">Python 常用库（三）logging 日志模块日志是程序调试、监控和问题排查的重要工具。本篇将详细介绍 Python 内置的 logging 模块。 一、logging 简介1.1 为什么使用 logging？ 标准库：无需安装，开箱即用 灵活配置：可配置输出格式、级别、目标等 高性能：内置优化，适合生产环境 可扩展：支持自定义 Handler、Formatter、Filter  1.2 日志级别   级别 数值 说明 使用场景    DEBUG 10 调试信息 开发调试时的详细信息   INFO 20 一般信息 程序正常运行的信息   WARNING 30 警告信息 不影响运行但需要注意   ERROR 40 错误信息 程序错误但不影响继续运行   CRITICAL 50 严重错误 严重错误，程序可能无法继续   1234567import logginglogging.debug(&quot;调试信息&quot;)logging.info(&quot;一般信息&quot;)logging.warning(&quot;警告信息&quot;)logging.error(&qu...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%85%A5%E9%97%A8/" title="Python 基础教程（一）基础语法入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（一）基础语法入门</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（一）基础语法入门欢迎来到 Python 基础教程系列！本篇将从零开始介绍 Python 的基础语法，帮助你快速上手 Python 编程。 一、Python 简介1.1 为什么选择 Python？ 语法简洁：代码可读性强，接近自然语言 生态丰富：拥有庞大的第三方库生态系统 应用广泛：Web 开发、数据分析、人工智能、自动化脚本等 跨平台：Windows、Linux、macOS 均可运行 社区活跃：遇到问题容易找到解决方案  1.2 Python 版本选择 提醒自己：务必使用 Python 3.x（推荐 3.8+），Python 2 已停止维护。  二、环境搭建2.1 安装 PythonWindows：  访问 https://www.python.org/downloads/ 下载最新稳定版（如 3.11.x） 安装时勾选 “Add Python to PATH”  验证安装： 123python --version# 或python3 --version  2.2 包管理工具 pip1234567891011121314151617181920212223...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" title="Python 基础教程（二）面向对象编程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（二）面向对象编程</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（二）面向对象编程面向对象编程（OOP）是 Python 的核心编程范式之一。本篇将详细介绍 Python 中的类与对象、继承、多态等核心概念。 一、面向对象基础1.1 什么是面向对象？面向对象编程（Object-Oriented Programming, OOP） 是一种编程范式，它将数据和处理数据的方法封装在一起，形成”对象”。 核心概念：  类（Class）：对象的模板&#x2F;蓝图，定义对象的属性和方法 对象（Object）：类的实例，具体的实体 属性（Attribute）：对象的特征&#x2F;数据 方法（Method）：对象的行为&#x2F;操作  比喻理解：  类 &#x3D; 房屋设计图 对象 &#x3D; 根据设计图建造的具体房屋  1.2 为什么使用面向对象？ 提醒自己：  代码复用：继承机制减少重复代码 易于维护：封装使代码结构清晰 模块化：不同对象独立工作，降低耦合 模拟现实：更符合人类思维方式   二、类的定义与使用2.1 定义类123456789101112131415161718192021222324252627282930...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%80%EF%BC%89NumPy%20%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" title="Python 数据科学（一）NumPy 数值计算"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 数据科学（一）NumPy 数值计算</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（一）NumPy 数值计算NumPy 是 Python 数据科学的基石。本篇将介绍 NumPy 的核心功能，包括 ndarray 数组、向量化计算、广播机制等。 一、NumPy 简介1.1 为什么使用 NumPy？ 性能优势：底层用 C 实现，比纯 Python 快 10-100 倍 内存效率：连续存储，占用更少内存 向量化操作：无需循环，代码更简洁 生态基础：Pandas、SciPy、scikit-learn 等都基于 NumPy  1.2 安装与导入1pip install numpy  1234import numpy as np# 查看版本print(np.__version__)  二、ndarray 数组2.1 创建数组123456789101112131415161718192021222324252627282930313233import numpy as np# 从列表创建arr1 = np.array([1, 2, 3, 4, 5])arr2 = np.array([[1, 2, 3], [4, 5, 6]])  # 二维数组# 特殊数...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" title="Python 基础教程（三）异常处理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（三）异常处理</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（三）异常处理异常处理是编写健壮程序的关键。本篇将介绍 Python 中的异常处理机制，以及如何优雅地处理错误。 一、异常基础1.1 什么是异常？异常（Exception） 是程序运行过程中发生的错误事件。当 Python 无法正常执行代码时，会抛出异常。 12345678910111213141516171819202122232425262728# 常见异常示例# ZeroDivisionError: 除以零result = 10 / 0# FileNotFoundError: 文件不存在with open(&quot;不存在的文件.txt&quot;, &quot;r&quot;) as f:    content = f.read()# IndexError: 索引超出范围lst = [1, 2, 3]print(lst[10])# KeyError: 字典键不存在d = &#123;&quot;a&quot;: 1, &quot;b&quot;: 2&#125;print(d[&quot;c&quot;])# ValueError: 值错误num ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Python-%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Python 数据科学（二）Pandas 数据处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81Pandas-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">一、Pandas 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-Pandas%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 为什么使用 Pandas？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%AF%BC%E5%85%A5"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 安装与导入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Series-%E5%92%8C-DataFrame"><span class="toc-number">1.2.</span> <span class="toc-text">二、Series 和 DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Series%EF%BC%88%E7%B3%BB%E5%88%97%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 Series（系列）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-DataFrame%EF%BC%88%E6%95%B0%E6%8D%AE%E6%A1%86%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 DataFrame（数据框）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%95%B0%E6%8D%AE%E9%80%89%E6%8B%A9%E4%B8%8E%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.</span> <span class="toc-text">三、数据选择与索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%97%E9%80%89%E6%8B%A9"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 列选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%A1%8C%E9%80%89%E6%8B%A9"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 行选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%8D%95%E5%85%83%E6%A0%BC%E9%80%89%E6%8B%A9"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 单元格选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95%E8%BF%9B%E9%98%B6"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 布尔索引进阶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="toc-number">1.4.</span> <span class="toc-text">四、数据清洗</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 处理缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%A4%84%E7%90%86%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 处理重复值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 数据类型转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 字符串处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.5.</span> <span class="toc-text">五、数据转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%B7%BB%E5%8A%A0-%E5%88%A0%E9%99%A4%E5%88%97"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 添加&#x2F;删除列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-apply-%E5%92%8C-map"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 apply 和 map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%8E%92%E5%BA%8F"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 排序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88"><span class="toc-number">1.6.</span> <span class="toc-text">六、数据聚合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%9F%BA%E7%A1%80%E7%BB%9F%E8%AE%A1"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 基础统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-groupby-%E5%88%86%E7%BB%84%E8%81%9A%E5%90%88"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 groupby 分组聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-pivot-table-%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 pivot_table 透视表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6"><span class="toc-number">1.7.</span> <span class="toc-text">七、数据合并</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-concat-%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 concat 连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-merge-%E5%90%88%E5%B9%B6"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 merge 合并</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">1.8.</span> <span class="toc-text">八、文件读写</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-CSV-%E6%96%87%E4%BB%B6"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 CSV 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-Excel-%E6%96%87%E4%BB%B6"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 Excel 文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E5%85%B6%E4%BB%96%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 其他格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-number">1.9.</span> <span class="toc-text">九、实用技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%A4%84%E7%90%86"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 时间序列处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 条件格式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E5%86%85%E5%AD%98%E4%BC%98%E5%8C%96"><span class="toc-number">1.9.3.</span> <span class="toc-text">9.3 内存优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E5%AE%9E%E8%B7%B5%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.10.</span> <span class="toc-text">十、实践建议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E7%BB%83%E4%B9%A0"><span class="toc-number">1.11.</span> <span class="toc-text">十一、练习</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%A6%E8%A7%A3%20-%20%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E3%80%81%E6%95%B0%E6%8D%AE%E5%88%86%E5%B1%82%E4%B8%8E%20SCD%20%E5%A4%84%E7%90%86/" title="数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理">数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-10%20MyCat%20%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7/" title="MySQL 运维篇 04-10 MyCat 管理与监控">MySQL 运维篇 04-10 MyCat 管理与监控</a><time datetime="2026-02-24T12:05:00.000Z" title="发表于 2026-02-24 20:05:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>