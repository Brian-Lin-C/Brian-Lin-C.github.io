<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Python 数据科学（三）PyArrow 高性能数据操作 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Python 数据科学（三）PyArrow 高性能数据操作PyArrow 是一个高性能的数据处理库，提供列式内存格式和快速的数据 I&#x2F;O。本篇将介绍 PyArrow 的核心功能和使用技巧。 一、PyArrow 简介1.1 为什么使用 PyArrow？ 高性能：列式存储，比 Pandas 快数倍到数十倍 零拷贝：与 Pandas、NumPy 无缝集成，无需数据复制 跨语言：支持 Pytho">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 数据科学（三）PyArrow 高性能数据操作">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="Python 数据科学（三）PyArrow 高性能数据操作PyArrow 是一个高性能的数据处理库，提供列式内存格式和快速的数据 I&#x2F;O。本篇将介绍 PyArrow 的核心功能和使用技巧。 一、PyArrow 简介1.1 为什么使用 PyArrow？ 高性能：列式存储，比 Pandas 快数倍到数十倍 零拷贝：与 Pandas、NumPy 无缝集成，无需数据复制 跨语言：支持 Pytho">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T08:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T03:37:32.674Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="DataFrame">
<meta property="article:tag" content="PyArrow">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="高性能">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Python 数据科学（三）PyArrow 高性能数据操作",
  "url": "https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T08:00:00.000Z",
  "dateModified": "2026-02-24T03:37:32.674Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python 数据科学（三）PyArrow 高性能数据操作',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">Python 数据科学（三）PyArrow 高性能数据操作</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Python 数据科学（三）PyArrow 高性能数据操作</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T08:00:00.000Z" title="发表于 2026-02-24 16:00:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T03:37:32.674Z" title="更新于 2026-02-24 11:37:32">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python-%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/">Python 数据科学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Python-数据科学（三）PyArrow-高性能数据操作"><a href="#Python-数据科学（三）PyArrow-高性能数据操作" class="headerlink" title="Python 数据科学（三）PyArrow 高性能数据操作"></a>Python 数据科学（三）PyArrow 高性能数据操作</h1><p>PyArrow 是一个高性能的数据处理库，提供列式内存格式和快速的数据 I&#x2F;O。本篇将介绍 PyArrow 的核心功能和使用技巧。</p>
<h2 id="一、PyArrow-简介"><a href="#一、PyArrow-简介" class="headerlink" title="一、PyArrow 简介"></a>一、PyArrow 简介</h2><h3 id="1-1-为什么使用-PyArrow？"><a href="#1-1-为什么使用-PyArrow？" class="headerlink" title="1.1 为什么使用 PyArrow？"></a>1.1 为什么使用 PyArrow？</h3><ul>
<li><strong>高性能</strong>：列式存储，比 Pandas 快数倍到数十倍</li>
<li><strong>零拷贝</strong>：与 Pandas、NumPy 无缝集成，无需数据复制</li>
<li><strong>跨语言</strong>：支持 Python、C++、Java、R 等</li>
<li><strong>大文件处理</strong>：支持流式处理超大文件</li>
<li><strong>现代格式</strong>：Parquet、Feather 等高效格式支持</li>
</ul>
<h3 id="1-2-安装与导入"><a href="#1-2-安装与导入" class="headerlink" title="1.2 安装与导入"></a>1.2 安装与导入</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyarrow</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyarrow <span class="keyword">as</span> pa</span><br><span class="line"><span class="keyword">import</span> pyarrow.parquet <span class="keyword">as</span> pq</span><br><span class="line"><span class="keyword">import</span> pyarrow.csv <span class="keyword">as</span> csv</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line"><span class="built_in">print</span>(pa.__version__)</span><br></pre></td></tr></table></figure>

<h2 id="二、PyArrow-数据结构"><a href="#二、PyArrow-数据结构" class="headerlink" title="二、PyArrow 数据结构"></a>二、PyArrow 数据结构</h2><h3 id="2-1-Table（表格）"><a href="#2-1-Table（表格）" class="headerlink" title="2.1 Table（表格）"></a>2.1 Table（表格）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyarrow <span class="keyword">as</span> pa</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从字典创建</span></span><br><span class="line">table = pa.table(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;王五&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>],</span><br><span class="line">    <span class="string">&#x27;city&#x27;</span>: [<span class="string">&#x27;北京&#x27;</span>, <span class="string">&#x27;上海&#x27;</span>, <span class="string">&#x27;广州&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从 Pandas DataFrame 创建（零拷贝）</span></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: [<span class="number">25</span>, <span class="number">30</span>]</span><br><span class="line">&#125;)</span><br><span class="line">table = pa.Table.from_pandas(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转回 Pandas（零拷贝）</span></span><br><span class="line">df = table.to_pandas()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：PyArrow Table 与 Pandas DataFrame 互转非常高效</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-数据类型"><a href="#2-2-数据类型" class="headerlink" title="2.2 数据类型"></a>2.2 数据类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本类型</span></span><br><span class="line">pa.int8()      <span class="comment"># 8 位整数</span></span><br><span class="line">pa.int32()     <span class="comment"># 32 位整数</span></span><br><span class="line">pa.int64()     <span class="comment"># 64 位整数</span></span><br><span class="line">pa.float32()   <span class="comment"># 单精度浮点</span></span><br><span class="line">pa.float64()   <span class="comment"># 双精度浮点</span></span><br><span class="line">pa.string()    <span class="comment"># 字符串</span></span><br><span class="line">pa.bool_()     <span class="comment"># 布尔值</span></span><br><span class="line">pa.timestamp() <span class="comment"># 时间戳</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 复杂类型</span></span><br><span class="line">pa.list_(pa.int32())           <span class="comment"># 列表</span></span><br><span class="line">pa.struct([(<span class="string">&#x27;x&#x27;</span>, pa.int32()), (<span class="string">&#x27;y&#x27;</span>, pa.int32())])  <span class="comment"># 结构体</span></span><br><span class="line">pa.dictionary(pa.int32(), pa.string())  <span class="comment"># 字典编码</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建带类型的数组</span></span><br><span class="line">arr = pa.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="built_in">type</span>=pa.int32())</span><br></pre></td></tr></table></figure>

<h3 id="2-3-Array-和-ChunkedArray"><a href="#2-3-Array-和-ChunkedArray" class="headerlink" title="2.3 Array 和 ChunkedArray"></a>2.3 Array 和 ChunkedArray</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Array（连续数组）</span></span><br><span class="line">arr = pa.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">arr = pa.array([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">arr = pa.array([<span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">True</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 带空值的数组</span></span><br><span class="line">arr = pa.array([<span class="number">1</span>, <span class="literal">None</span>, <span class="number">3</span>, <span class="literal">None</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ChunkedArray（分块数组，适合大数据）</span></span><br><span class="line">chunk1 = pa.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">chunk2 = pa.array([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line">chunked = pa.chunked_array([chunk1, chunk2])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(chunked))      <span class="comment"># 6</span></span><br><span class="line"><span class="built_in">print</span>(chunked.num_chunks)  <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - Array 是连续内存</span></span><br><span class="line"><span class="comment"># - ChunkedArray 由多个 Array 组成，适合流式处理</span></span><br></pre></td></tr></table></figure>

<h2 id="三、数据-I-O"><a href="#三、数据-I-O" class="headerlink" title="三、数据 I&#x2F;O"></a>三、数据 I&#x2F;O</h2><h3 id="3-1-Parquet-文件读写"><a href="#3-1-Parquet-文件读写" class="headerlink" title="3.1 Parquet 文件读写"></a>3.1 Parquet 文件读写</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyarrow.parquet <span class="keyword">as</span> pq</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建示例数据</span></span><br><span class="line">table = pa.table(&#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="built_in">range</span>(<span class="number">1000000</span>),</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: [i * <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000</span>)],</span><br><span class="line">    <span class="string">&#x27;category&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>] * <span class="number">333333</span> + [<span class="string">&#x27;A&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入 Parquet</span></span><br><span class="line">pq.write_table(table, <span class="string">&#x27;data.parquet&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入带压缩</span></span><br><span class="line">pq.write_table(table, <span class="string">&#x27;data.parquet&#x27;</span>, compression=<span class="string">&#x27;gzip&#x27;</span>)</span><br><span class="line">pq.write_table(table, <span class="string">&#x27;data.parquet&#x27;</span>, compression=<span class="string">&#x27;snappy&#x27;</span>)  <span class="comment"># 更快</span></span><br><span class="line">pq.write_table(table, <span class="string">&#x27;data.parquet&#x27;</span>, compression=<span class="string">&#x27;brotli&#x27;</span>)  <span class="comment"># 更高压缩率</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 Parquet</span></span><br><span class="line">table = pq.read_table(<span class="string">&#x27;data.parquet&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取部分列</span></span><br><span class="line">table = pq.read_table(<span class="string">&#x27;data.parquet&#x27;</span>, columns=[<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;value&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取部分行（行组过滤）</span></span><br><span class="line">parquet_file = pq.ParquetFile(<span class="string">&#x27;data.parquet&#x27;</span>)</span><br><span class="line">table = parquet_file.read_row_group(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 元数据</span></span><br><span class="line">meta = parquet_file.metadata</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;行数：<span class="subst">&#123;meta.num_rows&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;列数：<span class="subst">&#123;meta.num_columns&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;行组数：<span class="subst">&#123;meta.num_row_groups&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分区读取（适合大数据集）</span></span><br><span class="line"><span class="comment"># 数据按年/月分区存储</span></span><br><span class="line"><span class="comment"># data/year=2024/month=01/data.parquet</span></span><br><span class="line"><span class="comment"># data/year=2024/month=02/data.parquet</span></span><br><span class="line">dataset = pq.read_table(<span class="string">&#x27;data/&#x27;</span>, filters=[(<span class="string">&#x27;year&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="number">2024</span>), (<span class="string">&#x27;month&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="number">6</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - Parquet 是列式存储，读取特定列非常快</span></span><br><span class="line"><span class="comment"># - 压缩可以显著减小文件大小</span></span><br><span class="line"><span class="comment"># - 分区查询可以只读取需要的数据</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-CSV-文件读写"><a href="#3-2-CSV-文件读写" class="headerlink" title="3.2 CSV 文件读写"></a>3.2 CSV 文件读写</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyarrow.csv <span class="keyword">as</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 CSV</span></span><br><span class="line">table = csv.read_csv(<span class="string">&#x27;data.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取时指定类型</span></span><br><span class="line">table = csv.read_csv(<span class="string">&#x27;data.csv&#x27;</span>,</span><br><span class="line">    convert_options=csv.ConvertOptions(</span><br><span class="line">        column_types=&#123;</span><br><span class="line">            <span class="string">&#x27;id&#x27;</span>: pa.int32(),</span><br><span class="line">            <span class="string">&#x27;value&#x27;</span>: pa.float64(),</span><br><span class="line">            <span class="string">&#x27;category&#x27;</span>: pa.string()</span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取部分列</span></span><br><span class="line">table = csv.read_csv(<span class="string">&#x27;data.csv&#x27;</span>,</span><br><span class="line">    usecols=[<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入 CSV</span></span><br><span class="line">csv.write_csv(table, <span class="string">&#x27;output.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 流式读取大 CSV（内存友好）</span></span><br><span class="line">reader = csv.open_csv(<span class="string">&#x27;large_file.csv&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> batch <span class="keyword">in</span> reader:</span><br><span class="line">    <span class="comment"># batch 是 RecordBatch，逐个处理</span></span><br><span class="line">    process(batch)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - PyArrow 读取 CSV 比 Pandas 快 5-10 倍</span></span><br><span class="line"><span class="comment"># - 流式读取适合处理超大文件</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-Feather-格式"><a href="#3-3-Feather-格式" class="headerlink" title="3.3 Feather 格式"></a>3.3 Feather 格式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Feather 是超快的中间存储格式</span></span><br><span class="line"><span class="keyword">import</span> pyarrow.feather <span class="keyword">as</span> feather</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入</span></span><br><span class="line">feather.write_feather(table, <span class="string">&#x27;data.feather&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取</span></span><br><span class="line">table = feather.read_table(<span class="string">&#x27;data.feather&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 与 Pandas 互转</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]&#125;)</span><br><span class="line">df.to_feather(<span class="string">&#x27;data.feather&#x27;</span>)</span><br><span class="line">df = pd.read_feather(<span class="string">&#x27;data.feather&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - Feather 比 Parquet 更快，但压缩率较低</span></span><br><span class="line"><span class="comment"># - 适合临时存储和进程间数据传输</span></span><br></pre></td></tr></table></figure>

<h3 id="3-4-IPC-格式（进程间通信）"><a href="#3-4-IPC-格式（进程间通信）" class="headerlink" title="3.4 IPC 格式（进程间通信）"></a>3.4 IPC 格式（进程间通信）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 写入</span></span><br><span class="line"><span class="keyword">with</span> pa.ipc.new_file(<span class="string">&#x27;data.arrow&#x27;</span>, table.schema) <span class="keyword">as</span> writer:</span><br><span class="line">    writer.write_table(table)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取</span></span><br><span class="line"><span class="keyword">with</span> pa.ipc.open_file(<span class="string">&#x27;data.arrow&#x27;</span>) <span class="keyword">as</span> reader:</span><br><span class="line">    table = reader.read_all()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 流式写入（多个 RecordBatch）</span></span><br><span class="line"><span class="keyword">with</span> pa.ipc.new_stream(<span class="string">&#x27;data.arrow&#x27;</span>, table.schema) <span class="keyword">as</span> writer:</span><br><span class="line">    <span class="keyword">for</span> batch <span class="keyword">in</span> table.to_batches():</span><br><span class="line">        writer.write_batch(batch)</span><br></pre></td></tr></table></figure>

<h2 id="四、数据操作"><a href="#四、数据操作" class="headerlink" title="四、数据操作"></a>四、数据操作</h2><h3 id="4-1-列操作"><a href="#4-1-列操作" class="headerlink" title="4.1 列操作"></a>4.1 列操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">table = pa.table(&#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>],</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;v&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择列</span></span><br><span class="line">col = table[<span class="string">&#x27;a&#x27;</span>]</span><br><span class="line">cols = table.select([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加列</span></span><br><span class="line">new_col = pa.array([<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span>, <span class="number">500</span>])</span><br><span class="line">table = table.append_column(<span class="string">&#x27;d&#x27;</span>, new_col)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名列</span></span><br><span class="line">table = table.rename_columns([<span class="string">&#x27;col1&#x27;</span>, <span class="string">&#x27;col2&#x27;</span>, <span class="string">&#x27;col3&#x27;</span>, <span class="string">&#x27;col4&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除列</span></span><br><span class="line">table = table.drop([<span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">table = table.remove_column(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 替换列</span></span><br><span class="line">table = table.set_column(<span class="number">0</span>, <span class="string">&#x27;a&#x27;</span>, pa.array([<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<h3 id="4-2-行操作"><a href="#4-2-行操作" class="headerlink" title="4.2 行操作"></a>4.2 行操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切片</span></span><br><span class="line">subset = table.<span class="built_in">slice</span>(<span class="number">0</span>, <span class="number">3</span>)  <span class="comment"># 前三行</span></span><br><span class="line">subset = table.<span class="built_in">slice</span>(-<span class="number">2</span>)    <span class="comment"># 最后两行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤（使用表达式）</span></span><br><span class="line"><span class="keyword">import</span> pyarrow.compute <span class="keyword">as</span> pc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 条件过滤</span></span><br><span class="line">mask = pc.greater(table[<span class="string">&#x27;a&#x27;</span>], <span class="number">2</span>)  <span class="comment"># a &gt; 2</span></span><br><span class="line">filtered = table.<span class="built_in">filter</span>(mask)</span><br><span class="line"></span><br><span class="line">mask = pc.equal(table[<span class="string">&#x27;c&#x27;</span>], <span class="string">&#x27;x&#x27;</span>)  <span class="comment"># c == &#x27;x&#x27;</span></span><br><span class="line">filtered = table.<span class="built_in">filter</span>(mask)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多条件</span></span><br><span class="line">mask1 = pc.greater(table[<span class="string">&#x27;a&#x27;</span>], <span class="number">2</span>)</span><br><span class="line">mask2 = pc.less(table[<span class="string">&#x27;b&#x27;</span>], <span class="number">40</span>)</span><br><span class="line">combined = pc.and_(mask1, mask2)</span><br><span class="line">filtered = table.<span class="built_in">filter</span>(combined)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line">sorted_table = table.sort_by(<span class="string">&#x27;a&#x27;</span>)           <span class="comment"># 升序</span></span><br><span class="line">sorted_table = table.sort_by([(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;descending&#x27;</span>)])  <span class="comment"># 降序</span></span><br><span class="line">sorted_table = table.sort_by([(<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;ascending&#x27;</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;descending&#x27;</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去重</span></span><br><span class="line">unique_table = table.drop_duplicates()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - pc 是 pyarrow.compute 的缩写</span></span><br><span class="line"><span class="comment"># - 过滤操作返回新表，不修改原表</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-计算函数（compute）"><a href="#4-3-计算函数（compute）" class="headerlink" title="4.3 计算函数（compute）"></a>4.3 计算函数（compute）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyarrow.compute <span class="keyword">as</span> pc</span><br><span class="line"></span><br><span class="line">arr = pa.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算术运算</span></span><br><span class="line"><span class="built_in">print</span>(pc.add(arr, <span class="number">10</span>))        <span class="comment"># [11, 12, 13, 14, 15]</span></span><br><span class="line"><span class="built_in">print</span>(pc.subtract(arr, <span class="number">1</span>))    <span class="comment"># [2, 3, 4, 5, 6]</span></span><br><span class="line"><span class="built_in">print</span>(pc.multiply(arr, <span class="number">2</span>))    <span class="comment"># [2, 4, 6, 8, 10]</span></span><br><span class="line"><span class="built_in">print</span>(pc.divide(arr, <span class="number">2</span>))      <span class="comment"># [0.5, 1.0, 1.5, 2.0, 2.5]</span></span><br><span class="line"><span class="built_in">print</span>.pc.power(arr, <span class="number">2</span>))       <span class="comment"># [1, 4, 9, 16, 25]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 比较运算</span></span><br><span class="line"><span class="built_in">print</span>(pc.greater(arr, <span class="number">3</span>))     <span class="comment"># [False, False, False, True, True]</span></span><br><span class="line"><span class="built_in">print</span>(pc.less(arr, <span class="number">3</span>))        <span class="comment"># [True, True, False, False, False]</span></span><br><span class="line"><span class="built_in">print</span>(pc.equal(arr, <span class="number">3</span>))       <span class="comment"># [False, False, True, False, False]</span></span><br><span class="line"><span class="built_in">print</span>(pc.greater_equal(arr, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 聚合函数</span></span><br><span class="line"><span class="built_in">print</span>(pc.<span class="built_in">sum</span>(arr))            <span class="comment"># 15</span></span><br><span class="line"><span class="built_in">print</span>(pc.mean(arr))           <span class="comment"># 3.0</span></span><br><span class="line"><span class="built_in">print</span>(pc.<span class="built_in">min</span>(arr))            <span class="comment"># 1</span></span><br><span class="line"><span class="built_in">print</span>(pc.<span class="built_in">max</span>(arr))            <span class="comment"># 5</span></span><br><span class="line"><span class="built_in">print</span>(pc.count(arr))          <span class="comment"># 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串函数</span></span><br><span class="line">str_arr = pa.array([<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;WORLD&#x27;</span>, <span class="string">&#x27;PyArrow&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(pc.ascii_upper(str_arr))    <span class="comment"># [&#x27;HELLO&#x27;, &#x27;WORLD&#x27;, &#x27;PYARROW&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(pc.ascii_lower(str_arr))    <span class="comment"># [&#x27;hello&#x27;, &#x27;world&#x27;, &#x27;pyarrow&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(pc.utf8_length(str_arr))    <span class="comment"># [5, 5, 8]</span></span><br><span class="line"><span class="built_in">print</span>(pc.utf8_slice_codeunits(str_arr, <span class="number">0</span>, <span class="number">3</span>))  <span class="comment"># [&#x27;hel&#x27;, &#x27;WOR&#x27;, &#x27;PyA&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - compute 模块提供大量向量化函数</span></span><br><span class="line"><span class="comment"># - 性能优于 Python 循环</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-连接和合并"><a href="#4-4-连接和合并" class="headerlink" title="4.4 连接和合并"></a>4.4 连接和合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">table1 = pa.table(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&#x27;b&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]&#125;)</span><br><span class="line">table2 = pa.table(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], <span class="string">&#x27;b&#x27;</span>: [<span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;u&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 垂直连接（concat）</span></span><br><span class="line">combined = pa.concat_tables([table1, table2])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接多个表</span></span><br><span class="line">tables = [table1, table2, table3]</span><br><span class="line">combined = pa.concat_tables(tables)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Join（类似 SQL）</span></span><br><span class="line"><span class="comment"># PyArrow 本身不直接支持 join，需要转 Pandas 或用其他方式</span></span><br><span class="line">df1 = table1.to_pandas()</span><br><span class="line">df2 = table2.to_pandas()</span><br><span class="line">merged = df1.merge(df2, on=<span class="string">&#x27;key&#x27;</span>, how=<span class="string">&#x27;left&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="五、与-Pandas-集成"><a href="#五、与-Pandas-集成" class="headerlink" title="五、与 Pandas 集成"></a>五、与 Pandas 集成</h2><h3 id="5-1-数据转换"><a href="#5-1-数据转换" class="headerlink" title="5.1 数据转换"></a>5.1 数据转换</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PyArrow -&gt; Pandas</span></span><br><span class="line">table = pa.table(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&#x27;b&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]&#125;)</span><br><span class="line">df = table.to_pandas()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pandas -&gt; PyArrow</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&#x27;b&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]&#125;)</span><br><span class="line">table = pa.Table.from_pandas(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 零拷贝选项</span></span><br><span class="line">table = pa.Table.from_pandas(df, preserve_index=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h3 id="5-2-使用-PyArrow-作为-Pandas-后端"><a href="#5-2-使用-PyArrow-作为-Pandas-后端" class="headerlink" title="5.2 使用 PyArrow 作为 Pandas 后端"></a>5.2 使用 PyArrow 作为 Pandas 后端</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Pandas 可以使用 PyArrow 作为后端</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 CSV 时使用 PyArrow 引擎</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data.csv&#x27;</span>, engine=<span class="string">&#x27;pyarrow&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 Parquet 时使用 PyArrow</span></span><br><span class="line">df = pd.read_parquet(<span class="string">&#x27;data.parquet&#x27;</span>, engine=<span class="string">&#x27;pyarrow&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PyArrow 数据类型</span></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: pd.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], dtype=<span class="string">&#x27;int32[pyarrow]&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: pd.array([<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>], dtype=<span class="string">&#x27;string[pyarrow]&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - PyArrow 引擎通常比默认引擎快</span></span><br><span class="line"><span class="comment"># - PyArrow 数据类型可以节省内存</span></span><br></pre></td></tr></table></figure>

<h3 id="5-3-性能对比"><a href="#5-3-性能对比" class="headerlink" title="5.3 性能对比"></a>5.3 性能对比</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> pyarrow <span class="keyword">as</span> pa</span><br><span class="line"><span class="keyword">import</span> pyarrow.parquet <span class="keyword">as</span> pq</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成大数据</span></span><br><span class="line">n = <span class="number">1000000</span></span><br><span class="line">df_pandas = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="built_in">range</span>(n),</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: np.random.randn(n),</span><br><span class="line">    <span class="string">&#x27;category&#x27;</span>: np.random.choice([<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>], n)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pandas 读写 CSV</span></span><br><span class="line">start = time.time()</span><br><span class="line">df_pandas.to_csv(<span class="string">&#x27;pandas.csv&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line">df_read = pd.read_csv(<span class="string">&#x27;pandas.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Pandas CSV: <span class="subst">&#123;time.time() - start:<span class="number">.2</span>f&#125;</span>s&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># PyArrow 读写 CSV</span></span><br><span class="line">start = time.time()</span><br><span class="line">table = pa.Table.from_pandas(df_pandas)</span><br><span class="line">pa.csv.write_csv(table, <span class="string">&#x27;arrow.csv&#x27;</span>)</span><br><span class="line">table_read = pa.csv.read_csv(<span class="string">&#x27;arrow.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;PyArrow CSV: <span class="subst">&#123;time.time() - start:<span class="number">.2</span>f&#125;</span>s&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Parquet 格式</span></span><br><span class="line">start = time.time()</span><br><span class="line">pq.write_table(table, <span class="string">&#x27;data.parquet&#x27;</span>)</span><br><span class="line">table_read = pq.read_table(<span class="string">&#x27;data.parquet&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Parquet: <span class="subst">&#123;time.time() - start:<span class="number">.2</span>f&#125;</span>s&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：实际测试中 PyArrow 通常快 3-10 倍</span></span><br></pre></td></tr></table></figure>

<h2 id="六、高级特性"><a href="#六、高级特性" class="headerlink" title="六、高级特性"></a>六、高级特性</h2><h3 id="6-1-Dataset-API（大数据集）"><a href="#6-1-Dataset-API（大数据集）" class="headerlink" title="6.1 Dataset API（大数据集）"></a>6.1 Dataset API（大数据集）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pyarrow.dataset <span class="keyword">import</span> dataset, write_dataset</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取多个文件</span></span><br><span class="line">ds = dataset(<span class="string">&#x27;data/&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;parquet&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤读取</span></span><br><span class="line">ds = dataset(<span class="string">&#x27;data/&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;parquet&#x27;</span>)</span><br><span class="line">table = ds.to_table(<span class="built_in">filter</span>=pc.greater(pa.field(<span class="string">&#x27;value&#x27;</span>), <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分区数据集</span></span><br><span class="line"><span class="comment"># 自动识别 year=/month= 分区结构</span></span><br><span class="line">ds = dataset(<span class="string">&#x27;data/&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;parquet&#x27;</span>, partitioning=<span class="string">&#x27;hive&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入分区数据集</span></span><br><span class="line">table = pa.table(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&#x27;b&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]&#125;)</span><br><span class="line">write_dataset(</span><br><span class="line">    table,</span><br><span class="line">    <span class="string">&#x27;output/&#x27;</span>,</span><br><span class="line">    <span class="built_in">format</span>=<span class="string">&#x27;parquet&#x27;</span>,</span><br><span class="line">    partitioning=[<span class="string">&#x27;b&#x27;</span>]  <span class="comment"># 按 b 列分区</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># 输出：output/b=x/part-0.parquet, output/b=y/part-0.parquet</span></span><br></pre></td></tr></table></figure>

<h3 id="6-2-内存映射（Memory-Map）"><a href="#6-2-内存映射（Memory-Map）" class="headerlink" title="6.2 内存映射（Memory Map）"></a>6.2 内存映射（Memory Map）</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内存映射读取大文件（不全部加载到内存）</span></span><br><span class="line">mmap = pa.memory_map(<span class="string">&#x27;large_file.parquet&#x27;</span>)</span><br><span class="line">table = pa.ipc.open_file(mmap).read_all()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：内存映射适合处理超大文件，按需加载数据</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-批处理"><a href="#6-3-批处理" class="headerlink" title="6.3 批处理"></a>6.3 批处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 处理大文件时分批处理</span></span><br><span class="line">parquet_file = pq.ParquetFile(<span class="string">&#x27;large.parquet&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> batch <span class="keyword">in</span> parquet_file.iter_batches(batch_size=<span class="number">10000</span>):</span><br><span class="line">    <span class="comment"># 每次处理 10000 行</span></span><br><span class="line">    process(batch)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 批处理聚合</span></span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> batch <span class="keyword">in</span> parquet_file.iter_batches():</span><br><span class="line">    total += pc.<span class="built_in">sum</span>(batch[<span class="string">&#x27;value&#x27;</span>]).as_py()</span><br></pre></td></tr></table></figure>

<h2 id="七、实用示例"><a href="#七、实用示例" class="headerlink" title="七、实用示例"></a>七、实用示例</h2><h3 id="7-1-数据管道"><a href="#7-1-数据管道" class="headerlink" title="7.1 数据管道"></a>7.1 数据管道</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyarrow <span class="keyword">as</span> pa</span><br><span class="line"><span class="keyword">import</span> pyarrow.parquet <span class="keyword">as</span> pq</span><br><span class="line"><span class="keyword">import</span> pyarrow.compute <span class="keyword">as</span> pc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_data</span>(<span class="params">input_file, output_file</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;数据处理管道&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 读取</span></span><br><span class="line">    table = pq.read_table(input_file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 过滤</span></span><br><span class="line">    mask = pc.greater(table[<span class="string">&#x27;value&#x27;</span>], <span class="number">0</span>)</span><br><span class="line">    table = table.<span class="built_in">filter</span>(mask)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 添加计算列</span></span><br><span class="line">    doubled = pc.multiply(table[<span class="string">&#x27;value&#x27;</span>], <span class="number">2</span>)</span><br><span class="line">    table = table.append_column(<span class="string">&#x27;doubled&#x27;</span>, doubled)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 排序</span></span><br><span class="line">    table = table.sort_by(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入</span></span><br><span class="line">    pq.write_table(table, output_file, compression=<span class="string">&#x27;snappy&#x27;</span>)</span><br><span class="line"></span><br><span class="line">process_data(<span class="string">&#x27;input.parquet&#x27;</span>, <span class="string">&#x27;output.parquet&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="7-2-多文件合并"><a href="#7-2-多文件合并" class="headerlink" title="7.2 多文件合并"></a>7.2 多文件合并</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">import</span> pyarrow <span class="keyword">as</span> pa</span><br><span class="line"><span class="keyword">import</span> pyarrow.parquet <span class="keyword">as</span> pq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge_parquet_files</span>(<span class="params">input_dir, output_file</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;合并多个 Parquet 文件&quot;&quot;&quot;</span></span><br><span class="line">    files = <span class="built_in">list</span>(Path(input_dir).glob(<span class="string">&#x27;*.parquet&#x27;</span>))</span><br><span class="line">    tables = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> files:</span><br><span class="line">        table = pq.read_table(<span class="built_in">str</span>(f))</span><br><span class="line">        tables.append(table)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 合并</span></span><br><span class="line">    combined = pa.concat_tables(tables)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入</span></span><br><span class="line">    pq.write_table(combined, output_file)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;合并 <span class="subst">&#123;<span class="built_in">len</span>(files)&#125;</span> 个文件，共 <span class="subst">&#123;combined.num_rows&#125;</span> 行&quot;</span>)</span><br><span class="line"></span><br><span class="line">merge_parquet_files(<span class="string">&#x27;data/&#x27;</span>, <span class="string">&#x27;merged.parquet&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="7-3-数据验证"><a href="#7-3-数据验证" class="headerlink" title="7.3 数据验证"></a>7.3 数据验证</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">validate_data</span>(<span class="params">table, schema</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;验证数据是否符合预期&quot;&quot;&quot;</span></span><br><span class="line">    issues = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查列</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> schema.names:</span><br><span class="line">        <span class="keyword">if</span> col <span class="keyword">not</span> <span class="keyword">in</span> table.column_names:</span><br><span class="line">            issues.append(<span class="string">f&quot;缺少列：<span class="subst">&#123;col&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查空值</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> table.column_names:</span><br><span class="line">        null_count = table[col].null_count</span><br><span class="line">        <span class="keyword">if</span> null_count &gt; <span class="number">0</span>:</span><br><span class="line">            issues.append(<span class="string">f&quot;列 <span class="subst">&#123;col&#125;</span> 有 <span class="subst">&#123;null_count&#125;</span> 个空值&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查数据类型</span></span><br><span class="line">    <span class="keyword">for</span> i, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(table.column_names):</span><br><span class="line">        expected_type = schema.field(i).<span class="built_in">type</span></span><br><span class="line">        actual_type = table.schema.field(i).<span class="built_in">type</span></span><br><span class="line">        <span class="keyword">if</span> expected_type != actual_type:</span><br><span class="line">            issues.append(<span class="string">f&quot;列 <span class="subst">&#123;col&#125;</span> 类型不匹配&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> issues</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">schema = pa.schema([</span><br><span class="line">    (<span class="string">&#x27;id&#x27;</span>, pa.int32()),</span><br><span class="line">    (<span class="string">&#x27;value&#x27;</span>, pa.float64()),</span><br><span class="line">    (<span class="string">&#x27;category&#x27;</span>, pa.string())</span><br><span class="line">])</span><br><span class="line">issues = validate_data(table, schema)</span><br><span class="line"><span class="keyword">if</span> issues:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;数据质量问题：&quot;</span>, issues)</span><br></pre></td></tr></table></figure>

<h2 id="八、最佳实践"><a href="#八、最佳实践" class="headerlink" title="八、最佳实践"></a>八、最佳实践</h2><blockquote>
<p><strong>提醒自己</strong>：</p>
<ol>
<li><strong>使用 Parquet 格式</strong>：比 CSV 更快、更节省空间</li>
<li><strong>列式处理</strong>：只读取需要的列</li>
<li><strong>适当压缩</strong>：Snappy 平衡速度和大小，Gzip 追求压缩率</li>
<li><strong>批量处理</strong>：大文件分批次处理，避免内存溢出</li>
<li><strong>利用分区</strong>：按时间&#x2F;类别分区，加速查询</li>
<li><strong>零拷贝转换</strong>：PyArrow 与 Pandas 互转时避免不必要的数据复制</li>
</ol>
</blockquote>
<h2 id="九、练习"><a href="#九、练习" class="headerlink" title="九、练习"></a>九、练习</h2><ol>
<li>将一个大 CSV 文件转换为 Parquet 格式，比较文件大小和读写速度</li>
<li>使用 PyArrow 读取多个 Parquet 文件并合并</li>
<li>实现一个数据过滤管道，筛选符合条件的数据</li>
<li>使用 compute 模块实现数据的聚合统计</li>
<li>创建分区数据集，并演示分区查询的优势</li>
</ol>
<hr>
<p><strong>上一篇</strong>：[Python 数据科学（二）：Pandas 数据处理](&#x2F;2026&#x2F;02&#x2F;24&#x2F;Python-数据科学（二）Pandas 数据处理&#x2F;)</p>
<p><strong>下一篇</strong>：<a href="/2026/02/24/Python-%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89requests-API-%E8%B0%83%E7%94%A8/">Python 常用库（一）：requests API 调用</a></p>
<p><strong>参考资源</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://arrow.apache.org/docs/python/">PyArrow 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://parquet.apache.org/docs/">Parquet 格式规范</a></li>
<li><a target="_blank" rel="noopener" href="https://arrow.apache.org/docs/python/benchmarks.html">PyArrow 性能基准</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/">https://brian-lin-c.github.io/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/PyArrow/">PyArrow</a><a class="post-meta__tags" href="/tags/%E9%AB%98%E6%80%A7%E8%83%BD/">高性能</a><a class="post-meta__tags" href="/tags/DataFrame/">DataFrame</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89requests%20API%20%E8%B0%83%E7%94%A8/" title="Python 常用库（一）requests API 调用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Python 常用库（一）requests API 调用</div></div><div class="info-2"><div class="info-item-1">Python 常用库（一）requests API 调用requests 是 Python 最流行的 HTTP 客户端库。本篇将介绍如何使用 requests 进行 API 调用、处理响应、文件上传等实用技能。 一、requests 简介1.1 为什么使用 requests？ 简洁 API：人性化设计，代码简单易读 功能强大：支持各种 HTTP 方法、认证、会话等 生态完善：文档丰富，社区活跃 自动处理：自动处理 URL 编码、Cookie、Session 等  1.2 安装与导入1pip install requests  1234import requests# 查看版本print(requests.__version__)  二、基础请求2.1 GET 请求12345678910111213141516171819202122232425262728import requests# 最简单的 GET 请求response = requests.get(&#x27;https://api.example.com/data&#x27;)# 带参数的 GET 请求params =...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" title="Python 数据科学（二）Pandas 数据处理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Python 数据科学（二）Pandas 数据处理</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（二）Pandas 数据处理Pandas 是 Python 数据分析的核心库。本篇将详细介绍 DataFrame 操作、数据清洗、数据转换等核心技能。 一、Pandas 简介1.1 为什么使用 Pandas？ 数据处理强大：支持 CSV、Excel、SQL、JSON 等多种格式 DataFrame 结构：类似 Excel 表格，直观易用 数据清洗方便：处理缺失值、重复值、异常值 数据分析功能：分组、聚合、透视表 与 NumPy 兼容：底层使用 NumPy，性能优秀  1.2 安装与导入1pip install pandas  123456789import pandas as pdimport numpy as np# 查看版本print(pd.__version__)# 设置显示选项pd.set_option(&#x27;display.max_columns&#x27;, None)  # 显示所有列pd.set_option(&#x27;display.width&#x27;, None)        # 自适应宽度  二、Series 和 Data...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%BA%8C%EF%BC%89Pandas%20%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" title="Python 数据科学（二）Pandas 数据处理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 数据科学（二）Pandas 数据处理</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（二）Pandas 数据处理Pandas 是 Python 数据分析的核心库。本篇将详细介绍 DataFrame 操作、数据清洗、数据转换等核心技能。 一、Pandas 简介1.1 为什么使用 Pandas？ 数据处理强大：支持 CSV、Excel、SQL、JSON 等多种格式 DataFrame 结构：类似 Excel 表格，直观易用 数据清洗方便：处理缺失值、重复值、异常值 数据分析功能：分组、聚合、透视表 与 NumPy 兼容：底层使用 NumPy，性能优秀  1.2 安装与导入1pip install pandas  123456789import pandas as pdimport numpy as np# 查看版本print(pd.__version__)# 设置显示选项pd.set_option(&#x27;display.max_columns&#x27;, None)  # 显示所有列pd.set_option(&#x27;display.width&#x27;, None)        # 自适应宽度  二、Series 和 Data...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%80%EF%BC%89NumPy%20%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" title="Python 数据科学（一）NumPy 数值计算"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 数据科学（一）NumPy 数值计算</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（一）NumPy 数值计算NumPy 是 Python 数据科学的基石。本篇将介绍 NumPy 的核心功能，包括 ndarray 数组、向量化计算、广播机制等。 一、NumPy 简介1.1 为什么使用 NumPy？ 性能优势：底层用 C 实现，比纯 Python 快 10-100 倍 内存效率：连续存储，占用更少内存 向量化操作：无需循环，代码更简洁 生态基础：Pandas、SciPy、scikit-learn 等都基于 NumPy  1.2 安装与导入1pip install numpy  1234import numpy as np# 查看版本print(np.__version__)  二、ndarray 数组2.1 创建数组123456789101112131415161718192021222324252627282930313233import numpy as np# 从列表创建arr1 = np.array([1, 2, 3, 4, 5])arr2 = np.array([[1, 2, 3], [4, 5, 6]])  # 二维数组# 特殊数...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%85%A5%E9%97%A8/" title="Python 基础教程（一）基础语法入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（一）基础语法入门</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（一）基础语法入门欢迎来到 Python 基础教程系列！本篇将从零开始介绍 Python 的基础语法，帮助你快速上手 Python 编程。 一、Python 简介1.1 为什么选择 Python？ 语法简洁：代码可读性强，接近自然语言 生态丰富：拥有庞大的第三方库生态系统 应用广泛：Web 开发、数据分析、人工智能、自动化脚本等 跨平台：Windows、Linux、macOS 均可运行 社区活跃：遇到问题容易找到解决方案  1.2 Python 版本选择 提醒自己：务必使用 Python 3.x（推荐 3.8+），Python 2 已停止维护。  二、环境搭建2.1 安装 PythonWindows：  访问 https://www.python.org/downloads/ 下载最新稳定版（如 3.11.x） 安装时勾选 “Add Python to PATH”  验证安装： 123python --version# 或python3 --version  2.2 包管理工具 pip1234567891011121314151617181920212223...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 常用库（三）logging 日志模块</div></div><div class="info-2"><div class="info-item-1">Python 常用库（三）logging 日志模块日志是程序调试、监控和问题排查的重要工具。本篇将详细介绍 Python 内置的 logging 模块。 一、logging 简介1.1 为什么使用 logging？ 标准库：无需安装，开箱即用 灵活配置：可配置输出格式、级别、目标等 高性能：内置优化，适合生产环境 可扩展：支持自定义 Handler、Formatter、Filter  1.2 日志级别   级别 数值 说明 使用场景    DEBUG 10 调试信息 开发调试时的详细信息   INFO 20 一般信息 程序正常运行的信息   WARNING 30 警告信息 不影响运行但需要注意   ERROR 40 错误信息 程序错误但不影响继续运行   CRITICAL 50 严重错误 严重错误，程序可能无法继续   1234567import logginglogging.debug(&quot;调试信息&quot;)logging.info(&quot;一般信息&quot;)logging.warning(&quot;警告信息&quot;)logging.error(&qu...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" title="Python 基础教程（二）面向对象编程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（二）面向对象编程</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（二）面向对象编程面向对象编程（OOP）是 Python 的核心编程范式之一。本篇将详细介绍 Python 中的类与对象、继承、多态等核心概念。 一、面向对象基础1.1 什么是面向对象？面向对象编程（Object-Oriented Programming, OOP） 是一种编程范式，它将数据和处理数据的方法封装在一起，形成”对象”。 核心概念：  类（Class）：对象的模板&#x2F;蓝图，定义对象的属性和方法 对象（Object）：类的实例，具体的实体 属性（Attribute）：对象的特征&#x2F;数据 方法（Method）：对象的行为&#x2F;操作  比喻理解：  类 &#x3D; 房屋设计图 对象 &#x3D; 根据设计图建造的具体房屋  1.2 为什么使用面向对象？ 提醒自己：  代码复用：继承机制减少重复代码 易于维护：封装使代码结构清晰 模块化：不同对象独立工作，降低耦合 模拟现实：更符合人类思维方式   二、类的定义与使用2.1 定义类123456789101112131415161718192021222324252627282930...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89requests%20API%20%E8%B0%83%E7%94%A8/" title="Python 常用库（一）requests API 调用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 常用库（一）requests API 调用</div></div><div class="info-2"><div class="info-item-1">Python 常用库（一）requests API 调用requests 是 Python 最流行的 HTTP 客户端库。本篇将介绍如何使用 requests 进行 API 调用、处理响应、文件上传等实用技能。 一、requests 简介1.1 为什么使用 requests？ 简洁 API：人性化设计，代码简单易读 功能强大：支持各种 HTTP 方法、认证、会话等 生态完善：文档丰富，社区活跃 自动处理：自动处理 URL 编码、Cookie、Session 等  1.2 安装与导入1pip install requests  1234import requests# 查看版本print(requests.__version__)  二、基础请求2.1 GET 请求12345678910111213141516171819202122232425262728import requests# 最简单的 GET 请求response = requests.get(&#x27;https://api.example.com/data&#x27;)# 带参数的 GET 请求params =...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Python-%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow-%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">Python 数据科学（三）PyArrow 高性能数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81PyArrow-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">一、PyArrow 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-PyArrow%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 为什么使用 PyArrow？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%AF%BC%E5%85%A5"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 安装与导入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81PyArrow-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">二、PyArrow 数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Table%EF%BC%88%E8%A1%A8%E6%A0%BC%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 Table（表格）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Array-%E5%92%8C-ChunkedArray"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 Array 和 ChunkedArray</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%95%B0%E6%8D%AE-I-O"><span class="toc-number">1.3.</span> <span class="toc-text">三、数据 I&#x2F;O</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Parquet-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 Parquet 文件读写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-CSV-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 CSV 文件读写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Feather-%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 Feather 格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-IPC-%E6%A0%BC%E5%BC%8F%EF%BC%88%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%EF%BC%89"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 IPC 格式（进程间通信）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">四、数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%88%97%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 列操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%A1%8C%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 行操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E8%AE%A1%E7%AE%97%E5%87%BD%E6%95%B0%EF%BC%88compute%EF%BC%89"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 计算函数（compute）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E8%BF%9E%E6%8E%A5%E5%92%8C%E5%90%88%E5%B9%B6"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 连接和合并</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%B8%8E-Pandas-%E9%9B%86%E6%88%90"><span class="toc-number">1.5.</span> <span class="toc-text">五、与 Pandas 集成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 数据转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BD%BF%E7%94%A8-PyArrow-%E4%BD%9C%E4%B8%BA-Pandas-%E5%90%8E%E7%AB%AF"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 使用 PyArrow 作为 Pandas 后端</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 性能对比</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="toc-number">1.6.</span> <span class="toc-text">六、高级特性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Dataset-API%EF%BC%88%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%9B%86%EF%BC%89"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 Dataset API（大数据集）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%EF%BC%88Memory-Map%EF%BC%89"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 内存映射（Memory Map）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E6%89%B9%E5%A4%84%E7%90%86"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 批处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%AE%9E%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.7.</span> <span class="toc-text">七、实用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%95%B0%E6%8D%AE%E7%AE%A1%E9%81%93"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 数据管道</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E5%A4%9A%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 多文件合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 数据验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.8.</span> <span class="toc-text">八、最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E7%BB%83%E4%B9%A0"><span class="toc-number">1.9.</span> <span class="toc-text">九、练习</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%B8%80%EF%BC%89Linux%20%E5%9F%BA%E7%A1%80%E4%B8%8E%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="Linux 与 Shell（一）Linux 基础与常用命令">Linux 与 Shell（一）Linux 基础与常用命令</a><time datetime="2026-02-24T12:00:00.000Z" title="发表于 2026-02-24 20:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块">Python 常用库（三）logging 日志模块</a><time datetime="2026-02-24T11:00:00.000Z" title="发表于 2026-02-24 19:00:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>