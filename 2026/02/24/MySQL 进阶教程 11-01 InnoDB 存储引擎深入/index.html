<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL 进阶教程 11-01 InnoDB 存储引擎深入 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL 进阶教程 11-01 InnoDB 存储引擎深入InnoDB 是 MySQL 的默认存储引擎，也是使用最广泛的引擎。本文将深入探讨 InnoDB 的内部架构、存储结构、事务原理和 MVCC 机制。 一、InnoDB 逻辑存储结构1.1 存储结构层次123456InnoDB 存储结构├── 表空间（Tablespace）│   ├── 段（Segment）│   │   ├── 区（Ex">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 进阶教程 11-01 InnoDB 存储引擎深入">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2011-01%20InnoDB%20%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B7%B1%E5%85%A5/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="MySQL 进阶教程 11-01 InnoDB 存储引擎深入InnoDB 是 MySQL 的默认存储引擎，也是使用最广泛的引擎。本文将深入探讨 InnoDB 的内部架构、存储结构、事务原理和 MVCC 机制。 一、InnoDB 逻辑存储结构1.1 存储结构层次123456InnoDB 存储结构├── 表空间（Tablespace）│   ├── 段（Segment）│   │   ├── 区（Ex">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T06:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T10:42:21.821Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="InnoDB">
<meta property="article:tag" content="MVCC">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="事务">
<meta property="article:tag" content="存储引擎">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL 进阶教程 11-01 InnoDB 存储引擎深入",
  "url": "https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2011-01%20InnoDB%20%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B7%B1%E5%85%A5/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T06:00:00.000Z",
  "dateModified": "2026-02-24T10:42:21.821Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2011-01%20InnoDB%20%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B7%B1%E5%85%A5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 进阶教程 11-01 InnoDB 存储引擎深入',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL 进阶教程 11-01 InnoDB 存储引擎深入</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 进阶教程 11-01 InnoDB 存储引擎深入</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T06:00:00.000Z" title="发表于 2026-02-24 14:00:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T10:42:21.821Z" title="更新于 2026-02-24 18:42:21">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL-%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B/">MySQL 进阶教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>8分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MySQL-进阶教程-11-01-InnoDB-存储引擎深入"><a href="#MySQL-进阶教程-11-01-InnoDB-存储引擎深入" class="headerlink" title="MySQL 进阶教程 11-01 InnoDB 存储引擎深入"></a>MySQL 进阶教程 11-01 InnoDB 存储引擎深入</h1><p>InnoDB 是 MySQL 的默认存储引擎，也是使用最广泛的引擎。本文将深入探讨 InnoDB 的内部架构、存储结构、事务原理和 MVCC 机制。</p>
<h2 id="一、InnoDB-逻辑存储结构"><a href="#一、InnoDB-逻辑存储结构" class="headerlink" title="一、InnoDB 逻辑存储结构"></a>一、InnoDB 逻辑存储结构</h2><h3 id="1-1-存储结构层次"><a href="#1-1-存储结构层次" class="headerlink" title="1.1 存储结构层次"></a>1.1 存储结构层次</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">InnoDB 存储结构</span><br><span class="line">├── 表空间（Tablespace）</span><br><span class="line">│   ├── 段（Segment）</span><br><span class="line">│   │   ├── 区（Extent）</span><br><span class="line">│   │   │   ├── 页（Page）</span><br><span class="line">│   │   │   │   └── 行（Row）</span><br></pre></td></tr></table></figure>

<h3 id="1-2-表空间"><a href="#1-2-表空间" class="headerlink" title="1.2 表空间"></a>1.2 表空间</h3><p><strong>表空间</strong> 是 InnoDB 的最高层存储结构，分为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 系统表空间（shared tablespace）</span></span><br><span class="line"><span class="comment">-- 存储：数据字典、undo log、doublewrite buffer、change buffer 等</span></span><br><span class="line"><span class="comment">-- 文件：ibdata1, ibdata2...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 独立表空间（file-per-table tablespace）</span></span><br><span class="line"><span class="comment">-- 每个表一个 .ibd 文件</span></span><br><span class="line"><span class="comment">-- MySQL 5.6+ 默认开启</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_file_per_table&#x27;</span>;  <span class="comment">-- ON</span></span><br></pre></td></tr></table></figure>

<h3 id="1-3-段"><a href="#1-3-段" class="headerlink" title="1.3 段"></a>1.3 段</h3><p><strong>段（Segment）</strong> 是不同数据类型的存储区域：</p>
<table>
<thead>
<tr>
<th>段类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>数据段</td>
<td>存储表数据（聚簇索引的叶子节点）</td>
</tr>
<tr>
<td>索引段</td>
<td>存储索引数据（非聚簇索引）</td>
</tr>
<tr>
<td>Undo 段</td>
<td>存储 Undo Log</td>
</tr>
<tr>
<td>临时段</td>
<td>排序、临时表等</td>
</tr>
</tbody></table>
<h3 id="1-4-区"><a href="#1-4-区" class="headerlink" title="1.4 区"></a>1.4 区</h3><p><strong>区（Extent）</strong> 是连续的页集合：</p>
<ul>
<li>1 个区 &#x3D; 64 个连续页</li>
<li>默认页大小 16KB，1 个区 &#x3D; 1MB</li>
</ul>
<h3 id="1-5-页"><a href="#1-5-页" class="headerlink" title="1.5 页"></a>1.5 页</h3><p><strong>页（Page）</strong> 是 InnoDB 最小的存储单位：</p>
<table>
<thead>
<tr>
<th>页类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>数据页</td>
<td>存储记录数据</td>
</tr>
<tr>
<td>索引页</td>
<td>存储索引数据</td>
</tr>
<tr>
<td>Undo 页</td>
<td>存储 Undo Log</td>
</tr>
<tr>
<td>系统页</td>
<td>存储系统信息</td>
</tr>
</tbody></table>
<h2 id="二、内存结构"><a href="#二、内存结构" class="headerlink" title="二、内存结构"></a>二、内存结构</h2><h3 id="2-1-InnoDB-内存结构概览"><a href="#2-1-InnoDB-内存结构概览" class="headerlink" title="2.1 InnoDB 内存结构概览"></a>2.1 InnoDB 内存结构概览</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">InnoDB Buffer Pool</span><br><span class="line">├── 数据页缓存</span><br><span class="line">├── 索引页缓存</span><br><span class="line">├── 插入缓冲（Insert Buffer）</span><br><span class="line">├── 自适应哈希索引（AHI）</span><br><span class="line">└── 锁信息</span><br></pre></td></tr></table></figure>

<h3 id="2-2-Buffer-Pool"><a href="#2-2-Buffer-Pool" class="headerlink" title="2.2 Buffer Pool"></a>2.2 Buffer Pool</h3><p><strong>Buffer Pool</strong> 是 InnoDB 最重要的内存区域，用于缓存数据和索引页。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看 Buffer Pool 大小</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_buffer_pool_size&#x27;</span>;</span><br><span class="line"><span class="comment">-- 建议：物理内存的 70-80%</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看 Buffer Pool 使用情况</span></span><br><span class="line"><span class="keyword">SHOW</span> ENGINE INNODB STATUS\G</span><br><span class="line"><span class="comment">-- 或</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> information_schema.innodb_buffer_pool_stats;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-Buffer-Pool-工作原理"><a href="#2-3-Buffer-Pool-工作原理" class="headerlink" title="2.3 Buffer Pool 工作原理"></a>2.3 Buffer Pool 工作原理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">读取数据流程：</span><br><span class="line">1. 检查数据页是否在 Buffer Pool 中</span><br><span class="line">2. 如果在（命中），直接返回</span><br><span class="line">3. 如果不在（未命中），从磁盘加载到 Buffer Pool</span><br><span class="line"></span><br><span class="line">写入数据流程：</span><br><span class="line">1. 修改 Buffer Pool 中的数据页（脏页）</span><br><span class="line">2. 标记为脏页</span><br><span class="line">3. 后台线程异步刷盘到磁盘</span><br></pre></td></tr></table></figure>

<h3 id="2-4-脏页刷新"><a href="#2-4-脏页刷新" class="headerlink" title="2.4 脏页刷新"></a>2.4 脏页刷新</h3><p><strong>脏页（Dirty Page）</strong>：Buffer Pool 中被修改但未刷盘的页。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 脏页刷新触发条件：</span></span><br><span class="line"><span class="comment">-- 1. Redo Log 空间不足</span></span><br><span class="line"><span class="comment">-- 2. Buffer Pool 空间不足（LRU 淘汰）</span></span><br><span class="line"><span class="comment">-- 3. 系统空闲时</span></span><br><span class="line"><span class="comment">-- 4. 正常关闭时</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看脏页比例</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;Innodb_buffer_pool_pages_dirty&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="三、磁盘结构"><a href="#三、磁盘结构" class="headerlink" title="三、磁盘结构"></a>三、磁盘结构</h2><h3 id="3-1-InnoDB-主要文件"><a href="#3-1-InnoDB-主要文件" class="headerlink" title="3.1 InnoDB 主要文件"></a>3.1 InnoDB 主要文件</h3><table>
<thead>
<tr>
<th>文件</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ibdata*</td>
<td>系统表空间文件</td>
</tr>
<tr>
<td>*.ibd</td>
<td>独立表空间文件</td>
</tr>
<tr>
<td>ib_logfile*</td>
<td>Redo Log 文件</td>
</tr>
<tr>
<td>ibtmp*</td>
<td>临时表空间</td>
</tr>
</tbody></table>
<h3 id="3-2-表空间文件结构"><a href="#3-2-表空间文件结构" class="headerlink" title="3.2 表空间文件结构"></a>3.2 表空间文件结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.ibd 文件结构</span><br><span class="line">├── File Header（38 字节）</span><br><span class="line">├── File Foot（38 字节）</span><br><span class="line">└── Pages</span><br><span class="line">    ├── Page 0: Insert Cache</span><br><span class="line">    ├── Page 1: Data Dictionary</span><br><span class="line">    ├── Page 2: Undo Log</span><br><span class="line">    ├── Page 3: Change Log</span><br><span class="line">    └── Page 4+: 用户数据</span><br></pre></td></tr></table></figure>

<h2 id="四、后台线程"><a href="#四、后台线程" class="headerlink" title="四、后台线程"></a>四、后台线程</h2><h3 id="4-1-InnoDB-后台线程"><a href="#4-1-InnoDB-后台线程" class="headerlink" title="4.1 InnoDB 后台线程"></a>4.1 InnoDB 后台线程</h3><table>
<thead>
<tr>
<th>线程</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>Master Thread</td>
<td>刷新 Buffer Pool、Undo 页</td>
</tr>
<tr>
<td>IO Thread</td>
<td>处理 IO 请求</td>
</tr>
<tr>
<td>Purge Thread</td>
<td>清理 Undo Log</td>
</tr>
<tr>
<td>Page Cleaner Thread</td>
<td>刷新脏页</td>
</tr>
</tbody></table>
<h3 id="4-2-Master-Thread"><a href="#4-2-Master-Thread" class="headerlink" title="4.2 Master Thread"></a>4.2 Master Thread</h3><p><strong>Master Thread</strong> 是 InnoDB 最重要的后台线程：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Master Thread 工作周期：</span><br><span class="line">├── 每秒执行</span><br><span class="line">│   ├── 刷新日志缓冲</span><br><span class="line">│   └── 合并插入缓冲</span><br><span class="line">├── 每 10 秒执行</span><br><span class="line">│   ├── 刷新脏页</span><br><span class="line">│   └── 清理 Undo 页</span><br><span class="line">└── 每 300 秒执行</span><br><span class="line">    └── 清理无用数据</span><br></pre></td></tr></table></figure>

<h2 id="五、事务原理概述"><a href="#五、事务原理概述" class="headerlink" title="五、事务原理概述"></a>五、事务原理概述</h2><h3 id="5-1-InnoDB-事务特性"><a href="#5-1-InnoDB-事务特性" class="headerlink" title="5.1 InnoDB 事务特性"></a>5.1 InnoDB 事务特性</h3><p>InnoDB 实现了完整的 ACID 事务特性：</p>
<table>
<thead>
<tr>
<th>特性</th>
<th>实现机制</th>
</tr>
</thead>
<tbody><tr>
<td>原子性</td>
<td>Undo Log</td>
</tr>
<tr>
<td>一致性</td>
<td>锁 + MVCC</td>
</tr>
<tr>
<td>隔离性</td>
<td>锁 + MVCC</td>
</tr>
<tr>
<td>持久性</td>
<td>Redo Log</td>
</tr>
</tbody></table>
<h3 id="5-2-事务日志"><a href="#5-2-事务日志" class="headerlink" title="5.2 事务日志"></a>5.2 事务日志</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">InnoDB 事务日志</span><br><span class="line">├── Redo Log（重做日志）- 保证持久性</span><br><span class="line">└── Undo Log（回滚日志）- 保证原子性</span><br></pre></td></tr></table></figure>

<h2 id="六、Redo-Log"><a href="#六、Redo-Log" class="headerlink" title="六、Redo Log"></a>六、Redo Log</h2><h3 id="6-1-Redo-Log-作用"><a href="#6-1-Redo-Log-作用" class="headerlink" title="6.1 Redo Log 作用"></a>6.1 Redo Log 作用</h3><p><strong>Redo Log（重做日志）</strong> 记录数据页的物理修改，用于：</p>
<ul>
<li>崩溃恢复</li>
<li>保证事务持久性</li>
</ul>
<h3 id="6-2-Redo-Log-结构"><a href="#6-2-Redo-Log-结构" class="headerlink" title="6.2 Redo Log 结构"></a>6.2 Redo Log 结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Redo Log 是循环写入的环形文件：</span><br><span class="line">┌──────────────────────────────────────┐</span><br><span class="line">│ write pos ──────→ checkpoint         │</span><br><span class="line">│   (写入位置)         (回收位置)        │</span><br><span class="line">└──────────────────────────────────────┘</span><br><span class="line"></span><br><span class="line">- write pos 到 checkpoint 之间：空闲空间</span><br><span class="line">- checkpoint 到 write pos 之间：待刷盘数据</span><br></pre></td></tr></table></figure>

<h3 id="6-3-Redo-Log-写入流程"><a href="#6-3-Redo-Log-写入流程" class="headerlink" title="6.3 Redo Log 写入流程"></a>6.3 Redo Log 写入流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 事务修改数据 → 生成 Redo Record</span><br><span class="line">2. Redo Record 写入 Log Buffer</span><br><span class="line">3. Log Buffer 刷新到 Redo Log 文件</span><br><span class="line">4. 数据页标记为脏页</span><br><span class="line">5. 后台线程异步刷盘</span><br></pre></td></tr></table></figure>

<h3 id="6-4-Redo-Log-配置"><a href="#6-4-Redo-Log-配置" class="headerlink" title="6.4 Redo Log 配置"></a>6.4 Redo Log 配置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看 Redo Log 配置</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_log_file_size&#x27;</span>;   <span class="comment">-- 日志文件大小</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_log_buffer_size&#x27;</span>; <span class="comment">-- 日志缓冲大小</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;innodb_flush_log_at_trx_commit&#x27;</span>;</span><br><span class="line"><span class="comment">-- 0: 每秒刷盘</span></span><br><span class="line"><span class="comment">-- 1: 每次事务提交刷盘（默认，最安全）</span></span><br><span class="line"><span class="comment">-- 2: 每次事务写入但不刷盘，每秒刷盘</span></span><br></pre></td></tr></table></figure>

<h2 id="七、Undo-Log"><a href="#七、Undo-Log" class="headerlink" title="七、Undo Log"></a>七、Undo Log</h2><h3 id="7-1-Undo-Log-作用"><a href="#7-1-Undo-Log-作用" class="headerlink" title="7.1 Undo Log 作用"></a>7.1 Undo Log 作用</h3><p><strong>Undo Log（回滚日志）</strong> 记录逻辑操作的逆操作，用于：</p>
<ul>
<li>事务回滚</li>
<li>MVCC 版本控制</li>
<li>崩溃恢复</li>
</ul>
<h3 id="7-2-Undo-Log-示例"><a href="#7-2-Undo-Log-示例" class="headerlink" title="7.2 Undo Log 示例"></a>7.2 Undo Log 示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 原始操作</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, name) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Undo Log 记录</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 原始操作</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Undo Log 记录</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-3-Undo-Log-类型"><a href="#7-3-Undo-Log-类型" class="headerlink" title="7.3 Undo Log 类型"></a>7.3 Undo Log 类型</h3><table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Insert Undo Log</td>
<td>INSERT 操作产生，事务提交后可立即清除</td>
</tr>
<tr>
<td>Update Undo Log</td>
<td>UPDATE&#x2F;DELETE 操作产生，用于 MVCC</td>
</tr>
</tbody></table>
<h2 id="八、MVCC-基本概念"><a href="#八、MVCC-基本概念" class="headerlink" title="八、MVCC 基本概念"></a>八、MVCC 基本概念</h2><h3 id="8-1-什么是-MVCC？"><a href="#8-1-什么是-MVCC？" class="headerlink" title="8.1 什么是 MVCC？"></a>8.1 什么是 MVCC？</h3><p><strong>MVCC（Multi-Version Concurrency Control，多版本并发控制）</strong> 是一种并发控制机制，通过保存数据的历史版本来实现读写不阻塞。</p>
<h3 id="8-2-MVCC-的优势"><a href="#8-2-MVCC-的优势" class="headerlink" title="8.2 MVCC 的优势"></a>8.2 MVCC 的优势</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">传统锁机制：</span><br><span class="line">- 读阻塞写，写阻塞读</span><br><span class="line">- 并发度低</span><br><span class="line"></span><br><span class="line">MVCC：</span><br><span class="line">- 读不阻塞写，写不阻塞读</span><br><span class="line">- 并发度高</span><br></pre></td></tr></table></figure>

<h3 id="8-3-MVCC-实现原理"><a href="#8-3-MVCC-实现原理" class="headerlink" title="8.3 MVCC 实现原理"></a>8.3 MVCC 实现原理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MVCC 通过以下方式实现：</span><br><span class="line">1. 每行数据有多个版本</span><br><span class="line">2. 每个事务看到特定版本的数据</span><br><span class="line">3. 通过 ReadView 决定可见性</span><br></pre></td></tr></table></figure>

<h2 id="九、MVCC-隐藏字段"><a href="#九、MVCC-隐藏字段" class="headerlink" title="九、MVCC 隐藏字段"></a>九、MVCC 隐藏字段</h2><h3 id="9-1-隐藏列"><a href="#9-1-隐藏列" class="headerlink" title="9.1 隐藏列"></a>9.1 隐藏列</h3><p>InnoDB 每行记录有三个隐藏列：</p>
<table>
<thead>
<tr>
<th>隐藏列</th>
<th>大小</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>DB_ROW_ID</td>
<td>6 字节</td>
<td>行 ID（无主键时自动生成）</td>
</tr>
<tr>
<td>DB_TRX_ID</td>
<td>6 字节</td>
<td>最近修改事务 ID</td>
</tr>
<tr>
<td>DB_ROLL_PTR</td>
<td>7 字节</td>
<td>回滚指针（指向 Undo Log）</td>
</tr>
</tbody></table>
<h3 id="9-2-隐藏列查看"><a href="#9-2-隐藏列查看" class="headerlink" title="9.2 隐藏列查看"></a>9.2 隐藏列查看</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看表的实际列（包含隐藏列）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> information_schema.columns</span><br><span class="line"><span class="keyword">WHERE</span> table_schema <span class="operator">=</span> <span class="string">&#x27;your_db&#x27;</span> <span class="keyword">AND</span> table_name <span class="operator">=</span> <span class="string">&#x27;your_table&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 隐藏列不会显示，但实际存在</span></span><br></pre></td></tr></table></figure>

<h2 id="十、MVCC-版本链"><a href="#十、MVCC-版本链" class="headerlink" title="十、MVCC 版本链"></a>十、MVCC 版本链</h2><h3 id="10-1-版本链结构"><a href="#10-1-版本链结构" class="headerlink" title="10.1 版本链结构"></a>10.1 版本链结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">版本链通过 DB_ROLL_PTR 连接：</span><br><span class="line"></span><br><span class="line">当前行 → [版本 3, trx=103] → [版本 2, trx=102] → [版本 1, trx=101] → NULL</span><br><span class="line">           ↓                   ↓                   ↓</span><br><span class="line">       Undo Log            Undo Log            Undo Log</span><br></pre></td></tr></table></figure>

<h3 id="10-2-版本链形成过程"><a href="#10-2-版本链形成过程" class="headerlink" title="10.2 版本链形成过程"></a>10.2 版本链形成过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 初始状态</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> users (id, name) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;张三&#x27;</span>);</span><br><span class="line"><span class="comment">-- 版本 1: name=&#x27;张三&#x27;, trx_id=101</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第一次更新</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> name <span class="operator">=</span> <span class="string">&#x27;李四&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 版本 2: name=&#x27;李四&#x27;, trx_id=102</span></span><br><span class="line"><span class="comment">-- 旧版本通过回滚指针连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 第二次更新</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> name <span class="operator">=</span> <span class="string">&#x27;王五&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="comment">-- 版本 3: name=&#x27;王五&#x27;, trx_id=103</span></span><br><span class="line"><span class="comment">-- 形成版本链</span></span><br></pre></td></tr></table></figure>

<h2 id="十一、MVCC-ReadView"><a href="#十一、MVCC-ReadView" class="headerlink" title="十一、MVCC ReadView"></a>十一、MVCC ReadView</h2><h3 id="11-1-什么是-ReadView？"><a href="#11-1-什么是-ReadView？" class="headerlink" title="11.1 什么是 ReadView？"></a>11.1 什么是 ReadView？</h3><p><strong>ReadView</strong> 是事务启动时生成的快照，包含：</p>
<ul>
<li>当前活跃事务列表</li>
<li>最小活跃事务 ID</li>
<li>最大事务 ID</li>
</ul>
<h3 id="11-2-ReadView-可见性规则"><a href="#11-2-ReadView-可见性规则" class="headerlink" title="11.2 ReadView 可见性规则"></a>11.2 ReadView 可见性规则</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">假设 ReadView 包含：</span><br><span class="line">- m_ids = [100, 102, 105]  ← 活跃事务列表</span><br><span class="line">- min_trx_id = 100         ← 最小活跃事务 ID</span><br><span class="line">- max_trx_id = 106         ← 最大事务 ID</span><br><span class="line"></span><br><span class="line">数据版本 trx_id = X：</span><br><span class="line">1. X &lt; min_trx_id → 可见（事务已提交）</span><br><span class="line">2. X &gt;= max_trx_id → 不可见（事务在 ReadView 之后启动）</span><br><span class="line">3. X in m_ids → 不可见（事务还在运行）</span><br><span class="line">4. min_trx_id &lt;= X &lt; max_trx_id 且 X not in m_ids → 可见（事务已提交）</span><br></pre></td></tr></table></figure>

<h2 id="十二、MVCC-RC-级别原理"><a href="#十二、MVCC-RC-级别原理" class="headerlink" title="十二、MVCC RC 级别原理"></a>十二、MVCC RC 级别原理</h2><h3 id="12-1-RC-级别的-ReadView"><a href="#12-1-RC-级别的-ReadView" class="headerlink" title="12.1 RC 级别的 ReadView"></a>12.1 RC 级别的 ReadView</h3><p><strong>READ COMMITTED（RC）</strong> 级别：每次 SELECT 都生成新的 ReadView。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- RC 级别</span></span><br><span class="line"><span class="comment">-- 事务 A</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 生成 ReadView 1</span></span><br><span class="line"><span class="comment">-- 此时看到数据版本 V1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务 B 提交</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> name <span class="operator">=</span> <span class="string">&#x27;新值&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务 A 再次查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 生成 ReadView 2</span></span><br><span class="line"><span class="comment">-- 此时可以看到事务 B 提交的数据 V2（幻读）</span></span><br></pre></td></tr></table></figure>

<h2 id="十三、MVCC-RR-级别原理"><a href="#十三、MVCC-RR-级别原理" class="headerlink" title="十三、MVCC RR 级别原理"></a>十三、MVCC RR 级别原理</h2><h3 id="13-1-RR-级别的-ReadView"><a href="#13-1-RR-级别的-ReadView" class="headerlink" title="13.1 RR 级别的 ReadView"></a>13.1 RR 级别的 ReadView</h3><p><strong>REPEATABLE READ（RR）</strong> 级别：只在第一次 SELECT 时生成 ReadView。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- RR 级别</span></span><br><span class="line"><span class="comment">-- 事务 A</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 生成 ReadView 1</span></span><br><span class="line"><span class="comment">-- 此时看到数据版本 V1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务 B 提交</span></span><br><span class="line"><span class="keyword">UPDATE</span> users <span class="keyword">SET</span> name <span class="operator">=</span> <span class="string">&#x27;新值&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 事务 A 再次查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;  <span class="comment">-- 复用 ReadView 1</span></span><br><span class="line"><span class="comment">-- 仍然看到 V1（可重复读）</span></span><br></pre></td></tr></table></figure>

<h3 id="13-2-RR-级别解决幻读"><a href="#13-2-RR-级别解决幻读" class="headerlink" title="13.2 RR 级别解决幻读"></a>13.2 RR 级别解决幻读</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RR 级别通过两种方式解决幻读：</span><br><span class="line">1. MVCC - 快照读（普通 SELECT）</span><br><span class="line">2. 临键锁 - 当前读（SELECT FOR UPDATE）</span><br></pre></td></tr></table></figure>

<h2 id="十四、小结"><a href="#十四、小结" class="headerlink" title="十四、小结"></a>十四、小结</h2><h3 id="InnoDB-架构总结"><a href="#InnoDB-架构总结" class="headerlink" title="InnoDB 架构总结"></a>InnoDB 架构总结</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">InnoDB 存储引擎</span><br><span class="line">├── 内存结构</span><br><span class="line">│   └── Buffer Pool（数据缓存）</span><br><span class="line">├── 磁盘结构</span><br><span class="line">│   ├── 表空间</span><br><span class="line">│   └── Redo Log/Undo Log</span><br><span class="line">├── 后台线程</span><br><span class="line">│   ├── Master Thread</span><br><span class="line">│   └── Page Cleaner</span><br><span class="line">└── 事务机制</span><br><span class="line">    ├── Redo Log（持久性）</span><br><span class="line">    ├── Undo Log（原子性）</span><br><span class="line">    └── MVCC（隔离性）</span><br></pre></td></tr></table></figure>

<h3 id="MVCC-核心概念"><a href="#MVCC-核心概念" class="headerlink" title="MVCC 核心概念"></a>MVCC 核心概念</h3><table>
<thead>
<tr>
<th>概念</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>隐藏列</td>
<td>DB_TRX_ID、DB_ROLL_PTR</td>
</tr>
<tr>
<td>版本链</td>
<td>通过回滚指针连接的多个版本</td>
</tr>
<tr>
<td>ReadView</td>
<td>事务快照，决定可见性</td>
</tr>
<tr>
<td>RC 级别</td>
<td>每次查询生成新 ReadView</td>
</tr>
<tr>
<td>RR 级别</td>
<td>第一次查询生成 ReadView 并复用</td>
</tr>
</tbody></table>
<h3 id="下一章预告"><a href="#下一章预告" class="headerlink" title="下一章预告"></a>下一章预告</h3><p>下一篇文章将介绍<strong>视图</strong>，包括：</p>
<ul>
<li>视图的概念和语法</li>
<li>视图的检查选项</li>
<li>视图的更新</li>
<li>视图的应用场景</li>
</ul>
<hr>
<p><strong>上一篇</strong>：[MySQL 进阶教程 10-01 锁机制详解](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 进阶教程 10-01 锁机制详解&#x2F;)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2011-01%20InnoDB%20%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B7%B1%E5%85%A5/">https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2011-01%20InnoDB%20%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B7%B1%E5%85%A5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E4%BA%8B%E5%8A%A1/">事务</a><a class="post-meta__tags" href="/tags/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">存储引擎</a><a class="post-meta__tags" href="/tags/InnoDB/">InnoDB</a><a class="post-meta__tags" href="/tags/MVCC/">MVCC</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%80%EF%BC%89NumPy%20%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" title="Python 数据科学（一）NumPy 数值计算"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Python 数据科学（一）NumPy 数值计算</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（一）NumPy 数值计算NumPy 是 Python 数据科学的基石。本篇将介绍 NumPy 的核心功能，包括 ndarray 数组、向量化计算、广播机制等。 一、NumPy 简介1.1 为什么使用 NumPy？ 性能优势：底层用 C 实现，比纯 Python 快 10-100 倍 内存效率：连续存储，占用更少内存 向量化操作：无需循环，代码更简洁 生态基础：Pandas、SciPy、scikit-learn 等都基于 NumPy  1.2 安装与导入1pip install numpy  1234import numpy as np# 查看版本print(np.__version__)  二、ndarray 数组2.1 创建数组123456789101112131415161718192021222324252627282930313233import numpy as np# 从列表创建arr1 = np.array([1, 2, 3, 4, 5])arr2 = np.array([[1, 2, 3], [4, 5, 6]])  # 二维数组# 特殊数...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2004-05%20%E7%AA%97%E5%8F%A3%E6%A1%86%E6%9E%B6%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 04-05 窗口框架详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 进阶教程 04-05 窗口框架详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 04-05 窗口框架详解窗口框架（Window Frame）用于精确定义窗口函数操作的数据范围。本文将详细讲解 ROWS 和 RANGE 的区别，以及各种窗口边界的使用方法。 一、窗口框架概述1.1 什么是窗口框架？窗口框架 是窗口函数中用于定义”窗口”具体范围的部分，决定了哪些行参与计算。 12345OVER (    [PARTITION BY 列名]     -- 分区：将数据分成多个组    [ORDER BY 列名]          -- 排序：窗口内数据的排序    [ROWS/RANGE BETWEEN ...] -- 窗口框架：精确定义窗口范围)  1.2 默认窗口框架关键规则：  有 ORDER BY 无框架子句：默认 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW 无 ORDER BY：使用整个分区  12345678910111213141516171819202122232425262728293031-- 准备测试数据DROP TABLE IF EXISTS sales;CREA...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2006-01%20%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 06-01 存储引擎详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 进阶教程 06-01 存储引擎详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 06-01 存储引擎详解存储引擎是 MySQL 的核心组件之一，决定了数据的存储方式和访问特性。本文将详细介绍 MySQL 的存储引擎架构和常用引擎的特点。 一、存储引擎概述1.1 什么是存储引擎？存储引擎（Storage Engine） 是 MySQL 中负责数据存储、提取和管理的底层组件。MySQL 采用插件式存储引擎架构，可以根据需求选择不同的引擎。 1234567891011MySQL 架构简图：┌─────────────────────────────────────┐│         SQL 接口（查询解析）          │├─────────────────────────────────────┤│         查询优化器                   │├─────────────────────────────────────┤│     存储引擎层（插件式架构）           ││  ┌─────────┬─────────┬─────────┐    ││  │ InnoDB  │ MyISAM  │ Mem...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2005-01%20%E4%BA%8B%E5%8A%A1%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 05-01 事务详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 进阶教程 05-01 事务详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 05-01 事务详解事务是数据库管理的核心技术之一，用于保证数据的完整性和一致性。本文将详细讲解事务的概念、ACID 特性、并发问题以及隔离级别。 一、事务简介1.1 什么是事务？事务（Transaction） 是数据库管理系统执行过程中的一个逻辑单位，由一个有限的数据库操作序列构成。这些操作要么全部成功执行，要么全部不执行，是一个不可分割的工作单位。 1.2 事务的特点 原子性：事务是一个不可分割的操作序列 一致性：事务执行前后，数据保持一致 独立性：多个事务并发执行时互不干扰 持久性：事务一旦提交，修改永久保存  1.3 事务的使用场景   场景 说明    银行转账 A 转给 B 钱，A 扣款和 B 收款必须同时成功或失败   订单创建 创建订单、扣减库存、生成物流单必须同时成功   批量操作 批量导入数据，要么全部导入成功，要么全部回滚   数据一致性 更新多个关联表时保持一致性   1.4 不使用事务的问题12345678910-- 不使用事务的转账操作-- 步骤 1：A 账户扣款UPDATE accounts SET balance = bala...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2004-01%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E6%A6%82%E8%BF%B0/" title="MySQL 进阶教程 04-01 窗口函数概述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 进阶教程 04-01 窗口函数概述</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 04-01 窗口函数概述窗口函数（Window Function）是 MySQL 8.0+ 引入的强大特性，用于实现复杂的分析查询。本文将详细介绍窗口函数的基本概念、语法结构以及与聚合函数的区别。 一、窗口函数简介1.1 什么是窗口函数？窗口函数 是对一组行（称为”窗口”）执行计算的函数，但与聚合函数不同的是，窗口函数会为每一行返回一个结果，而不是将多行聚合为单个值。 通俗理解：  聚合函数：多行 → 一个结果 窗口函数：多行 → 每行一个结果（基于窗口内数据计算）  1.2 窗口函数的应用场景   场景 说明 示例    排名问题 获取 Top N 记录 每个部门工资最高的 3 名员工   累计计算 累计求和、平均值 累计销售额、移动平均   前后行访问 访问当前行的前后行数据 同比、环比增长   分组内排序 组内排序编号 每笔订单在客户订单中的序号   分桶分析 将数据分成若干组 按成绩分等级、百分位分析   1.3 为什么需要窗口函数？在窗口函数出现之前，实现类似功能通常需要：  自连接 子查询 用户变量 应用层处理  这些方法往往语法复杂、性能较差、...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2002-01%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%A6%82%E8%BF%B0/" title="MySQL 运维篇 02-01 主从复制概述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 02-01 主从复制概述</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 02-01 主从复制概述主从复制（Replication）是 MySQL 高可用架构的基础。本篇将介绍主从复制的概念、原理、应用场景和配置方法。 一、主从复制介绍1.1 什么是主从复制？主从复制是将一台 MySQL 服务器（主库）的数据同步到一台或多台 MySQL 服务器（从库）的技术。 123456主从复制架构：       主库（Master）      /      |      \   从库 1   从库 2   从库 3  (Slave)  (Slave)  (Slave)  1.2 复制术语   术语 说明    主库（Master） 提供数据的 MySQL 服务器，处理写操作   从库（Slave） 复制数据的 MySQL 服务器，处理读操作   主库 binlog 主库记录的变更日志   中继日志（Relay Log） 从库存储的主库 binlog 副本   I&#x2F;O 线程 从库上负责连接主库并获取 binlog 的线程   SQL 线程 从库上负责重放 relay log 的线程   1.3 复制特点   特点 说明    异步复制 ...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2001-01%20%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 01-01 常用函数概述与字符串函数"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 进阶教程 01-01 常用函数概述与字符串函数</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 01-01 常用函数概述与字符串函数在基础教程中，我们学习了 SQL 的基本查询和操作。本文将系统讲解 MySQL 提供的常用内置函数，重点介绍字符串函数的使用方法。 一、函数概述MySQL 函数是对数据进行特定操作的预定义程序，可以简化 SQL 语句，提高开发效率。 函数的分类：  字符串函数：处理字符串数据 数值函数：处理数值数据 日期时间函数：处理日期和时间 流程函数：条件判断和流程控制 聚合函数：对一组数据进行计算（已在 DQL 章节讲解） 加密函数：数据加密和哈希 其他函数：信息函数、加锁函数等  二、字符串函数2.1 字符串连接与长度123456789101112131415-- CONCAT(s1, s2, ...)：连接字符串SELECT CONCAT(&#x27;Hello&#x27;, &#x27; &#x27;, &#x27;World&#x27;) AS result;  -- &#x27;Hello World&#x27;SELECT CONCAT(&#x27;姓名：&#x27;, name) FROM employees;-- C...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89DDL%20%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3/" title="MySQL 基础教程（二）DDL 数据定义语言详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 基础教程（二）DDL 数据定义语言详解</div></div><div class="info-2"><div class="info-item-1">MySQL 基础教程（二）DDL 数据定义语言详解在上一篇中，我们完成了 MySQL 的安装并了解了 SQL 的分类。本文我们将深入学习 DDL（Data Definition Language）数据定义语言，掌握如何创建和管理数据库与表。 一、DDL 概述DDL 用于定义和管理数据库对象，包括：  数据库操作：CREATE DATABASE、DROP DATABASE、ALTER DATABASE、USE 表操作：CREATE TABLE、ALTER TABLE、DROP TABLE、TRUNCATE、RENAME 索引操作：CREATE INDEX、DROP INDEX 视图操作：CREATE VIEW、DROP VIEW  DDL 的特点：  操作会自动提交，无法回滚 操作的是数据库结构，而非数据内容  二、数据库操作2.1 创建数据库12345678910111213-- 创建数据库（如果不存在）CREATE DATABASE IF NOT EXISTS mydb;-- 创建数据库并指定字符集CREATE DATABASE IF NOT EXISTS mydbCHARAC...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B-11-01-InnoDB-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E6%B7%B1%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">MySQL 进阶教程 11-01 InnoDB 存储引擎深入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81InnoDB-%E9%80%BB%E8%BE%91%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">一、InnoDB 逻辑存储结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%B1%82%E6%AC%A1"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 存储结构层次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%A1%A8%E7%A9%BA%E9%97%B4"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 表空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E6%AE%B5"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%8C%BA"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E9%A1%B5"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5 页</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">二、内存结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-InnoDB-%E5%86%85%E5%AD%98%E7%BB%93%E6%9E%84%E6%A6%82%E8%A7%88"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 InnoDB 内存结构概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Buffer-Pool"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 Buffer Pool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Buffer-Pool-%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 Buffer Pool 工作原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E8%84%8F%E9%A1%B5%E5%88%B7%E6%96%B0"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 脏页刷新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%A3%81%E7%9B%98%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text">三、磁盘结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-InnoDB-%E4%B8%BB%E8%A6%81%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 InnoDB 主要文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%A1%A8%E7%A9%BA%E9%97%B4%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 表空间文件结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%90%8E%E5%8F%B0%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.4.</span> <span class="toc-text">四、后台线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-InnoDB-%E5%90%8E%E5%8F%B0%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 InnoDB 后台线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Master-Thread"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 Master Thread</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E4%BA%8B%E5%8A%A1%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0"><span class="toc-number">1.5.</span> <span class="toc-text">五、事务原理概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-InnoDB-%E4%BA%8B%E5%8A%A1%E7%89%B9%E6%80%A7"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 InnoDB 事务特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BA%8B%E5%8A%A1%E6%97%A5%E5%BF%97"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 事务日志</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81Redo-Log"><span class="toc-number">1.6.</span> <span class="toc-text">六、Redo Log</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-Redo-Log-%E4%BD%9C%E7%94%A8"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 Redo Log 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-Redo-Log-%E7%BB%93%E6%9E%84"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 Redo Log 结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-Redo-Log-%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 Redo Log 写入流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-Redo-Log-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 Redo Log 配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81Undo-Log"><span class="toc-number">1.7.</span> <span class="toc-text">七、Undo Log</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-Undo-Log-%E4%BD%9C%E7%94%A8"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 Undo Log 作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-Undo-Log-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 Undo Log 示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-Undo-Log-%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 Undo Log 类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81MVCC-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.8.</span> <span class="toc-text">八、MVCC 基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E4%BB%80%E4%B9%88%E6%98%AF-MVCC%EF%BC%9F"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 什么是 MVCC？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-MVCC-%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 MVCC 的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-MVCC-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 MVCC 实现原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81MVCC-%E9%9A%90%E8%97%8F%E5%AD%97%E6%AE%B5"><span class="toc-number">1.9.</span> <span class="toc-text">九、MVCC 隐藏字段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E9%9A%90%E8%97%8F%E5%88%97"><span class="toc-number">1.9.1.</span> <span class="toc-text">9.1 隐藏列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E9%9A%90%E8%97%8F%E5%88%97%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.9.2.</span> <span class="toc-text">9.2 隐藏列查看</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81MVCC-%E7%89%88%E6%9C%AC%E9%93%BE"><span class="toc-number">1.10.</span> <span class="toc-text">十、MVCC 版本链</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E7%89%88%E6%9C%AC%E9%93%BE%E7%BB%93%E6%9E%84"><span class="toc-number">1.10.1.</span> <span class="toc-text">10.1 版本链结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E7%89%88%E6%9C%AC%E9%93%BE%E5%BD%A2%E6%88%90%E8%BF%87%E7%A8%8B"><span class="toc-number">1.10.2.</span> <span class="toc-text">10.2 版本链形成过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81MVCC-ReadView"><span class="toc-number">1.11.</span> <span class="toc-text">十一、MVCC ReadView</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-%E4%BB%80%E4%B9%88%E6%98%AF-ReadView%EF%BC%9F"><span class="toc-number">1.11.1.</span> <span class="toc-text">11.1 什么是 ReadView？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-ReadView-%E5%8F%AF%E8%A7%81%E6%80%A7%E8%A7%84%E5%88%99"><span class="toc-number">1.11.2.</span> <span class="toc-text">11.2 ReadView 可见性规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81MVCC-RC-%E7%BA%A7%E5%88%AB%E5%8E%9F%E7%90%86"><span class="toc-number">1.12.</span> <span class="toc-text">十二、MVCC RC 级别原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-RC-%E7%BA%A7%E5%88%AB%E7%9A%84-ReadView"><span class="toc-number">1.12.1.</span> <span class="toc-text">12.1 RC 级别的 ReadView</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81MVCC-RR-%E7%BA%A7%E5%88%AB%E5%8E%9F%E7%90%86"><span class="toc-number">1.13.</span> <span class="toc-text">十三、MVCC RR 级别原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-RR-%E7%BA%A7%E5%88%AB%E7%9A%84-ReadView"><span class="toc-number">1.13.1.</span> <span class="toc-text">13.1 RR 级别的 ReadView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-RR-%E7%BA%A7%E5%88%AB%E8%A7%A3%E5%86%B3%E5%B9%BB%E8%AF%BB"><span class="toc-number">1.13.2.</span> <span class="toc-text">13.2 RR 级别解决幻读</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.14.</span> <span class="toc-text">十四、小结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#InnoDB-%E6%9E%B6%E6%9E%84%E6%80%BB%E7%BB%93"><span class="toc-number">1.14.1.</span> <span class="toc-text">InnoDB 架构总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MVCC-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">1.14.2.</span> <span class="toc-text">MVCC 核心概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E4%B8%80%E7%AB%A0%E9%A2%84%E5%91%8A"><span class="toc-number">1.14.3.</span> <span class="toc-text">下一章预告</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%A6%E8%A7%A3%20-%20%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E3%80%81%E6%95%B0%E6%8D%AE%E5%88%86%E5%B1%82%E4%B8%8E%20SCD%20%E5%A4%84%E7%90%86/" title="数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理">数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-10%20MyCat%20%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7/" title="MySQL 运维篇 04-10 MyCat 管理与监控">MySQL 运维篇 04-10 MyCat 管理与监控</a><time datetime="2026-02-24T12:05:00.000Z" title="发表于 2026-02-24 20:05:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>