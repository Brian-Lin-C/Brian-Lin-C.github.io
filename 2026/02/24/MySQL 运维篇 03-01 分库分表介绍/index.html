<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL 运维篇 03-01 分库分表介绍 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL 运维篇 03-01 分库分表介绍当单表数据量过大时，数据库性能会显著下降。分库分表是解决大数据量存储和查询的有效方案。本文将介绍分库分表的概念、场景和常见方案。 一、为什么需要分库分表1.1 单表数据量限制经验法则： 12345单表数据量建议：├── 100 万以内：性能良好├── 100 万 -500 万：需要优化├── 500 万 -1000 万：需要考虑分表└── 1000 万以">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 运维篇 03-01 分库分表介绍">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-01%20%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%BB%8B%E7%BB%8D/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="MySQL 运维篇 03-01 分库分表介绍当单表数据量过大时，数据库性能会显著下降。分库分表是解决大数据量存储和查询的有效方案。本文将介绍分库分表的概念、场景和常见方案。 一、为什么需要分库分表1.1 单表数据量限制经验法则： 12345单表数据量建议：├── 100 万以内：性能良好├── 100 万 -500 万：需要优化├── 500 万 -1000 万：需要考虑分表└── 1000 万以">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T11:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T11:15:43.229Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="scalability">
<meta property="article:tag" content="分库分表">
<meta property="article:tag" content="数据库架构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL 运维篇 03-01 分库分表介绍",
  "url": "https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-01%20%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%BB%8B%E7%BB%8D/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T11:00:00.000Z",
  "dateModified": "2026-02-24T11:15:43.229Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-01%20%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%BB%8B%E7%BB%8D/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 运维篇 03-01 分库分表介绍',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL 运维篇 03-01 分库分表介绍</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 运维篇 03-01 分库分表介绍</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T11:00:00.000Z" title="发表于 2026-02-24 19:00:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T11:15:43.229Z" title="更新于 2026-02-24 19:15:43">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL-%E8%BF%90%E7%BB%B4%E7%AF%87/">MySQL 运维篇</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MySQL-运维篇-03-01-分库分表介绍"><a href="#MySQL-运维篇-03-01-分库分表介绍" class="headerlink" title="MySQL 运维篇 03-01 分库分表介绍"></a>MySQL 运维篇 03-01 分库分表介绍</h1><p>当单表数据量过大时，数据库性能会显著下降。分库分表是解决大数据量存储和查询的有效方案。本文将介绍分库分表的概念、场景和常见方案。</p>
<h2 id="一、为什么需要分库分表"><a href="#一、为什么需要分库分表" class="headerlink" title="一、为什么需要分库分表"></a>一、为什么需要分库分表</h2><h3 id="1-1-单表数据量限制"><a href="#1-1-单表数据量限制" class="headerlink" title="1.1 单表数据量限制"></a>1.1 单表数据量限制</h3><p><strong>经验法则</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">单表数据量建议：</span><br><span class="line">├── 100 万以内：性能良好</span><br><span class="line">├── 100 万 -500 万：需要优化</span><br><span class="line">├── 500 万 -1000 万：需要考虑分表</span><br><span class="line">└── 1000 万以上：必须分表</span><br></pre></td></tr></table></figure>

<p><strong>性能瓶颈</strong>：</p>
<table>
<thead>
<tr>
<th>数据量</th>
<th>查询性能</th>
<th>索引大小</th>
<th>维护成本</th>
</tr>
</thead>
<tbody><tr>
<td>100 万</td>
<td>&lt; 100ms</td>
<td>较小</td>
<td>低</td>
</tr>
<tr>
<td>500 万</td>
<td>100-500ms</td>
<td>中等</td>
<td>中</td>
</tr>
<tr>
<td>1000 万</td>
<td>&gt; 500ms</td>
<td>较大</td>
<td>高</td>
</tr>
<tr>
<td>1 亿+</td>
<td>&gt; 1s</td>
<td>很大</td>
<td>很高</td>
</tr>
</tbody></table>
<h3 id="1-2-常见问题"><a href="#1-2-常见问题" class="headerlink" title="1.2 常见问题"></a>1.2 常见问题</h3><p><strong>存储问题</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- 单表数据占用过多磁盘空间</span><br><span class="line">- 索引文件过大</span><br><span class="line">- binlog 增长过快</span><br></pre></td></tr></table></figure>

<p><strong>性能问题</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- 查询响应时间变长</span><br><span class="line">- 索引效率下降</span><br><span class="line">- 锁竞争加剧</span><br><span class="line">- 缓冲池命中率降低</span><br></pre></td></tr></table></figure>

<p><strong>维护问题</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- DDL 操作耗时过长</span><br><span class="line">- 备份恢复困难</span><br><span class="line">- 数据清理影响性能</span><br></pre></td></tr></table></figure>

<h2 id="二、分库分表概念"><a href="#二、分库分表概念" class="headerlink" title="二、分库分表概念"></a>二、分库分表概念</h2><h3 id="2-1-基本概念"><a href="#2-1-基本概念" class="headerlink" title="2.1 基本概念"></a>2.1 基本概念</h3><p><strong>分库分表（Sharding）</strong>：<br>将一个大表的数据分散到多个数据库或多个表中，以降低单表数据量，提高查询性能。</p>
<h3 id="2-2-分库-vs-分表"><a href="#2-2-分库-vs-分表" class="headerlink" title="2.2 分库 vs 分表"></a>2.2 分库 vs 分表</h3><table>
<thead>
<tr>
<th>方式</th>
<th>说明</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td>分表</td>
<td>同一数据库内拆分表</td>
<td>单表数据量大</td>
</tr>
<tr>
<td>分库</td>
<td>不同数据库实例拆分</td>
<td>单库容量&#x2F;性能不足</td>
</tr>
<tr>
<td>分库分表</td>
<td>同时使用两种方式</td>
<td>超大规模数据</td>
</tr>
</tbody></table>
<h3 id="2-3-拆分示意图"><a href="#2-3-拆分示意图" class="headerlink" title="2.3 拆分示意图"></a>2.3 拆分示意图</h3><p><strong>分表</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">原始表：</span><br><span class="line">orders (1 亿条数据)</span><br><span class="line"></span><br><span class="line">分表后：</span><br><span class="line">orders_0000 (100 万条)</span><br><span class="line">orders_0001 (100 万条)</span><br><span class="line">...</span><br><span class="line">orders_0099 (100 万条)</span><br></pre></td></tr></table></figure>

<p><strong>分库</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">原始库：</span><br><span class="line">DB_Master (100 个表，1 亿条数据)</span><br><span class="line"></span><br><span class="line">分库后：</span><br><span class="line">DB_0 (10 个表，1000 万条)</span><br><span class="line">DB_1 (10 个表，1000 万条)</span><br><span class="line">...</span><br><span class="line">DB_9 (10 个表，1000 万条)</span><br></pre></td></tr></table></figure>

<h2 id="三、拆分方式"><a href="#三、拆分方式" class="headerlink" title="三、拆分方式"></a>三、拆分方式</h2><h3 id="3-1-垂直拆分"><a href="#3-1-垂直拆分" class="headerlink" title="3.1 垂直拆分"></a>3.1 垂直拆分</h3><p><strong>定义</strong>：按列拆分，将大字段或访问频率低的字段拆分到独立表中。</p>
<p><strong>示意图</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">原始表：</span><br><span class="line">user (id, name, email, phone, address, description, created_at)</span><br><span class="line"></span><br><span class="line">垂直拆分后：</span><br><span class="line">user_base (id, name, email, phone, created_at)     -- 常用字段</span><br><span class="line">user_detail (id, address, description)              -- 大字段</span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>：</p>
<ul>
<li>减少主表数据量</li>
<li>提高缓存命中率</li>
<li>减少 IO 消耗</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>需要 JOIN 查询</li>
<li>增加复杂度</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>表中有 TEXT、BLOB 等大字段</li>
<li>字段访问频率差异大</li>
</ul>
<h3 id="3-2-水平拆分"><a href="#3-2-水平拆分" class="headerlink" title="3.2 水平拆分"></a>3.2 水平拆分</h3><p><strong>定义</strong>：按行拆分，根据某个字段的值将数据分布到不同表中。</p>
<p><strong>示意图</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">原始表：</span><br><span class="line">orders (1 亿条数据)</span><br><span class="line"></span><br><span class="line">水平拆分后（按 user_id 取模）：</span><br><span class="line">orders_0000 (user_id % 100 = 0)</span><br><span class="line">orders_0001 (user_id % 100 = 1)</span><br><span class="line">...</span><br><span class="line">orders_0099 (user_id % 100 = 99)</span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>：</p>
<ul>
<li>单表数据量小</li>
<li>查询效率高</li>
<li>扩展性好</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>跨分片查询复杂</li>
<li>数据分布可能不均</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>单表数据量过大</li>
<li>有明显的分片键</li>
</ul>
<h2 id="四、分片策略"><a href="#四、分片策略" class="headerlink" title="四、分片策略"></a>四、分片策略</h2><h3 id="4-1-取模分片"><a href="#4-1-取模分片" class="headerlink" title="4.1 取模分片"></a>4.1 取模分片</h3><p><strong>公式</strong>：<code>table_index = sharding_key % table_count</code></p>
<p><strong>示例</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按 user_id 分 100 个表</span></span><br><span class="line">user_id <span class="operator">=</span> <span class="number">12345</span></span><br><span class="line">table_index <span class="operator">=</span> <span class="number">12345</span> <span class="operator">%</span> <span class="number">100</span> <span class="operator">=</span> <span class="number">45</span></span><br><span class="line"><span class="comment">-- 数据存储在 orders_0045</span></span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>：</p>
<ul>
<li>数据分布均匀</li>
<li>算法简单</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>扩容困难（需要 rehash）</li>
<li>范围查询效率低</li>
</ul>
<h3 id="4-2-范围分片"><a href="#4-2-范围分片" class="headerlink" title="4.2 范围分片"></a>4.2 范围分片</h3><p><strong>公式</strong>：<code>根据 sharding_key 的范围划分</code></p>
<p><strong>示例</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按日期范围分表</span></span><br><span class="line">orders_202401 (<span class="number">2024</span> 年 <span class="number">1</span> 月数据)</span><br><span class="line">orders_202402 (<span class="number">2024</span> 年 <span class="number">2</span> 月数据)</span><br><span class="line">...</span><br><span class="line">orders_202412 (<span class="number">2024</span> 年 <span class="number">12</span> 月数据)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 或按 ID 范围</span></span><br><span class="line">orders_0000 (id: <span class="number">1</span><span class="number">-1000000</span>)</span><br><span class="line">orders_0001 (id: <span class="number">1000001</span><span class="number">-2000000</span>)</span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>：</p>
<ul>
<li>扩容相对容易</li>
<li>范围查询效率高</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>数据可能分布不均</li>
<li>热点数据集中</li>
</ul>
<h3 id="4-3-哈希分片"><a href="#4-3-哈希分片" class="headerlink" title="4.3 哈希分片"></a>4.3 哈希分片</h3><p><strong>公式</strong>：<code>table_index = hash(sharding_key) % table_count</code></p>
<p><strong>示例</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用 MD5 哈希</span></span><br><span class="line">user_id <span class="operator">=</span> <span class="string">&#x27;abc123&#x27;</span></span><br><span class="line">hash_value <span class="operator">=</span> MD5(user_id)</span><br><span class="line">table_index <span class="operator">=</span> hash_value <span class="operator">%</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>：</p>
<ul>
<li>数据分布更均匀</li>
<li>减少热点</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>扩容需要 rehash</li>
<li>范围查询无效</li>
</ul>
<h3 id="4-4-地理分片"><a href="#4-4-地理分片" class="headerlink" title="4.4 地理分片"></a>4.4 地理分片</h3><p><strong>公式</strong>：<code>按地理位置/区域划分</code></p>
<p><strong>示例</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按省份分库</span></span><br><span class="line">orders_beijing (北京用户)</span><br><span class="line">orders_shanghai (上海用户)</span><br><span class="line">orders_guangdong (广东用户)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 或按国家分库</span></span><br><span class="line">orders_us (美国用户)</span><br><span class="line">orders_cn (中国用户)</span><br><span class="line">orders_eu (欧洲用户)</span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>：</p>
<ul>
<li>就近访问</li>
<li>符合数据合规要求</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>跨区域查询复杂</li>
<li>数据分布可能不均</li>
</ul>
<h3 id="4-5-一致性哈希"><a href="#4-5-一致性哈希" class="headerlink" title="4.5 一致性哈希"></a>4.5 一致性哈希</h3><p><strong>原理</strong>：将数据和节点映射到哈希环上，减少扩容时的数据迁移。</p>
<p><strong>优点</strong>：</p>
<ul>
<li>扩容时数据迁移少</li>
<li>节点增减影响小</li>
</ul>
<p><strong>缺点</strong>：</p>
<ul>
<li>实现复杂</li>
<li>可能有数据倾斜</li>
</ul>
<h2 id="五、分片键选择"><a href="#五、分片键选择" class="headerlink" title="五、分片键选择"></a>五、分片键选择</h2><h3 id="5-1-常见分片键"><a href="#5-1-常见分片键" class="headerlink" title="5.1 常见分片键"></a>5.1 常见分片键</h3><table>
<thead>
<tr>
<th>分片键</th>
<th>适用场景</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody><tr>
<td>user_id</td>
<td>用户订单</td>
<td>查询集中</td>
<td>热点用户</td>
</tr>
<tr>
<td>order_id</td>
<td>订单查询</td>
<td>分布均匀</td>
<td>范围查询少</td>
</tr>
<tr>
<td>日期</td>
<td>日志数据</td>
<td>自然过期</td>
<td>热点问题</td>
</tr>
<tr>
<td>地区</td>
<td>本地化服务</td>
<td>就近访问</td>
<td>分布不均</td>
</tr>
</tbody></table>
<h3 id="5-2-选择原则"><a href="#5-2-选择原则" class="headerlink" title="5.2 选择原则"></a>5.2 选择原则</h3><ol>
<li><strong>高频查询字段</strong>：WHERE 条件常用字段</li>
<li><strong>数据分布均匀</strong>：避免数据倾斜</li>
<li><strong>业务相关性</strong>：同一业务数据在同一分片</li>
<li><strong>扩展性</strong>：便于未来扩容</li>
</ol>
<h3 id="5-3-避免的分片键"><a href="#5-3-避免的分片键" class="headerlink" title="5.3 避免的分片键"></a>5.3 避免的分片键</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">❌ 自增 ID：导致写入热点</span><br><span class="line">❌ 状态字段：数据分布极不均匀</span><br><span class="line">❌ 时间字段（单独使用）：导致写入集中</span><br></pre></td></tr></table></figure>

<h2 id="六、分库分表带来的问题"><a href="#六、分库分表带来的问题" class="headerlink" title="六、分库分表带来的问题"></a>六、分库分表带来的问题</h2><h3 id="6-1-事务问题"><a href="#6-1-事务问题" class="headerlink" title="6.1 事务问题"></a>6.1 事务问题</h3><p><strong>问题</strong>：跨分片事务难以保证 ACID 特性。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>避免跨分片事务</li>
<li>使用分布式事务方案（XA、TCC、Saga）</li>
<li>最终一致性</li>
</ul>
<h3 id="6-2-JOIN-问题"><a href="#6-2-JOIN-问题" class="headerlink" title="6.2 JOIN 问题"></a>6.2 JOIN 问题</h3><p><strong>问题</strong>：跨分片 JOIN 性能极差。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>应用层组装</li>
<li>数据冗余</li>
<li>绑定表（同一分片规则）</li>
<li>全局表（小表广播）</li>
</ul>
<h3 id="6-3-排序分页问题"><a href="#6-3-排序分页问题" class="headerlink" title="6.3 排序分页问题"></a>6.3 排序分页问题</h3><p><strong>问题</strong>：跨分片 ORDER BY 和 LIMIT 复杂。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>各分片排序后合并</li>
<li>限制最大页码</li>
<li>使用游标式分页</li>
</ul>
<h3 id="6-4-分布式-ID-问题"><a href="#6-4-分布式-ID-问题" class="headerlink" title="6.4 分布式 ID 问题"></a>6.4 分布式 ID 问题</h3><p><strong>问题</strong>：需要全局唯一 ID。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>Snowflake 算法</li>
<li>UUID（不推荐作为主键）</li>
<li>号段模式</li>
<li>Redis 生成</li>
</ul>
<h3 id="6-5-数据迁移问题"><a href="#6-5-数据迁移问题" class="headerlink" title="6.5 数据迁移问题"></a>6.5 数据迁移问题</h3><p><strong>问题</strong>：扩容时需要迁移数据。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>双写迁移</li>
<li>增量同步</li>
<li>灰度切换</li>
</ul>
<h2 id="七、中间件方案"><a href="#七、中间件方案" class="headerlink" title="七、中间件方案"></a>七、中间件方案</h2><h3 id="7-1-MyCat"><a href="#7-1-MyCat" class="headerlink" title="7.1 MyCat"></a>7.1 MyCat</h3><p><strong>特点</strong>：</p>
<ul>
<li>开源数据库中间件</li>
<li>基于 MySQL 协议</li>
<li>支持多种分片规则</li>
</ul>
<p><strong>架构</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">应用 → MyCat → MySQL 集群</span><br></pre></td></tr></table></figure>

<h3 id="7-2-ShardingSphere"><a href="#7-2-ShardingSphere" class="headerlink" title="7.2 ShardingSphere"></a>7.2 ShardingSphere</h3><p><strong>特点</strong>：</p>
<ul>
<li>Apache 顶级项目</li>
<li>支持客户端和代理模式</li>
<li>功能丰富</li>
</ul>
<p><strong>组件</strong>：</p>
<ul>
<li>Sharding-JDBC（客户端）</li>
<li>Sharding-Proxy（代理）</li>
<li>Sharding-Sidecar（云原生）</li>
</ul>
<h3 id="7-3-其他方案"><a href="#7-3-其他方案" class="headerlink" title="7.3 其他方案"></a>7.3 其他方案</h3><table>
<thead>
<tr>
<th>中间件</th>
<th>特点</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td>MyCat</td>
<td>轻量级</td>
<td>中小规模</td>
</tr>
<tr>
<td>ShardingSphere</td>
<td>功能全面</td>
<td>大规模</td>
</tr>
<tr>
<td>Vitess</td>
<td>YouTube 开源</td>
<td>超大规模</td>
</tr>
<tr>
<td>TiDB</td>
<td>原生分布式</td>
<td>新系统</td>
</tr>
</tbody></table>
<h2 id="八、最佳实践"><a href="#八、最佳实践" class="headerlink" title="八、最佳实践"></a>八、最佳实践</h2><h3 id="8-1-设计原则"><a href="#8-1-设计原则" class="headerlink" title="8.1 设计原则"></a>8.1 设计原则</h3><ol>
<li><strong>能不拆分就不拆分</strong>：优先优化 SQL 和索引</li>
<li><strong>先垂直后水平</strong>：先垂直拆分，再考虑水平拆分</li>
<li><strong>合理选择分片键</strong>：根据业务场景选择</li>
<li><strong>预留扩展空间</strong>：分片数量适当超前</li>
</ol>
<h3 id="8-2-实施步骤"><a href="#8-2-实施步骤" class="headerlink" title="8.2 实施步骤"></a>8.2 实施步骤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 评估是否需要分库分表</span><br><span class="line">2. 选择合适的分片策略</span><br><span class="line">3. 设计分片键和分片规则</span><br><span class="line">4. 选择中间件方案</span><br><span class="line">5. 开发和测试</span><br><span class="line">6. 数据迁移</span><br><span class="line">7. 灰度上线</span><br><span class="line">8. 监控运维</span><br></pre></td></tr></table></figure>

<h3 id="8-3-监控指标"><a href="#8-3-监控指标" class="headerlink" title="8.3 监控指标"></a>8.3 监控指标</h3><table>
<thead>
<tr>
<th>指标</th>
<th>说明</th>
<th>告警阈值</th>
</tr>
</thead>
<tbody><tr>
<td>分片数据量</td>
<td>各分片数据分布</td>
<td>差异&gt;50%</td>
</tr>
<tr>
<td>查询延迟</td>
<td>跨分片查询时间</td>
<td>&gt; 1s</td>
</tr>
<tr>
<td>事务失败率</td>
<td>分布式事务失败比例</td>
<td>&gt; 1%</td>
</tr>
<tr>
<td>数据一致性</td>
<td>主从数据差异</td>
<td>存在差异</td>
</tr>
</tbody></table>
<h2 id="九、小结"><a href="#九、小结" class="headerlink" title="九、小结"></a>九、小结</h2><h3 id="核心知识点"><a href="#核心知识点" class="headerlink" title="核心知识点"></a>核心知识点</h3><ol>
<li><strong>分库分表目的</strong>：解决单表数据量过大的性能问题</li>
<li><strong>拆分方式</strong>：垂直拆分、水平拆分</li>
<li><strong>分片策略</strong>：取模、范围、哈希、地理、一致性哈希</li>
<li><strong>分片键选择</strong>：高频查询、分布均匀、业务相关</li>
</ol>
<h3 id="分库分表决策树"><a href="#分库分表决策树" class="headerlink" title="分库分表决策树"></a>分库分表决策树</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">单表数据量大？</span><br><span class="line">├── 否 → 优化 SQL 和索引</span><br><span class="line">└── 是 → 需要拆分</span><br><span class="line">    ├── 字段访问频率差异大？</span><br><span class="line">    │   ├── 是 → 垂直拆分</span><br><span class="line">    │   └── 否 → 水平拆分</span><br><span class="line">    │</span><br><span class="line">    └── 水平拆分 → 选择分片策略</span><br><span class="line">        ├── 均匀分布 → 取模/哈希</span><br><span class="line">        ├── 范围查询多 → 范围分片</span><br><span class="line">        └── 地理相关 → 地理分片</span><br></pre></td></tr></table></figure>

<h3 id="下一篇预告"><a href="#下一篇预告" class="headerlink" title="下一篇预告"></a>下一篇预告</h3><p>接下来的文章将详细介绍 MyCat 分库分表：</p>
<ul>
<li>03-02：拆分方式详解</li>
<li>03-03：MyCat 概述</li>
<li>03-04：MyCat 安装</li>
</ul>
<hr>
<p><strong>下一篇</strong>：[MySQL 运维篇 03-02 拆分方式详解](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 运维篇 03-02 拆分方式详解&#x2F;)</p>
<p><strong>上一篇</strong>：[MySQL 运维篇 02-05 主从复制测试](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 运维篇 02-05 主从复制测试&#x2F;)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-01%20%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%BB%8B%E7%BB%8D/">https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-01%20%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%BB%8B%E7%BB%8D/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/">分库分表</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9E%B6%E6%9E%84/">数据库架构</a><a class="post-meta__tags" href="/tags/scalability/">scalability</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Python 常用库（三）logging 日志模块</div></div><div class="info-2"><div class="info-item-1">Python 常用库（三）logging 日志模块日志是程序调试、监控和问题排查的重要工具。本篇将详细介绍 Python 内置的 logging 模块。 一、logging 简介1.1 为什么使用 logging？ 标准库：无需安装，开箱即用 灵活配置：可配置输出格式、级别、目标等 高性能：内置优化，适合生产环境 可扩展：支持自定义 Handler、Formatter、Filter  1.2 日志级别   级别 数值 说明 使用场景    DEBUG 10 调试信息 开发调试时的详细信息   INFO 20 一般信息 程序正常运行的信息   WARNING 30 警告信息 不影响运行但需要注意   ERROR 40 错误信息 程序错误但不影响继续运行   CRITICAL 50 严重错误 严重错误，程序可能无法继续   1234567import logginglogging.debug(&quot;调试信息&quot;)logging.info(&quot;一般信息&quot;)logging.warning(&quot;警告信息&quot;)logging.error(&qu...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2002-05%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%B5%8B%E8%AF%95/" title="MySQL 运维篇 02-05 主从复制测试"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 运维篇 02-05 主从复制测试</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 02-05 主从复制测试完成主从配置后，需要进行全面的测试以验证复制功能正常。本文将介绍各种测试场景和验证方法。 一、复制状态检查1.1 基础状态检查12-- 在从库执行SHOW SLAVE STATUS\G  关键指标： 12345678Slave_IO_Running: Yes        ✓ I/O 线程运行正常Slave_SQL_Running: Yes       ✓ SQL 线程运行正常Seconds_Behind_Master: 0     ✓ 无延迟Master_Host: 192.168.1.100   ✓ 主库连接正确Master_Port: 3306            ✓ 端口正确Last_Error:                  ✓ 无错误Last_IO_Error:               ✓ 无错误Last_SQL_Error:              ✓ 无错误  1.2 详细状态检查123456789101112131415-- 检查复制配置SELECT    Master_Host,    Master_Po...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-01%20MyCat%20%E5%85%A5%E9%97%A8/" title="MySQL 运维篇 04-01 MyCat 入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 04-01 MyCat 入门</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 04-01 MyCat 入门本文是 MyCat 分库分表的入门教程，将介绍如何使用 MyCat 实现简单的分库分表功能。 一、MyCat 简介1.1 什么是 MyCatMyCat 是一个数据库中间件层，位于应用程序和 MySQL 数据库之间，提供分库分表、读写分离等功能。 1应用程序 → MyCat (中间件) → MySQL 集群  1.2 MyCat 功能   功能 说明    分库分表 将数据分布到多个库&#x2F;表中   读写分离 自动将读请求路由到从库   SQL 路由 根据规则路由 SQL 到对应节点   结果合并 合并多个分片的查询结果   连接池 管理数据库连接   1.3 MyCat 版本 MyCat 1.x：经典版本，稳定 MyCat 2.x：重构版本，性能更好  二、快速开始2.1 环境准备软件版本：  MyCat 2.0 MySQL 8.0 JDK 1.8+  服务器：    服务器 IP 角色    server1 192.168.1.100 MyCat + MySQL   2.2 目录结构123456789/opt/mycat/├...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-02%20%E6%8B%86%E5%88%86%E6%96%B9%E5%BC%8F%E8%AF%A6%E8%A7%A3/" title="MySQL 运维篇 03-02 拆分方式详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 03-02 拆分方式详解</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 03-02 拆分方式详解本文将详细讲解各种分库分表的拆分方式，包括垂直拆分、水平拆分的实战案例和代码示例。 一、垂直拆分实战1.1 场景描述原始表结构： 1234567891011CREATE TABLE products (    id INT PRIMARY KEY AUTO_INCREMENT,    name VARCHAR(100),    description TEXT,        -- 大字段    detail TEXT,             -- 大字段    price DECIMAL(10, 2),    stock INT,    images BLOB,             -- 图片数据    created_at DATETIME,    updated_at DATETIME);  问题：  单表 1000 万数据 description、detail、images 占用大量空间 查询商品列表时不需要大字段  1.2 垂直拆分方案拆分后表结构： 1234567891011121314151617181920-- 商...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2003-03%20%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%20MyCat%20%E6%A6%82%E8%BF%B0/" title="MySQL 运维篇 03-03 分库分表 MyCat 概述"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 03-03 分库分表 MyCat 概述</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 03-03 分库分表 MyCat 概述MyCat 是一个开源的数据库中间件，位于应用程序和数据库之间，负责 SQL 解析、路由和结果合并。本文将介绍 MyCat 的基本概念、架构和核心功能。 一、MyCat 介绍1.1 什么是 MyCat？MyCat 是一个基于 Java 开发的数据库中间件，前身是阿里巴巴的 Cobar 项目。 12应用程序 → MyCat → MySQL 集群         (数据库中间件)  核心功能：  SQL 解析和路由 分库分表 读写分离 连接池管理 负载均衡  1.2 MyCat 特点   特点 说明    协议兼容 完全兼容 MySQL 协议   透明分片 应用无需修改代码   多种分片 支持 10+ 种分片规则   读写分离 自动路由读写请求   高可用 支持主从切换   1.3 适用场景   场景 说明    分库分表 单表数据量过大   读写分离 读多写少场景   数据库迁移 平滑迁移数据   多租户 SaaS 应用数据隔离   二、MyCat 架构2.1 整体架构1应用程序 → MyCat → MySQL 集群  核心...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2002-02%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86/" title="MySQL 运维篇 02-02 主从复制原理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 02-02 主从复制原理</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 02-02 主从复制原理深入理解主从复制的工作原理对于配置、监控和故障排查至关重要。本文将详细讲解复制的底层机制。 一、复制整体架构1.1 复制组件1234567891011主从复制核心组件：主库端：├── Binlog Dump Thread（为每个从库创建一个）└── Binlog（二进制日志）从库端：├── I/O Thread（一个）├── SQL Thread（一个）├── Relay Log（中继日志）└── Relay Log Info / Master Info（元数据）  1.2 数据流向1应用写入 → 主库 → binlog → I/O 线程 → relay log → SQL 线程 → 从库数据  二、主库复制机制2.1 Binlog Dump 线程创建时机：  从库连接主库时创建 每个从库对应一个线程  主要职责： 12341. 接收从库 I/O 线程的 binlog 请求2. 读取 binlog 指定位置的内容3. 将 binlog 事件发送给从库4. 等待新 binlog 事件产生  线程状态： 123456-- 在主库查看 dum...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2004-06%20NTILE%20%E5%88%86%E6%A1%B6%E5%87%BD%E6%95%B0/" title="MySQL 进阶教程 04-06 NTILE 分桶函数"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 进阶教程 04-06 NTILE 分桶函数</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 04-06 NTILE 分桶函数NTILE 函数用于将有序数据分成指定数量的组（桶），常用于排名分组、百分位计算等场景。本文将详细讲解 NTILE 函数的使用方法。 一、NTILE 函数基础1.1 函数语法1234NTILE(n) OVER (    [PARTITION BY 列名]    ORDER BY 列名)  参数说明：    参数 说明    n 要分成的桶数量（正整数）   返回值：  返回 1 到 n 之间的整数 表示该行所属的桶编号  1.2 测试数据准备1234567891011121314151617181920-- 准备学生成绩数据DROP TABLE IF EXISTS scores;CREATE TABLE scores (    id INT PRIMARY KEY AUTO_INCREMENT,    student_name VARCHAR(50) NOT NULL,    subject VARCHAR(20) NOT NULL,    score INT NOT NULL) ENGINE=InnoDB DEFAULT C...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-07%20MyCat%20%E8%8C%83%E5%9B%B4%E5%88%86%E7%89%87/" title="MySQL 运维篇 04-07 MyCat 范围分片"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 04-07 MyCat 范围分片</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 04-07 MyCat 范围分片范围分片是按照某个字段的范围进行数据分片。本文将介绍如何使用 MyCat 实现范围分片。 一、范围分片介绍1.1 什么是范围分片范围分片：根据分片键的值范围将数据分布到不同的分片中。 1234按 ID 范围分片：分片 0: id 1-1000000分片 1: id 1000001-2000000分片 2: id 2000001-3000000  1.2 适用场景   场景 说明    日期数据 按时间范围归档   有序 ID 按 ID 范围分布   地区数据 按地区编码范围   1.3 优缺点优点：  范围查询效率高 便于历史数据归档 扩容相对容易  缺点：  数据可能分布不均 热点问题（最新数据集中）  二、按日期范围分片2.1 配置rule.yml： 123456789101112tableRules:  - name: range-date    function: range-date    columns: created_atfunctions:  - name: range-date    className: i...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-%E8%BF%90%E7%BB%B4%E7%AF%87-03-01-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">MySQL 运维篇 03-01 分库分表介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="toc-number">1.1.</span> <span class="toc-text">一、为什么需要分库分表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%8D%95%E8%A1%A8%E6%95%B0%E6%8D%AE%E9%87%8F%E9%99%90%E5%88%B6"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 单表数据量限制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 常见问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E6%A6%82%E5%BF%B5"><span class="toc-number">1.2.</span> <span class="toc-text">二、分库分表概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E5%88%86%E5%BA%93-vs-%E5%88%86%E8%A1%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 分库 vs 分表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%8B%86%E5%88%86%E7%A4%BA%E6%84%8F%E5%9B%BE"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 拆分示意图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%8B%86%E5%88%86%E6%96%B9%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">三、拆分方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%9E%82%E7%9B%B4%E6%8B%86%E5%88%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 垂直拆分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%B0%B4%E5%B9%B3%E6%8B%86%E5%88%86"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 水平拆分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%88%86%E7%89%87%E7%AD%96%E7%95%A5"><span class="toc-number">1.4.</span> <span class="toc-text">四、分片策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%8F%96%E6%A8%A1%E5%88%86%E7%89%87"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 取模分片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%8C%83%E5%9B%B4%E5%88%86%E7%89%87"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 范围分片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E5%93%88%E5%B8%8C%E5%88%86%E7%89%87"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 哈希分片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%9C%B0%E7%90%86%E5%88%86%E7%89%87"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 地理分片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C"><span class="toc-number">1.4.5.</span> <span class="toc-text">4.5 一致性哈希</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%88%86%E7%89%87%E9%94%AE%E9%80%89%E6%8B%A9"><span class="toc-number">1.5.</span> <span class="toc-text">五、分片键选择</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%B8%B8%E8%A7%81%E5%88%86%E7%89%87%E9%94%AE"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 常见分片键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E9%80%89%E6%8B%A9%E5%8E%9F%E5%88%99"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 选择原则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E9%81%BF%E5%85%8D%E7%9A%84%E5%88%86%E7%89%87%E9%94%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 避免的分片键</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%B8%A6%E6%9D%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.</span> <span class="toc-text">六、分库分表带来的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 事务问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-JOIN-%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 JOIN 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E6%8E%92%E5%BA%8F%E5%88%86%E9%A1%B5%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 排序分页问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E5%88%86%E5%B8%83%E5%BC%8F-ID-%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.4.</span> <span class="toc-text">6.4 分布式 ID 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB%E9%97%AE%E9%A2%98"><span class="toc-number">1.6.5.</span> <span class="toc-text">6.5 数据迁移问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%96%B9%E6%A1%88"><span class="toc-number">1.7.</span> <span class="toc-text">七、中间件方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-MyCat"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 MyCat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-ShardingSphere"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 ShardingSphere</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E5%85%B6%E4%BB%96%E6%96%B9%E6%A1%88"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 其他方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.8.</span> <span class="toc-text">八、最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 设计原则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E5%AE%9E%E6%96%BD%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 实施步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-%E7%9B%91%E6%8E%A7%E6%8C%87%E6%A0%87"><span class="toc-number">1.8.3.</span> <span class="toc-text">8.3 监控指标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.9.</span> <span class="toc-text">九、小结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.9.1.</span> <span class="toc-text">核心知识点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8%E5%86%B3%E7%AD%96%E6%A0%91"><span class="toc-number">1.9.2.</span> <span class="toc-text">分库分表决策树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E4%B8%80%E7%AF%87%E9%A2%84%E5%91%8A"><span class="toc-number">1.9.3.</span> <span class="toc-text">下一篇预告</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%A6%E8%A7%A3%20-%20%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E3%80%81%E6%95%B0%E6%8D%AE%E5%88%86%E5%B1%82%E4%B8%8E%20SCD%20%E5%A4%84%E7%90%86/" title="数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理">数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-10%20MyCat%20%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7/" title="MySQL 运维篇 04-10 MyCat 管理与监控">MySQL 运维篇 04-10 MyCat 管理与监控</a><time datetime="2026-02-24T12:05:00.000Z" title="发表于 2026-02-24 20:05:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>