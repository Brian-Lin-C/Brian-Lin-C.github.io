<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL 运维篇 01-04 查询日志 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL 运维篇 01-04 查询日志查询日志（General Query Log，简称 general log）记录 MySQL 服务器接收到的所有客户端请求。虽然性能开销较大，但在特定场景下非常有用。 一、查询日志介绍1.1 什么是查询日志？查询日志记录所有客户端连接和执行的 SQL 语句： 12345查询日志记录内容：├── 客户端连接&#x2F;断开├── 所有 SQL 请求（SELECT、INS">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 运维篇 01-04 查询日志">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-04%20%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="MySQL 运维篇 01-04 查询日志查询日志（General Query Log，简称 general log）记录 MySQL 服务器接收到的所有客户端请求。虽然性能开销较大，但在特定场景下非常有用。 一、查询日志介绍1.1 什么是查询日志？查询日志记录所有客户端连接和执行的 SQL 语句： 12345查询日志记录内容：├── 客户端连接&#x2F;断开├── 所有 SQL 请求（SELECT、INS">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T10:15:00.000Z">
<meta property="article:modified_time" content="2026-02-24T11:07:00.866Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="general log">
<meta property="article:tag" content="审计">
<meta property="article:tag" content="查询日志">
<meta property="article:tag" content="运维">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL 运维篇 01-04 查询日志",
  "url": "https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-04%20%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T10:15:00.000Z",
  "dateModified": "2026-02-24T11:07:00.866Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-04%20%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 运维篇 01-04 查询日志',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL 运维篇 01-04 查询日志</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 运维篇 01-04 查询日志</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T10:15:00.000Z" title="发表于 2026-02-24 18:15:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T11:07:00.866Z" title="更新于 2026-02-24 19:07:00">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL-%E8%BF%90%E7%BB%B4%E7%AF%87/">MySQL 运维篇</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>8分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MySQL-运维篇-01-04-查询日志"><a href="#MySQL-运维篇-01-04-查询日志" class="headerlink" title="MySQL 运维篇 01-04 查询日志"></a>MySQL 运维篇 01-04 查询日志</h1><p>查询日志（General Query Log，简称 general log）记录 MySQL 服务器接收到的所有客户端请求。虽然性能开销较大，但在特定场景下非常有用。</p>
<h2 id="一、查询日志介绍"><a href="#一、查询日志介绍" class="headerlink" title="一、查询日志介绍"></a>一、查询日志介绍</h2><h3 id="1-1-什么是查询日志？"><a href="#1-1-什么是查询日志？" class="headerlink" title="1.1 什么是查询日志？"></a>1.1 什么是查询日志？</h3><p><strong>查询日志</strong>记录所有客户端连接和执行的 SQL 语句：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">查询日志记录内容：</span><br><span class="line">├── 客户端连接/断开</span><br><span class="line">├── 所有 SQL 请求（SELECT、INSERT、UPDATE、DELETE 等）</span><br><span class="line">├── 存储过程调用</span><br><span class="line">└── 管理员命令（SET、SHOW 等）</span><br></pre></td></tr></table></figure>

<h3 id="1-2-查询日志-vs-其他日志"><a href="#1-2-查询日志-vs-其他日志" class="headerlink" title="1.2 查询日志 vs 其他日志"></a>1.2 查询日志 vs 其他日志</h3><table>
<thead>
<tr>
<th>特性</th>
<th>查询日志</th>
<th>慢查询日志</th>
<th>二进制日志</th>
</tr>
</thead>
<tbody><tr>
<td>记录内容</td>
<td>所有查询</td>
<td>慢查询</td>
<td>数据变更</td>
</tr>
<tr>
<td>记录时机</td>
<td>查询开始时</td>
<td>查询结束后</td>
<td>事务提交时</td>
</tr>
<tr>
<td>性能影响</td>
<td>高</td>
<td>低</td>
<td>中</td>
</tr>
<tr>
<td>使用场景</td>
<td>调试、审计</td>
<td>性能优化</td>
<td>恢复、复制</td>
</tr>
</tbody></table>
<h3 id="1-3-使用场景"><a href="#1-3-使用场景" class="headerlink" title="1.3 使用场景"></a>1.3 使用场景</h3><table>
<thead>
<tr>
<th>场景</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>问题调试</td>
<td>追踪应用执行的 SQL</td>
</tr>
<tr>
<td>安全审计</td>
<td>记录用户操作历史</td>
</tr>
<tr>
<td>性能分析</td>
<td>分析查询频率和模式</td>
</tr>
<tr>
<td>故障排查</td>
<td>定位问题 SQL</td>
</tr>
</tbody></table>
<h2 id="二、查询日志配置"><a href="#二、查询日志配置" class="headerlink" title="二、查询日志配置"></a>二、查询日志配置</h2><h3 id="2-1-基本配置参数"><a href="#2-1-基本配置参数" class="headerlink" title="2.1 基本配置参数"></a>2.1 基本配置参数</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># 开启查询日志</span></span><br><span class="line"><span class="attr">general_log</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 日志文件路径</span></span><br><span class="line"><span class="attr">general_log_file</span> = /var/log/mysql/general.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 日志输出方式（MySQL 5.6+）</span></span><br><span class="line"><span class="comment"># FILE = 文件输出</span></span><br><span class="line"><span class="comment"># TABLE = 输出到 mysql.general_log 表</span></span><br><span class="line"><span class="attr">log_output</span> = FILE</span><br></pre></td></tr></table></figure>

<h3 id="2-2-配置参数详解"><a href="#2-2-配置参数详解" class="headerlink" title="2.2 配置参数详解"></a>2.2 配置参数详解</h3><p><strong>general_log</strong>：</p>
<ul>
<li><code>0</code> &#x3D; 关闭（默认）</li>
<li><code>1</code> &#x3D; 开启</li>
</ul>
<p><strong>general_log_file</strong>：</p>
<ul>
<li>指定日志文件路径</li>
<li>默认位置因操作系统而异</li>
</ul>
<p><strong>log_output</strong>：</p>
<ul>
<li><code>FILE</code>：输出到文件（推荐）</li>
<li><code>TABLE</code>：输出到系统表</li>
<li><code>FILE,TABLE</code>：同时输出</li>
</ul>
<h3 id="2-3-动态配置"><a href="#2-3-动态配置" class="headerlink" title="2.3 动态配置"></a>2.3 动态配置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 临时开启查询日志（重启失效）</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log_file <span class="operator">=</span> <span class="string">&#x27;/var/log/mysql/general.log&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看配置</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;general_log%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 临时关闭</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;OFF&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-输出到表配置"><a href="#2-4-输出到表配置" class="headerlink" title="2.4 输出到表配置"></a>2.4 输出到表配置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 输出到表</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> log_output <span class="operator">=</span> <span class="string">&#x27;TABLE&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 开启日志</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看日志</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log <span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span> LIMIT <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 清空日志</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> mysql.general_log;</span><br></pre></td></tr></table></figure>

<h2 id="三、查看查询日志"><a href="#三、查看查询日志" class="headerlink" title="三、查看查询日志"></a>三、查看查询日志</h2><h3 id="3-1-查看配置"><a href="#3-1-查看配置" class="headerlink" title="3.1 查看配置"></a>3.1 查看配置</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看是否开启</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;general_log&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看日志路径</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;general_log_file&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看输出方式</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;log_output&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-文件方式查看"><a href="#3-2-文件方式查看" class="headerlink" title="3.2 文件方式查看"></a>3.2 文件方式查看</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看最新日志</span></span><br><span class="line"><span class="built_in">tail</span> -100 /var/log/mysql/general.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实时跟踪</span></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/mysql/general.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索特定 SQL</span></span><br><span class="line">grep -i <span class="string">&quot;SELECT&quot;</span> /var/log/mysql/general.log | <span class="built_in">tail</span> -50</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索特定用户</span></span><br><span class="line">grep <span class="string">&quot;root&quot;</span> /var/log/mysql/general.log | <span class="built_in">tail</span> -50</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按时间筛选</span></span><br><span class="line">awk <span class="string">&#x27;/2024-02-24/&#x27;</span> /var/log/mysql/general.log</span><br></pre></td></tr></table></figure>

<h3 id="3-3-表方式查看"><a href="#3-3-表方式查看" class="headerlink" title="3.3 表方式查看"></a>3.3 表方式查看</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看最新 100 条</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看特定用户的操作</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> user_host <span class="keyword">LIKE</span> <span class="string">&#x27;%root%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看特定类型的 SQL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> argument <span class="keyword">LIKE</span> <span class="string">&#x27;SELECT%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计各类 SQL 数量</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">LEFT</span>(argument, LOCATE(<span class="string">&#x27; &#x27;</span>, argument)) <span class="keyword">AS</span> sql_type,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> cnt</span><br><span class="line"><span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sql_type;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看执行时间</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    event_time,</span><br><span class="line">    user_host,</span><br><span class="line">    argument</span><br><span class="line"><span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-查询日志格式"><a href="#3-4-查询日志格式" class="headerlink" title="3.4 查询日志格式"></a>3.4 查询日志格式</h3><p><strong>文件格式</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2024-02-24T10:30:45.123456Z	    1 Query	root[root] @ localhost [] 12345	0	SELECT * FROM users WHERE id = 1</span><br><span class="line">2024-02-24T10:30:46.123456Z	    1 Query	root[root] @ localhost [] 0	0	UPDATE users SET name = &#x27;张三&#x27; WHERE id = 1</span><br></pre></td></tr></table></figure>

<p><strong>字段说明</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">时间戳 | 线程 ID | 命令类型 | 用户信息 | 连接 ID | 执行时间 | SQL 语句</span><br></pre></td></tr></table></figure>

<p><strong>表格式</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">DESC</span> mysql.general_log;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------------+------+-----+-------------------+</span></span><br><span class="line"><span class="operator">|</span> Field       <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span>           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------------+------+-----+-------------------+</span></span><br><span class="line"><span class="operator">|</span> event_time  <span class="operator">|</span> <span class="type">timestamp</span>    <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> user_host   <span class="operator">|</span> mediumtext   <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> thread_id   <span class="operator">|</span> <span class="type">bigint</span>(<span class="number">21</span>)   <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> server_id   <span class="operator">|</span> <span class="type">int</span>(<span class="number">10</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="number">0</span>                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> command_type<span class="operator">|</span> <span class="type">varchar</span>(<span class="number">64</span>)  <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>              <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> argument    <span class="operator">|</span> mediumtext   <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------------+------+-----+-------------------+</span></span><br></pre></td></tr></table></figure>

<h2 id="四、使用场景"><a href="#四、使用场景" class="headerlink" title="四、使用场景"></a>四、使用场景</h2><h3 id="4-1-应用调试"><a href="#4-1-应用调试" class="headerlink" title="4.1 应用调试"></a>4.1 应用调试</h3><p><strong>场景</strong>：应用行为异常，需要查看实际执行的 SQL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1. 开启查询日志</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> log_output <span class="operator">=</span> <span class="string">&#x27;TABLE&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2. 复现问题</span></span><br><span class="line"><span class="comment">-- 在应用中执行操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 3. 查看日志</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> event_time <span class="operator">&gt;</span> NOW() <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="number">10</span> <span class="keyword">MINUTE</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 4. 关闭日志</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;OFF&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-SQL-审计"><a href="#4-2-SQL-审计" class="headerlink" title="4.2 SQL 审计"></a>4.2 SQL 审计</h3><p><strong>场景</strong>：记录敏感数据访问</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建审计表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> audit_log (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY KEY</span> AUTO_INCREMENT,</span><br><span class="line">    event_time <span class="type">TIMESTAMP</span>,</span><br><span class="line">    user_name <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    sql_text TEXT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 定期归档查询日志</span></span><br><span class="line"><span class="keyword">INSERT INTO</span> audit_log (event_time, user_name, sql_text)</span><br><span class="line"><span class="keyword">SELECT</span> event_time,</span><br><span class="line">       SUBSTRING_INDEX(user_host, <span class="string">&#x27;[&#x27;</span>, <span class="number">1</span>) <span class="keyword">AS</span> user_name,</span><br><span class="line">       argument <span class="keyword">AS</span> sql_text</span><br><span class="line"><span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> argument <span class="keyword">LIKE</span> <span class="string">&#x27;%users%&#x27;</span>  <span class="comment">-- 敏感表</span></span><br><span class="line">  <span class="keyword">AND</span> event_time <span class="operator">&gt;</span> NOW() <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="number">1</span> <span class="keyword">DAY</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-性能分析"><a href="#4-3-性能分析" class="headerlink" title="4.3 性能分析"></a>4.3 性能分析</h3><p><strong>场景</strong>：分析查询模式和频率</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 统计最频繁执行的 SQL</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    argument,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> exec_count</span><br><span class="line"><span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> command_type <span class="operator">=</span> <span class="string">&#x27;Query&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> argument</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> exec_count <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 统计各类型 SQL 占比</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    command_type,</span><br><span class="line">    <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> cnt,</span><br><span class="line">    ROUND(<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">*</span> <span class="number">100.0</span> <span class="operator">/</span> (<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> mysql.general_log), <span class="number">2</span>) <span class="keyword">AS</span> percentage</span><br><span class="line"><span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> command_type;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-安全监控"><a href="#4-4-安全监控" class="headerlink" title="4.4 安全监控"></a>4.4 安全监控</h3><p><strong>场景</strong>：监控异常访问</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看非本地连接</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> user_host <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;%localhost%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看失败登录（需要配合其他日志）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> argument <span class="keyword">LIKE</span> <span class="string">&#x27;%Access denied%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看 DROP/DELETE 等危险操作</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log</span><br><span class="line"><span class="keyword">WHERE</span> argument <span class="keyword">LIKE</span> <span class="string">&#x27;%DROP%&#x27;</span></span><br><span class="line">   <span class="keyword">OR</span> argument <span class="keyword">LIKE</span> <span class="string">&#x27;%DELETE%&#x27;</span></span><br><span class="line">   <span class="keyword">OR</span> argument <span class="keyword">LIKE</span> <span class="string">&#x27;%TRUNCATE%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<h2 id="五、性能影响和优化"><a href="#五、性能影响和优化" class="headerlink" title="五、性能影响和优化"></a>五、性能影响和优化</h2><h3 id="5-1-性能影响"><a href="#5-1-性能影响" class="headerlink" title="5.1 性能影响"></a>5.1 性能影响</h3><table>
<thead>
<tr>
<th>配置</th>
<th>性能影响</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>关闭</td>
<td>无</td>
<td>默认状态</td>
</tr>
<tr>
<td>FILE 输出</td>
<td>中等</td>
<td>约 10-25% 性能下降</td>
</tr>
<tr>
<td>TABLE 输出</td>
<td>高</td>
<td>约 25-40% 性能下降</td>
</tr>
</tbody></table>
<h3 id="5-2-优化建议"><a href="#5-2-优化建议" class="headerlink" title="5.2 优化建议"></a>5.2 优化建议</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># 生产环境不建议长期开启</span></span><br><span class="line"><span class="comment"># 仅在需要时临时开启</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果必须开启，使用 FILE 输出</span></span><br><span class="line"><span class="attr">log_output</span> = FILE</span><br><span class="line"><span class="attr">general_log_file</span> = /var/log/mysql/general.log</span><br></pre></td></tr></table></figure>

<h3 id="5-3-使用建议"><a href="#5-3-使用建议" class="headerlink" title="5.3 使用建议"></a>5.3 使用建议</h3><table>
<thead>
<tr>
<th>场景</th>
<th>建议</th>
</tr>
</thead>
<tbody><tr>
<td>生产环境</td>
<td>默认关闭，需要时开启</td>
</tr>
<tr>
<td>开发环境</td>
<td>可以开启用于调试</td>
</tr>
<tr>
<td>测试环境</td>
<td>可以开启用于分析</td>
</tr>
<tr>
<td>审计需求</td>
<td>开启并定期归档</td>
</tr>
</tbody></table>
<h2 id="六、日志管理"><a href="#六、日志管理" class="headerlink" title="六、日志管理"></a>六、日志管理</h2><h3 id="6-1-日志轮转"><a href="#6-1-日志轮转" class="headerlink" title="6.1 日志轮转"></a>6.1 日志轮转</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/logrotate.d/mysql-general</span></span><br><span class="line">/var/log/mysql/general.log &#123;</span><br><span class="line">    hourly</span><br><span class="line">    rotate 24</span><br><span class="line">    compress</span><br><span class="line">    delaycompress</span><br><span class="line">    missingok</span><br><span class="line">    notifempty</span><br><span class="line">    create 640 mysql mysql</span><br><span class="line">    postrotate</span><br><span class="line">        /usr/bin/mysqladmin flush-logs &gt; /dev/null 2&gt;&amp;1 || <span class="literal">true</span></span><br><span class="line">    endscript</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-清理日志"><a href="#6-2-清理日志" class="headerlink" title="6.2 清理日志"></a>6.2 清理日志</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 文件方式：刷新日志</span></span><br><span class="line">FLUSH LOGS;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表方式：清空日志</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> mysql.general_log;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除旧日志文件</span></span><br><span class="line">rm <span class="operator">/</span>var<span class="operator">/</span>log<span class="operator">/</span>mysql<span class="operator">/</span>general.log.<span class="operator">*</span></span><br></pre></td></tr></table></figure>

<h3 id="6-3-自动化脚本"><a href="#6-3-自动化脚本" class="headerlink" title="6.3 自动化脚本"></a>6.3 自动化脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># manage_general_log.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查是否开启</span></span><br><span class="line">STATUS=$(mysql -e <span class="string">&quot;SHOW VARIABLES LIKE &#x27;general_log&#x27;;&quot;</span> | grep -c <span class="string">&quot;ON&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$STATUS</span> -eq 1 ]; <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;查询日志已开启，注意性能影响&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查日志文件大小</span></span><br><span class="line">    SIZE=$(<span class="built_in">ls</span> -lh /var/log/mysql/general.log | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;当前日志大小：<span class="variable">$SIZE</span>&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果超过 1GB，提醒清理</span></span><br><span class="line">    SIZE_BYTES=$(<span class="built_in">ls</span> -l /var/log/mysql/general.log | awk <span class="string">&#x27;&#123;print $5&#125;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$SIZE_BYTES</span> -gt 1073741824 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;警告：日志文件超过 1GB&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<h2 id="七、最佳实践"><a href="#七、最佳实践" class="headerlink" title="七、最佳实践"></a>七、最佳实践</h2><h3 id="7-1-配置建议"><a href="#7-1-配置建议" class="headerlink" title="7.1 配置建议"></a>7.1 配置建议</h3><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># 生产环境 - 默认关闭</span></span><br><span class="line"><span class="attr">general_log</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 开发/调试环境 - 开启</span></span><br><span class="line"><span class="comment"># general_log = 1</span></span><br><span class="line"><span class="comment"># general_log_file = /var/log/mysql/general.log</span></span><br><span class="line"><span class="comment"># log_output = FILE</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-使用流程"><a href="#7-2-使用流程" class="headerlink" title="7.2 使用流程"></a>7.2 使用流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 需要时开启：SET GLOBAL general_log = &#x27;ON&#x27;</span><br><span class="line">2. 执行操作：在应用中复现问题</span><br><span class="line">3. 分析日志：SELECT * FROM mysql.general_log</span><br><span class="line">4. 关闭日志：SET GLOBAL general_log = &#x27;OFF&#x27;</span><br><span class="line">5. 清理日志：TRUNCATE TABLE mysql.general_log</span><br></pre></td></tr></table></figure>

<h3 id="7-3-注意事项"><a href="#7-3-注意事项" class="headerlink" title="7.3 注意事项"></a>7.3 注意事项</h3><table>
<thead>
<tr>
<th>注意项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>性能影响</td>
<td>生产环境谨慎开启</td>
</tr>
<tr>
<td>磁盘空间</td>
<td>日志增长快，注意监控</td>
</tr>
<tr>
<td>安全性</td>
<td>日志包含敏感信息</td>
</tr>
<tr>
<td>隐私合规</td>
<td>注意数据保护法规</td>
</tr>
</tbody></table>
<h2 id="八、小结"><a href="#八、小结" class="headerlink" title="八、小结"></a>八、小结</h2><h3 id="核心知识点"><a href="#核心知识点" class="headerlink" title="核心知识点"></a>核心知识点</h3><ol>
<li><strong>查询日志作用</strong>：记录所有客户端请求</li>
<li><strong>输出方式</strong>：FILE（文件）或 TABLE（系统表）</li>
<li><strong>性能影响</strong>：较高，生产环境谨慎开启</li>
<li><strong>使用场景</strong>：调试、审计、分析</li>
</ol>
<h3 id="常用命令速查"><a href="#常用命令速查" class="headerlink" title="常用命令速查"></a>常用命令速查</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 开启/关闭</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> general_log <span class="operator">=</span> <span class="string">&#x27;OFF&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看配置</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;general_log%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看日志（表方式）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.general_log <span class="keyword">ORDER</span> <span class="keyword">BY</span> event_time <span class="keyword">DESC</span> LIMIT <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 刷新日志</span></span><br><span class="line">FLUSH LOGS;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看日志文件</span></span><br><span class="line"><span class="built_in">tail</span> -f /var/log/mysql/general.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索 SQL</span></span><br><span class="line">grep -i <span class="string">&quot;SELECT&quot;</span> /var/log/mysql/general.log</span><br></pre></td></tr></table></figure>

<h3 id="与其他日志对比"><a href="#与其他日志对比" class="headerlink" title="与其他日志对比"></a>与其他日志对比</h3><table>
<thead>
<tr>
<th>日志</th>
<th>记录内容</th>
<th>性能影响</th>
<th>生产建议</th>
</tr>
</thead>
<tbody><tr>
<td>查询日志</td>
<td>所有查询</td>
<td>高</td>
<td>临时开启</td>
</tr>
<tr>
<td>慢查询日志</td>
<td>慢查询</td>
<td>低</td>
<td>定期开启</td>
</tr>
<tr>
<td>错误日志</td>
<td>错误信息</td>
<td>无</td>
<td>始终开启</td>
</tr>
<tr>
<td>二进制日志</td>
<td>数据变更</td>
<td>中</td>
<td>建议开启</td>
</tr>
</tbody></table>
<hr>
<p><strong>下一篇</strong>：[MySQL 运维篇 01-05 慢查询日志](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 运维篇 01-05 慢查询日志&#x2F;)</p>
<p><strong>上一篇</strong>：[MySQL 运维篇 01-03 二进制日志](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 运维篇 01-03 二进制日志&#x2F;)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-04%20%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/">https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-04%20%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%BF%90%E7%BB%B4/">运维</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/">查询日志</a><a class="post-meta__tags" href="/tags/general-log/">general log</a><a class="post-meta__tags" href="/tags/%E5%AE%A1%E8%AE%A1/">审计</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-05%20%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/" title="MySQL 运维篇 01-05 慢查询日志"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">MySQL 运维篇 01-05 慢查询日志</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 01-05 慢查询日志慢查询日志（Slow Query Log）是 MySQL 性能优化的重要工具，用于记录执行时间超过指定阈值的 SQL 语句。通过分析慢查询日志，可以发现和优化性能瓶颈。 一、慢查询日志介绍1.1 什么是慢查询日志？慢查询日志记录执行时间超过指定阈值的 SQL 语句： 12345慢查询日志记录内容：├── 执行时间超过 long_query_time 的 SQL├── 未使用索引的查询（可选）├── 不使用索引的 JOIN（可选）└── 包含：执行时间、锁定时间、发送行数、扫描行数  1.2 慢查询的作用   作用 说明    性能瓶颈定位 找到执行慢的 SQL   索引优化依据 发现需要索引的字段   SQL 优化参考 分析低效的 SQL 写法   性能监控 定期分析性能趋势   1.3 与进阶篇的区别   内容 进阶篇（09-08） 运维篇（01-05）    重点 基础使用和案例 深入配置和分析   开启方法 基础命令 详细参数配置   分析工具 简单介绍 详细使用   实战案例 单个案例 多种场景   二、慢查询日志配置2.1 基本...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-03%20%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97/" title="MySQL 运维篇 01-03 二进制日志"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 运维篇 01-03 二进制日志</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 01-03 二进制日志二进制日志（Binary Log，简称 binlog）是 MySQL 最重要的日志之一，记录了所有修改数据库结构或数据的操作。它是数据恢复和主从复制的基础。 一、二进制日志介绍1.1 什么是二进制日志？二进制日志是 MySQL 服务器层记录的日志，包含以下信息： 12345binlog 记录内容：├── DDL 操作：CREATE、ALTER、DROP 等├── DML 操作：INSERT、UPDATE、DELETE 等├── 事务控制：BEGIN、COMMIT、ROLLBACK└── 不记录：SELECT、SHOW 等查询操作  1.2 binlog 的作用   作用 说明    数据恢复 误删数据时，通过 binlog 恢复   主从复制 从库读取主库 binlog 并重放   审计追踪 记录所有数据变更历史   增量备份 配合全量备份实现增量恢复   1.3 binlog 格式MySQL 支持三种 binlog 格式：    格式 说明 优点 缺点    STATEMENT 记录原始 SQL 日志量小 某些函数无法复制   ROW ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-01%20%E6%97%A5%E5%BF%97%E8%AF%A6%E8%A7%A3%E8%AF%BE%E7%A8%8B%E4%BB%8B%E7%BB%8D/" title="MySQL 运维篇 01-01 日志详解课程介绍"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 01-01 日志详解课程介绍</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 01-01 日志详解课程介绍日志是 MySQL 数据库运维的核心工具，用于记录数据库运行过程中的各种事件。本篇将详细介绍 MySQL 的四大日志系统：错误日志、二进制日志、查询日志和慢查询日志。 一、日志系统概述1.1 为什么需要日志？123456日志的作用：├── 故障排查：记录错误信息，定位问题根源├── 数据恢复：通过 binlog 恢复误删数据├── 性能分析：慢查询日志帮助优化 SQL├── 审计追踪：记录用户操作历史└── 主从复制：binlog 是复制的基础  1.2 MySQL 四大日志   日志类型 记录内容 默认开启 用途    错误日志（Error Log） 系统运行时的错误、警告 是 故障诊断   二进制日志（Binlog） 所有修改数据的操作 否 恢复、复制、审计   查询日志（General Log） 所有客户端请求 否 调试、审计   慢查询日志（Slow Query Log） 执行超过阈值的 SQL 否 性能优化   1.3 日志选择建议   场景 推荐日志 生产环境建议    日常监控 错误日志 始终开启   数据恢复 二进制...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-02%20%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97/" title="MySQL 运维篇 01-02 错误日志"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 01-02 错误日志</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 01-02 错误日志错误日志（Error Log）是 MySQL 最重要的日志，记录了数据库启动、运行和停止过程中的错误、警告和提示信息。它是故障排查的首选工具。 一、错误日志介绍1.1 什么是错误日志？错误日志记录 MySQL 服务器运行过程中遇到的各种错误和异常情况： 1234567错误日志记录内容：├── 服务器启动/停止信息├── 严重错误（如表损坏、磁盘满）├── 警告信息（如配置问题）├── 连接错误（如认证失败）├── 复制错误└── InnoDB 引擎错误  1.2 错误级别   级别 说明 示例    ERROR 严重错误，需要立即处理 磁盘满、表损坏   WARNING 警告，可能影响运行 配置参数不推荐   NOTE 提示信息，一般无需处理 正常启动信息   1.3 错误日志格式12345678# MySQL 5.7 格式2024-02-24T10:30:45.123456Z 0 [ERROR] InnoDB: Unable to lock ./ibdata1 error: 11# MySQL 8.0 格式（组件化）2024-02-24T...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2007-01%20%E7%B4%A2%E5%BC%95%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 07-01 索引详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 进阶教程 07-01 索引详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 07-01 索引详解索引是数据库性能优化的核心技术。本文将详细介绍索引的概念、数据结构、分类、创建和使用方法，以及如何使用 EXPLAIN 分析查询性能。 一、索引概述1.1 什么是索引？索引（Index） 是帮助数据库高效获取数据的数据结构。类似于书籍的目录，通过索引可以快速定位到目标数据，而无需扫描整个表。 1234567无索引查询（全表扫描）：数据：[A][B][C][D][E][F][G]...[Z]查找 M：需要遍历 13 次有索引查询：索引：A→1, B→2, C→3, ..., M→13, ..., Z→26查找 M：直接定位，1 次找到  1.2 索引的优缺点优点：  大幅提高查询速度（最主要目的） 加速表连接（JOIN）操作 加速 ORDER BY 和 GROUP BY 实现唯一性约束  缺点：  占用额外存储空间 降低 INSERT、UPDATE、DELETE 速度（需要同时更新索引） 创建和维护需要时间  1.3 索引使用场景   场景 说明    主键&#x2F;外键列 自动创建索引   WHERE 条件列 经常作为查询条件的列   ...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-03%20MyCat%20%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3/" title="MySQL 运维篇 04-03 MyCat 配置详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 04-03 MyCat 配置详解</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 04-03 MyCat 配置详解本文将详细讲解 MyCat 的各个配置文件，包括 server.yml、schema.yml、datasource.yml 和 rule.yml 的完整配置说明。 一、配置文件概述1.1 配置文件位置1234567/opt/mycat/conf/├── server.yml         # 主配置文件├── schema.yml         # Schema 配置├── datasource.yml     # 数据源配置├── rule.yml           # 分片规则配置├── sequence.yml       # 全局序列配置└── log4j2.xml         # 日志配置  1.2 配置加载顺序12341. server.yml (系统配置)2. datasource.yml (数据源)3. schema.yml (Schema 和表)4. rule.yml (分片规则)  二、server.yml 详解2.1 完整配置示例1234567891011121314151617181920212...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-06%20MyCat%20%E6%B0%B4%E5%B9%B3%E5%88%86%E8%A1%A8/" title="MySQL 运维篇 04-06 MyCat 水平分表"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 04-06 MyCat 水平分表</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 04-06 MyCat 水平分表水平分表是将一个大表的数据按照某种规则分布到多个表中。本文将介绍如何使用 MyCat 实现水平分表。 一、水平分表介绍1.1 什么是水平分表水平分表：将同一个表的数据按照行拆分到多个物理表中。 12345678原始表：orders (1 亿条数据)水平分表后：orders_0000 (250 万条)orders_0001 (250 万条)orders_0002 (250 万条)orders_0003 (250 万条)  1.2 适用场景   场景 说明    单表数据量大 超过 1000 万行   查询性能下降 索引效率低   维护困难 DDL 操作耗时过长   1.3 分片规则   规则 说明 适用场景    取模 id % 分片数 均匀分布   范围 按 ID 或日期范围 历史数据归档   哈希 hash(key) % 分片数 随机分布   二、环境准备2.1 数据库规划12345order_db├── orders_0000├── orders_0001├── orders_0002└── orders_0003  2.2...</div></div></div></a><a class="pagination-related" href="/2026/02/23/MySQL%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89DML%20%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C%E8%AF%AD%E8%A8%80%E8%AF%A6%E8%A7%A3/" title="MySQL 基础教程（三）DML 数据操作语言详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-23</div><div class="info-item-2">MySQL 基础教程（三）DML 数据操作语言详解</div></div><div class="info-2"><div class="info-item-1">MySQL 基础教程（三）DML 数据操作语言详解在上一篇文章中，我们学习了如何使用 DDL 创建和管理数据库表结构。本文我们将学习 DML（Data Manipulation Language）数据操作语言，掌握如何对表中的数据进行插入、更新和删除操作。 一、DML 概述DML 用于对数据库表中的数据进行操作，主要包括：    命令 功能 特点    INSERT 插入数据 添加新记录   UPDATE 更新数据 修改现有记录   DELETE 删除数据 删除符合条件的记录   TRUNCATE 清空表 删除全部记录并重置自增   DML 的特点：  操作的是数据内容，不影响表结构 在事务中可回滚（需要关闭自动提交） 可以配合 WHERE 子句进行条件操作  二、插入数据（INSERT）2.1 基础插入语法123-- 语法INSERT INTO 表名 (列 1, 列 2, ..., 列 n)VALUES (值 1, 值 2, ..., 值 n);  2.2 插入单条记录首先创建测试表： 123456789-- 创建测试表CREATE TABLE employees (    i...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-%E8%BF%90%E7%BB%B4%E7%AF%87-01-04-%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">1.</span> <span class="toc-text">MySQL 运维篇 01-04 查询日志</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">一、查询日志介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 什么是查询日志？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97-vs-%E5%85%B6%E4%BB%96%E6%97%A5%E5%BF%97"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 查询日志 vs 其他日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 使用场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">二、查询日志配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 基本配置参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 配置参数详解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%8A%A8%E6%80%81%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 动态配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E8%BE%93%E5%87%BA%E5%88%B0%E8%A1%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 输出到表配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%9F%A5%E7%9C%8B%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">1.3.</span> <span class="toc-text">三、查看查询日志</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%9F%A5%E7%9C%8B%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 查看配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%96%87%E4%BB%B6%E6%96%B9%E5%BC%8F%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 文件方式查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E8%A1%A8%E6%96%B9%E5%BC%8F%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 表方式查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.4.</span> <span class="toc-text">3.4 查询日志格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.4.</span> <span class="toc-text">四、使用场景</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%BA%94%E7%94%A8%E8%B0%83%E8%AF%95"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 应用调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-SQL-%E5%AE%A1%E8%AE%A1"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 SQL 审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 性能分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E5%AE%89%E5%85%A8%E7%9B%91%E6%8E%A7"><span class="toc-number">1.4.4.</span> <span class="toc-text">4.4 安全监控</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%80%A7%E8%83%BD%E5%BD%B1%E5%93%8D%E5%92%8C%E4%BC%98%E5%8C%96"><span class="toc-number">1.5.</span> <span class="toc-text">五、性能影响和优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E6%80%A7%E8%83%BD%E5%BD%B1%E5%93%8D"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 性能影响</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 优化建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 使用建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86"><span class="toc-number">1.6.</span> <span class="toc-text">六、日志管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E6%97%A5%E5%BF%97%E8%BD%AE%E8%BD%AC"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 日志轮转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E6%B8%85%E7%90%86%E6%97%A5%E5%BF%97"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 清理日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E8%87%AA%E5%8A%A8%E5%8C%96%E8%84%9A%E6%9C%AC"><span class="toc-number">1.6.3.</span> <span class="toc-text">6.3 自动化脚本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.7.</span> <span class="toc-text">七、最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E9%85%8D%E7%BD%AE%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 配置建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E4%BD%BF%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 使用流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.8.</span> <span class="toc-text">八、小结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.8.1.</span> <span class="toc-text">核心知识点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">1.8.2.</span> <span class="toc-text">常用命令速查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E5%85%B6%E4%BB%96%E6%97%A5%E5%BF%97%E5%AF%B9%E6%AF%94"><span class="toc-number">1.8.3.</span> <span class="toc-text">与其他日志对比</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%A6%E8%A7%A3%20-%20%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E3%80%81%E6%95%B0%E6%8D%AE%E5%88%86%E5%B1%82%E4%B8%8E%20SCD%20%E5%A4%84%E7%90%86/" title="数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理">数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-10%20MyCat%20%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7/" title="MySQL 运维篇 04-10 MyCat 管理与监控">MySQL 运维篇 04-10 MyCat 管理与监控</a><time datetime="2026-02-24T12:05:00.000Z" title="发表于 2026-02-24 20:05:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>