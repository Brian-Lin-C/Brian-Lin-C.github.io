<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Python 常用库（二）json/yaml 配置文件处理 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Python 常用库（二）json&#x2F;yaml 配置文件处理配置文件是项目中不可或缺的部分。本篇将介绍如何使用 json 和 yaml 格式进行配置管理。 一、JSON 基础1.1 JSON 简介JSON（JavaScript Object Notation） 是一种轻量级的数据交换格式，易于人阅读和编写，也易于机器解析和生成。 JSON 支持的数据类型：  字符串（string） 数字（">
<meta property="og:type" content="article">
<meta property="og:title" content="Python 常用库（二）json&#x2F;yaml 配置文件处理">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89json%20yaml%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="Python 常用库（二）json&#x2F;yaml 配置文件处理配置文件是项目中不可或缺的部分。本篇将介绍如何使用 json 和 yaml 格式进行配置管理。 一、JSON 基础1.1 JSON 简介JSON（JavaScript Object Notation） 是一种轻量级的数据交换格式，易于人阅读和编写，也易于机器解析和生成。 JSON 支持的数据类型：  字符串（string） 数字（">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T10:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T03:46:40.460Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="json">
<meta property="article:tag" content="yaml">
<meta property="article:tag" content="配置文件">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Python 常用库（二）json/yaml 配置文件处理",
  "url": "https://brian-lin-c.github.io/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89json%20yaml%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T10:00:00.000Z",
  "dateModified": "2026-02-24T03:46:40.460Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89json%20yaml%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python 常用库（二）json/yaml 配置文件处理',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">Python 常用库（二）json/yaml 配置文件处理</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Python 常用库（二）json/yaml 配置文件处理</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T10:00:00.000Z" title="发表于 2026-02-24 18:00:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T03:46:40.460Z" title="更新于 2026-02-24 11:46:40">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python-%E6%95%99%E7%A8%8B/">Python 教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Python-常用库（二）json-yaml-配置文件处理"><a href="#Python-常用库（二）json-yaml-配置文件处理" class="headerlink" title="Python 常用库（二）json&#x2F;yaml 配置文件处理"></a>Python 常用库（二）json&#x2F;yaml 配置文件处理</h1><p>配置文件是项目中不可或缺的部分。本篇将介绍如何使用 json 和 yaml 格式进行配置管理。</p>
<h2 id="一、JSON-基础"><a href="#一、JSON-基础" class="headerlink" title="一、JSON 基础"></a>一、JSON 基础</h2><h3 id="1-1-JSON-简介"><a href="#1-1-JSON-简介" class="headerlink" title="1.1 JSON 简介"></a>1.1 JSON 简介</h3><p><strong>JSON（JavaScript Object Notation）</strong> 是一种轻量级的数据交换格式，易于人阅读和编写，也易于机器解析和生成。</p>
<p><strong>JSON 支持的数据类型：</strong></p>
<ul>
<li>字符串（string）</li>
<li>数字（number）</li>
<li>布尔值（boolean）</li>
<li>null</li>
<li>数组（array）</li>
<li>对象（object）</li>
</ul>
<h3 id="1-2-JSON-与-Python-类型对应"><a href="#1-2-JSON-与-Python-类型对应" class="headerlink" title="1.2 JSON 与 Python 类型对应"></a>1.2 JSON 与 Python 类型对应</h3><table>
<thead>
<tr>
<th>JSON</th>
<th>Python</th>
</tr>
</thead>
<tbody><tr>
<td>object</td>
<td>dict</td>
</tr>
<tr>
<td>array</td>
<td>list</td>
</tr>
<tr>
<td>string</td>
<td>str</td>
</tr>
<tr>
<td>number (int)</td>
<td>int</td>
</tr>
<tr>
<td>number (float)</td>
<td>float</td>
</tr>
<tr>
<td>true</td>
<td>True</td>
</tr>
<tr>
<td>false</td>
<td>False</td>
</tr>
<tr>
<td>null</td>
<td>None</td>
</tr>
</tbody></table>
<h2 id="二、json-模块使用"><a href="#二、json-模块使用" class="headerlink" title="二、json 模块使用"></a>二、json 模块使用</h2><h3 id="2-1-序列化与反序列化"><a href="#2-1-序列化与反序列化" class="headerlink" title="2.1 序列化与反序列化"></a>2.1 序列化与反序列化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python 对象</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">25</span>,</span><br><span class="line">    <span class="string">&#x27;is_student&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">&#x27;skills&#x27;</span>: [<span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Go&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;address&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;北京&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;district&#x27;</span>: <span class="string">&#x27;海淀区&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;salary&#x27;</span>: <span class="literal">None</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 序列化：Python -&gt; JSON 字符串</span></span><br><span class="line">json_str = json.dumps(data)</span><br><span class="line"><span class="built_in">print</span>(json_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 带格式的 JSON 字符串</span></span><br><span class="line">json_str = json.dumps(data, indent=<span class="number">2</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(json_str)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  &quot;name&quot;: &quot;张三&quot;,</span></span><br><span class="line"><span class="string">  &quot;age&quot;: 25,</span></span><br><span class="line"><span class="string">  &quot;is_student&quot;: false,</span></span><br><span class="line"><span class="string">  &quot;skills&quot;: [</span></span><br><span class="line"><span class="string">    &quot;Python&quot;,</span></span><br><span class="line"><span class="string">    &quot;Java&quot;,</span></span><br><span class="line"><span class="string">    &quot;Go&quot;</span></span><br><span class="line"><span class="string">  ],</span></span><br><span class="line"><span class="string">  &quot;address&quot;: &#123;</span></span><br><span class="line"><span class="string">    &quot;city&quot;: &quot;北京&quot;,</span></span><br><span class="line"><span class="string">    &quot;district&quot;: &quot;海淀区&quot;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  &quot;salary&quot;: null</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 反序列化：JSON 字符串 -&gt; Python 对象</span></span><br><span class="line">data = json.loads(json_str)</span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&#x27;name&#x27;</span>])  <span class="comment"># 张三</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - indent 控制缩进，让 JSON 更可读</span></span><br><span class="line"><span class="comment"># - ensure_ascii=False 保留中文字符</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-文件读写"><a href="#2-2-文件读写" class="headerlink" title="2.2 文件读写"></a>2.2 文件读写</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入 JSON 文件</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">25</span>,</span><br><span class="line">    <span class="string">&#x27;skills&#x27;</span>: [<span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.json&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    json.dump(data, f, indent=<span class="number">2</span>, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 JSON 文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.json&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - json.dump() 写入文件</span></span><br><span class="line"><span class="comment"># - json.load() 从文件读取</span></span><br><span class="line"><span class="comment"># - json.dumps() 转为字符串（s = string）</span></span><br><span class="line"><span class="comment"># - json.loads() 从字符串读取</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-自定义序列化"><a href="#2-3-自定义序列化" class="headerlink" title="2.3 自定义序列化"></a>2.3 自定义序列化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义类型无法直接序列化</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line">person = Person(<span class="string">&#x27;张三&#x27;</span>, <span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式一：使用 default 参数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">default_handler</span>(<span class="params">obj</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(obj, <span class="string">&#x27;__dict__&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> obj.__dict__</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, datetime):</span><br><span class="line">        <span class="keyword">return</span> obj.isoformat()</span><br><span class="line">    <span class="keyword">raise</span> TypeError(<span class="string">f&quot;Type <span class="subst">&#123;<span class="built_in">type</span>(obj)&#125;</span> not serializable&quot;</span>)</span><br><span class="line"></span><br><span class="line">json_str = json.dumps(person, default=default_handler, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二：使用 JSONEncoder</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomEncoder</span>(json.JSONEncoder):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">default</span>(<span class="params">self, obj</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, Person):</span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;name&#x27;</span>: obj.name, <span class="string">&#x27;age&#x27;</span>: obj.age, <span class="string">&#x27;__type__&#x27;</span>: <span class="string">&#x27;Person&#x27;</span>&#125;</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, datetime):</span><br><span class="line">            <span class="keyword">return</span> obj.isoformat()</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().default(obj)</span><br><span class="line"></span><br><span class="line">json_str = json.dumps(person, cls=CustomEncoder, ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式三：实现 to_dict 方法</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">to_dict</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;name&#x27;</span>: <span class="variable language_">self</span>.name, <span class="string">&#x27;age&#x27;</span>: <span class="variable language_">self</span>.age&#125;</span><br><span class="line"></span><br><span class="line">person = Person(<span class="string">&#x27;张三&#x27;</span>, <span class="number">25</span>)</span><br><span class="line">json_str = json.dumps(person.to_dict(), ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - default 参数处理无法序列化的对象</span></span><br><span class="line"><span class="comment"># - 自定义 Encoder 更灵活</span></span><br><span class="line"><span class="comment"># - 最简单的方式是自己实现 to_dict()</span></span><br></pre></td></tr></table></figure>

<h3 id="2-4-自定义反序列化"><a href="#2-4-自定义反序列化" class="headerlink" title="2.4 自定义反序列化"></a>2.4 自定义反序列化</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复自定义类型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">object_hook</span>(<span class="params">d</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;__type__&#x27;</span> <span class="keyword">in</span> d:</span><br><span class="line">        <span class="keyword">if</span> d[<span class="string">&#x27;__type__&#x27;</span>] == <span class="string">&#x27;Person&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> Person(d[<span class="string">&#x27;name&#x27;</span>], d[<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line">json_str = <span class="string">&#x27;&#123;&quot;name&quot;: &quot;张三&quot;, &quot;age&quot;: 25, &quot;__type__&quot;: &quot;Person&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">person = json.loads(json_str, object_hook=object_hook)</span><br><span class="line"><span class="built_in">print</span>(person.name)  <span class="comment"># 张三</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(person))  <span class="comment"># &lt;class &#x27;__main__.Person&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="三、YAML-基础"><a href="#三、YAML-基础" class="headerlink" title="三、YAML 基础"></a>三、YAML 基础</h2><h3 id="3-1-YAML-简介"><a href="#3-1-YAML-简介" class="headerlink" title="3.1 YAML 简介"></a>3.1 YAML 简介</h3><p><strong>YAML（YAML Ain’t a Markup Language）</strong> 是一种人类可读的数据序列化格式，特别适合配置文件。</p>
<p><strong>YAML 特点：</strong></p>
<ul>
<li>使用缩进表示层级（类似 Python）</li>
<li>支持注释（# 开头）</li>
<li>语法简洁，可读性好</li>
</ul>
<h3 id="3-2-YAML-语法"><a href="#3-2-YAML-语法" class="headerlink" title="3.2 YAML 语法"></a>3.2 YAML 语法</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本数据类型</span></span><br><span class="line"><span class="attr">string:</span> <span class="string">hello</span></span><br><span class="line"><span class="attr">number:</span> <span class="number">42</span></span><br><span class="line"><span class="attr">float:</span> <span class="number">3.14</span></span><br><span class="line"><span class="attr">boolean:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">null_value:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">another_null:</span> <span class="string">~</span>  <span class="comment"># YAML 特有的 null 表示法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串</span></span><br><span class="line"><span class="attr">plain:</span> <span class="string">普通字符串</span></span><br><span class="line"><span class="attr">quoted:</span> <span class="string">&quot;带引号的字符串&quot;</span></span><br><span class="line"><span class="attr">with_newline:</span> <span class="string">|</span></span><br><span class="line"><span class="string">  这是多行字符串</span></span><br><span class="line"><span class="string">  第二行</span></span><br><span class="line"><span class="string">  第三行</span></span><br><span class="line"><span class="string"></span><span class="attr">folded:</span> <span class="string">&gt;</span></span><br><span class="line"><span class="string">  这是折叠的多行字符串</span></span><br><span class="line"><span class="string">  会被合并成一行</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="comment"># 列表/数组</span></span><br><span class="line"><span class="attr">fruits:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">apple</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">banana</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">orange</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 行内列表</span></span><br><span class="line"><span class="attr">colors:</span> [<span class="string">red</span>, <span class="string">green</span>, <span class="string">blue</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典/对象</span></span><br><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">张三</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">25</span></span><br><span class="line">  <span class="attr">city:</span> <span class="string">北京</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 行内字典</span></span><br><span class="line"><span class="attr">point:</span> &#123;<span class="attr">x:</span> <span class="number">10</span>, <span class="attr">y:</span> <span class="number">20</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 嵌套结构</span></span><br><span class="line"><span class="attr">company:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">ABC</span> <span class="string">公司</span></span><br><span class="line">  <span class="attr">employees:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">张三</span></span><br><span class="line">      <span class="attr">role:</span> <span class="string">开发</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">李四</span></span><br><span class="line">      <span class="attr">role:</span> <span class="string">测试</span></span><br><span class="line">  <span class="attr">departments:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">技术部</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">产品部</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 锚点和引用（YAML 高级特性）</span></span><br><span class="line"><span class="attr">defaults:</span> <span class="meta">&amp;defaults</span></span><br><span class="line">  <span class="attr">adapter:</span> <span class="string">postgres</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line"></span><br><span class="line"><span class="attr">development:</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">dev_db</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="string">*defaults</span>  <span class="comment"># 合并引用</span></span><br><span class="line"></span><br><span class="line"><span class="attr">production:</span></span><br><span class="line">  <span class="attr">database:</span> <span class="string">prod_db</span></span><br><span class="line">  <span class="string">&lt;&lt;:</span> <span class="meta">*defaults</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">production.example.com</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-安装-PyYAML"><a href="#3-3-安装-PyYAML" class="headerlink" title="3.3 安装 PyYAML"></a>3.3 安装 PyYAML</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyyaml</span><br></pre></td></tr></table></figure>

<h2 id="四、yaml-模块使用"><a href="#四、yaml-模块使用" class="headerlink" title="四、yaml 模块使用"></a>四、yaml 模块使用</h2><h3 id="4-1-读取-YAML"><a href="#4-1-读取-YAML" class="headerlink" title="4.1 读取 YAML"></a>4.1 读取 YAML</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># YAML 字符串</span></span><br><span class="line">yaml_str = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">name: 张三</span></span><br><span class="line"><span class="string">age: 25</span></span><br><span class="line"><span class="string">skills:</span></span><br><span class="line"><span class="string">  - Python</span></span><br><span class="line"><span class="string">  - Java</span></span><br><span class="line"><span class="string">address:</span></span><br><span class="line"><span class="string">  city: 北京</span></span><br><span class="line"><span class="string">  district: 海淀区</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 反序列化：YAML 字符串 -&gt; Python 对象</span></span><br><span class="line">data = yaml.safe_load(yaml_str)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># &#123;&#x27;name&#x27;: &#x27;张三&#x27;, &#x27;age&#x27;: 25, &#x27;skills&#x27;: [&#x27;Python&#x27;, &#x27;Java&#x27;], &#x27;address&#x27;: &#123;&#x27;city&#x27;: &#x27;北京&#x27;, &#x27;district&#x27;: &#x27;海淀区&#x27;&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 YAML 文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;config.yaml&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = yaml.safe_load(f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取多个文档（一个文件包含多个 YAML 文档）</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;multi.yaml&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    docs = yaml.safe_load_all(f)</span><br><span class="line">    <span class="keyword">for</span> doc <span class="keyword">in</span> docs:</span><br><span class="line">        <span class="built_in">print</span>(doc)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - 始终使用 safe_load() 而不是 load()</span></span><br><span class="line"><span class="comment"># - load() 会执行任意 Python 对象，有安全风险</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-写入-YAML"><a href="#4-2-写入-YAML" class="headerlink" title="4.2 写入 YAML"></a>4.2 写入 YAML</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">25</span>,</span><br><span class="line">    <span class="string">&#x27;skills&#x27;</span>: [<span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Go&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;address&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;city&#x27;</span>: <span class="string">&#x27;北京&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;district&#x27;</span>: <span class="string">&#x27;海淀区&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;is_student&#x27;</span>: <span class="literal">False</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.yaml&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    yaml.dump(data, f, allow_unicode=<span class="literal">True</span>, default_flow_style=<span class="literal">False</span>, sort_keys=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">输出：</span></span><br><span class="line"><span class="string">name: 张三</span></span><br><span class="line"><span class="string">age: 25</span></span><br><span class="line"><span class="string">skills:</span></span><br><span class="line"><span class="string">- Python</span></span><br><span class="line"><span class="string">- Java</span></span><br><span class="line"><span class="string">- Go</span></span><br><span class="line"><span class="string">address:</span></span><br><span class="line"><span class="string">  city: 北京</span></span><br><span class="line"><span class="string">  district: 海淀区</span></span><br><span class="line"><span class="string">is_student: false</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 序列化为字符串</span></span><br><span class="line">yaml_str = yaml.dump(data, allow_unicode=<span class="literal">True</span>, default_flow_style=<span class="literal">False</span>, sort_keys=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明：</span></span><br><span class="line"><span class="comment"># - allow_unicode=True: 保留中文</span></span><br><span class="line"><span class="comment"># - default_flow_style=False: 使用块式风格（更易读）</span></span><br><span class="line"><span class="comment"># - sort_keys=False: 不排序键（保持插入顺序）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提醒自己：</span></span><br><span class="line"><span class="comment"># - Python 3.7+ 字典保持插入顺序</span></span><br><span class="line"><span class="comment"># - sort_keys=False 保持这个特性</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-自定义类型处理"><a href="#4-3-自定义类型处理" class="headerlink" title="4.3 自定义类型处理"></a>4.3 自定义类型处理</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.age = age</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义序列化</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">represent_person</span>(<span class="params">dumper, person</span>):</span><br><span class="line">    <span class="keyword">return</span> dumper.represent_mapping(<span class="string">&#x27;tag:yaml.org,2002:map&#x27;</span>, &#123;</span><br><span class="line">        <span class="string">&#x27;__type__&#x27;</span>: <span class="string">&#x27;Person&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: person.name,</span><br><span class="line">        <span class="string">&#x27;age&#x27;</span>: person.age</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">yaml.add_representer(Person, represent_person)</span><br><span class="line"></span><br><span class="line">person = Person(<span class="string">&#x27;张三&#x27;</span>, <span class="number">25</span>)</span><br><span class="line">yaml_str = yaml.dump(person, allow_unicode=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义反序列化</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">construct_person</span>(<span class="params">loader, node</span>):</span><br><span class="line">    data = loader.construct_mapping(node)</span><br><span class="line">    <span class="keyword">return</span> Person(data[<span class="string">&#x27;name&#x27;</span>], data[<span class="string">&#x27;age&#x27;</span>])</span><br><span class="line"></span><br><span class="line">yaml.add_constructor(<span class="string">&#x27;tag:yaml.org,2002:map&#x27;</span>, construct_person)</span><br><span class="line"></span><br><span class="line">data = yaml.safe_load(yaml_str)</span><br></pre></td></tr></table></figure>

<h2 id="五、配置文件管理实践"><a href="#五、配置文件管理实践" class="headerlink" title="五、配置文件管理实践"></a>五、配置文件管理实践</h2><h3 id="5-1-配置文件示例"><a href="#5-1-配置文件示例" class="headerlink" title="5.1 配置文件示例"></a>5.1 配置文件示例</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.yaml</span></span><br><span class="line"><span class="comment"># 应用配置</span></span><br><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">我的应用</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库配置</span></span><br><span class="line"><span class="attr">database:</span></span><br><span class="line">  <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mydb</span></span><br><span class="line">  <span class="attr">user:</span> <span class="string">admin</span></span><br><span class="line">  <span class="attr">password:</span> <span class="string">$&#123;DB_PASSWORD&#125;</span>  <span class="comment"># 环境变量引用</span></span><br><span class="line">  <span class="attr">pool_size:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 日志配置</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span> <span class="string">INFO</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">&quot;%(asctime)s - %(name)s - %(levelname)s - %(message)s&quot;</span></span><br><span class="line">  <span class="attr">file:</span> <span class="string">logs/app.log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># API 配置</span></span><br><span class="line"><span class="attr">api:</span></span><br><span class="line">  <span class="attr">base_url:</span> <span class="string">https://api.example.com</span></span><br><span class="line">  <span class="attr">timeout:</span> <span class="number">30</span></span><br><span class="line">  <span class="attr">retry:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">users:</span> <span class="string">/users</span></span><br><span class="line">    <span class="attr">posts:</span> <span class="string">/posts</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="string">/comments</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 功能开关</span></span><br><span class="line"><span class="attr">features:</span></span><br><span class="line">  <span class="attr">enable_cache:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_auth:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">enable_rate_limit:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-配置加载类"><a href="#5-2-配置加载类" class="headerlink" title="5.2 配置加载类"></a>5.2 配置加载类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Any</span>, <span class="type">Dict</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Config</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;配置文件管理器&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, config_path: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.config_path = Path(config_path)</span><br><span class="line">        <span class="variable language_">self</span>._config: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="type">Any</span>] = &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加载配置文件&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.config_path.exists():</span><br><span class="line">            <span class="keyword">raise</span> FileNotFoundError(<span class="string">f&quot;配置文件不存在：<span class="subst">&#123;self.config_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        suffix = <span class="variable language_">self</span>.config_path.suffix.lower()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="variable language_">self</span>.config_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">if</span> suffix <span class="keyword">in</span> [<span class="string">&#x27;.yaml&#x27;</span>, <span class="string">&#x27;.yml&#x27;</span>]:</span><br><span class="line">                <span class="variable language_">self</span>._config = yaml.safe_load(f)</span><br><span class="line">            <span class="keyword">elif</span> suffix == <span class="string">&#x27;.json&#x27;</span>:</span><br><span class="line">                <span class="variable language_">self</span>._config = json.load(f)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的配置格式：<span class="subst">&#123;suffix&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理环境变量引用 $&#123;VAR_NAME&#125;</span></span><br><span class="line">        <span class="variable language_">self</span>._config = <span class="variable language_">self</span>._expand_env(<span class="variable language_">self</span>._config)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_expand_env</span>(<span class="params">self, obj: <span class="type">Any</span></span>) -&gt; <span class="type">Any</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;递归展开环境变量引用&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">str</span>):</span><br><span class="line">            <span class="comment"># 替换 $&#123;VAR_NAME&#125; 格式</span></span><br><span class="line">            <span class="keyword">import</span> re</span><br><span class="line">            pattern = <span class="string">r&#x27;\$\&#123;(\w+)\&#125;&#x27;</span></span><br><span class="line">            matches = re.findall(pattern, obj)</span><br><span class="line">            <span class="keyword">for</span> var_name <span class="keyword">in</span> matches:</span><br><span class="line">                env_value = os.environ.get(var_name, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                obj = obj.replace(<span class="string">f&#x27;$&#123;&#123;<span class="subst">&#123;var_name&#125;</span>&#125;&#125;&#x27;</span>, env_value)</span><br><span class="line">            <span class="keyword">return</span> obj</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">dict</span>):</span><br><span class="line">            <span class="keyword">return</span> &#123;k: <span class="variable language_">self</span>._expand_env(v) <span class="keyword">for</span> k, v <span class="keyword">in</span> obj.items()&#125;</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">list</span>):</span><br><span class="line">            <span class="keyword">return</span> [<span class="variable language_">self</span>._expand_env(item) <span class="keyword">for</span> item <span class="keyword">in</span> obj]</span><br><span class="line">        <span class="keyword">return</span> obj</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, key: <span class="built_in">str</span>, default: <span class="type">Any</span> = <span class="literal">None</span></span>) -&gt; <span class="type">Any</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;获取配置值&quot;&quot;&quot;</span></span><br><span class="line">        keys = key.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        value = <span class="variable language_">self</span>._config</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> keys:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>) <span class="keyword">and</span> k <span class="keyword">in</span> value:</span><br><span class="line">                value = value[k]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> default</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key: <span class="built_in">str</span></span>) -&gt; <span class="type">Any</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.get(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Config(<span class="subst">&#123;self._config&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line">config = Config(<span class="string">&#x27;config.yaml&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取配置</span></span><br><span class="line">app_name = config.get(<span class="string">&#x27;app.name&#x27;</span>)</span><br><span class="line">db_host = config.get(<span class="string">&#x27;database.host&#x27;</span>)</span><br><span class="line">api_timeout = config.get(<span class="string">&#x27;api.timeout&#x27;</span>, <span class="number">30</span>)  <span class="comment"># 带默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 链式访问</span></span><br><span class="line">db_config = config.get(<span class="string">&#x27;database&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(db_config[<span class="string">&#x27;host&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">db_host = config[<span class="string">&#x27;database.host&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="5-3-多环境配置"><a href="#5-3-多环境配置" class="headerlink" title="5.3 多环境配置"></a>5.3 多环境配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.yaml</span></span><br><span class="line"><span class="comment"># 公共配置</span></span><br><span class="line"><span class="attr">common:</span></span><br><span class="line">  <span class="attr">app_name:</span> <span class="string">我的应用</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">1.0</span><span class="number">.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 开发环境</span></span><br><span class="line"><span class="attr">development:</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">database:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">localhost</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dev_db</span></span><br><span class="line">  <span class="attr">logging:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="string">DEBUG</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试环境</span></span><br><span class="line"><span class="attr">testing:</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">database:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">test-db.example.com</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">test_db</span></span><br><span class="line">  <span class="attr">logging:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="string">INFO</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生产环境</span></span><br><span class="line"><span class="attr">production:</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">database:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">prod-db.example.com</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">prod_db</span></span><br><span class="line">  <span class="attr">logging:</span></span><br><span class="line">    <span class="attr">level:</span> <span class="string">WARNING</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MultiEnvConfig</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;多环境配置管理&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, config_path: <span class="built_in">str</span>, env: <span class="built_in">str</span> = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.env = env <span class="keyword">or</span> os.environ.get(<span class="string">&#x27;APP_ENV&#x27;</span>, <span class="string">&#x27;development&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.config_path = Path(config_path)</span><br><span class="line">        <span class="variable language_">self</span>._config = &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.load()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="variable language_">self</span>.config_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            full_config = yaml.safe_load(f)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 合并公共配置和环境配置</span></span><br><span class="line">        common = full_config.get(<span class="string">&#x27;common&#x27;</span>, &#123;&#125;)</span><br><span class="line">        env_config = full_config.get(<span class="variable language_">self</span>.env, &#123;&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>._config = <span class="variable language_">self</span>._deep_merge(common, env_config)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_deep_merge</span>(<span class="params">self, base: <span class="built_in">dict</span>, override: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;深度合并字典&quot;&quot;&quot;</span></span><br><span class="line">        result = base.copy()</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> override.items():</span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> result <span class="keyword">and</span> <span class="built_in">isinstance</span>(result[key], <span class="built_in">dict</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>):</span><br><span class="line">                result[key] = <span class="variable language_">self</span>._deep_merge(result[key], value)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result[key] = value</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, key: <span class="built_in">str</span>, default: <span class="type">Any</span> = <span class="literal">None</span></span>) -&gt; <span class="type">Any</span>:</span><br><span class="line">        keys = key.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">        value = <span class="variable language_">self</span>._config</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> keys:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>) <span class="keyword">and</span> k <span class="keyword">in</span> value:</span><br><span class="line">                value = value[k]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> default</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">config = MultiEnvConfig(<span class="string">&#x27;config.yaml&#x27;</span>)</span><br><span class="line"><span class="comment"># 或设置环境变量：export APP_ENV=production</span></span><br></pre></td></tr></table></figure>

<h3 id="5-4-配置验证"><a href="#5-4-配置验证" class="headerlink" title="5.4 配置验证"></a>5.4 配置验证</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Any</span>, <span class="type">Dict</span>, <span class="type">List</span>, <span class="type">Optional</span></span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DatabaseConfig</span>:</span><br><span class="line">    host: <span class="built_in">str</span></span><br><span class="line">    port: <span class="built_in">int</span></span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    user: <span class="built_in">str</span></span><br><span class="line">    password: <span class="built_in">str</span></span><br><span class="line">    pool_size: <span class="built_in">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AppConfig</span>:</span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    version: <span class="built_in">str</span></span><br><span class="line">    debug: <span class="built_in">bool</span> = <span class="literal">False</span></span><br><span class="line">    database: <span class="type">Optional</span>[DatabaseConfig] = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_config</span>(<span class="params">config: <span class="type">Dict</span></span>) -&gt; AppConfig:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;验证配置并返回类型安全的配置对象&quot;&quot;&quot;</span></span><br><span class="line">    errors = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 验证 app 配置</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;app&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> config:</span><br><span class="line">        errors.append(<span class="string">&quot;缺少 app 配置&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        app = config[<span class="string">&#x27;app&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;name&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> app:</span><br><span class="line">            errors.append(<span class="string">&quot;缺少 app.name&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;version&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> app:</span><br><span class="line">            errors.append(<span class="string">&quot;缺少 app.version&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 验证数据库配置</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;database&#x27;</span> <span class="keyword">in</span> config:</span><br><span class="line">        db = config[<span class="string">&#x27;database&#x27;</span>]</span><br><span class="line">        required_fields = [<span class="string">&#x27;host&#x27;</span>, <span class="string">&#x27;port&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;user&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> field <span class="keyword">in</span> required_fields:</span><br><span class="line">            <span class="keyword">if</span> field <span class="keyword">not</span> <span class="keyword">in</span> db:</span><br><span class="line">                errors.append(<span class="string">f&quot;缺少 database.<span class="subst">&#123;field&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> errors:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;配置验证失败:\n&quot;</span> + <span class="string">&quot;\n&quot;</span>.join(errors))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构建配置对象</span></span><br><span class="line">    app_config = AppConfig(</span><br><span class="line">        name=config[<span class="string">&#x27;app&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">        version=config[<span class="string">&#x27;app&#x27;</span>][<span class="string">&#x27;version&#x27;</span>],</span><br><span class="line">        debug=config.get(<span class="string">&#x27;app&#x27;</span>, &#123;&#125;).get(<span class="string">&#x27;debug&#x27;</span>, <span class="literal">False</span>)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;database&#x27;</span> <span class="keyword">in</span> config:</span><br><span class="line">        db = config[<span class="string">&#x27;database&#x27;</span>]</span><br><span class="line">        app_config.database = DatabaseConfig(</span><br><span class="line">            host=db[<span class="string">&#x27;host&#x27;</span>],</span><br><span class="line">            port=db[<span class="string">&#x27;port&#x27;</span>],</span><br><span class="line">            name=db[<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">            user=db[<span class="string">&#x27;user&#x27;</span>],</span><br><span class="line">            password=db.get(<span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">            pool_size=db.get(<span class="string">&#x27;pool_size&#x27;</span>, <span class="number">10</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> app_config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;config.yaml&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    raw_config = yaml.safe_load(f)</span><br><span class="line"></span><br><span class="line">config = validate_config(raw_config)</span><br><span class="line"><span class="built_in">print</span>(config.name)</span><br><span class="line"><span class="built_in">print</span>(config.database.host)</span><br></pre></td></tr></table></figure>

<h2 id="六、JSON-vs-YAML-对比"><a href="#六、JSON-vs-YAML-对比" class="headerlink" title="六、JSON vs YAML 对比"></a>六、JSON vs YAML 对比</h2><table>
<thead>
<tr>
<th>特性</th>
<th>JSON</th>
<th>YAML</th>
</tr>
</thead>
<tbody><tr>
<td>可读性</td>
<td>一般</td>
<td>优秀</td>
</tr>
<tr>
<td>简洁性</td>
<td>一般（需要大量括号）</td>
<td>优秀（缩进表示层级）</td>
</tr>
<tr>
<td>注释支持</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>数据类型</td>
<td>基础类型</td>
<td>基础类型 + 更多</td>
</tr>
<tr>
<td>解析速度</td>
<td>快</td>
<td>较慢</td>
</tr>
<tr>
<td>适用场景</td>
<td>API 数据交换</td>
<td>配置文件</td>
</tr>
<tr>
<td>Python 标准库</td>
<td>内置 json</td>
<td>需要 PyYAML</td>
</tr>
</tbody></table>
<h2 id="七、最佳实践"><a href="#七、最佳实践" class="headerlink" title="七、最佳实践"></a>七、最佳实践</h2><blockquote>
<p><strong>提醒自己</strong>：</p>
<ol>
<li><strong>配置文件不要提交敏感信息</strong>：使用环境变量或单独的 secrets 文件</li>
<li><strong>提供默认值</strong>：配置项应该有合理的默认值</li>
<li><strong>配置验证</strong>：启动时验证配置完整性</li>
<li><strong>使用合适的格式</strong>：API 用 JSON，配置用 YAML</li>
<li><strong>注释说明</strong>：配置项要有注释说明用途</li>
<li><strong>环境分离</strong>：不同环境使用不同配置</li>
</ol>
</blockquote>
<h2 id="八、练习"><a href="#八、练习" class="headerlink" title="八、练习"></a>八、练习</h2><ol>
<li>创建一个项目配置文件（YAML 格式），包含数据库、日志、API 等配置</li>
<li>实现一个配置加载器，支持环境变量替换</li>
<li>编写配置验证函数，确保必要配置项存在</li>
<li>实现多环境配置合并功能</li>
<li>创建一个 JSON 配置文件，并实现读取和写入功能</li>
</ol>
<hr>
<p><strong>上一篇</strong>：<a href="/2026/02/24/Python-%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89requests-API-%E8%B0%83%E7%94%A8/">Python 常用库（一）：requests API 调用</a></p>
<p><strong>下一篇</strong>：<a href="/2026/02/24/Python-%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging-%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/">Python 常用库（三）：logging 日志模块</a></p>
<p><strong>参考资源</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/json.html">json 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://pyyaml.org/wiki/PyYAMLDocumentation">PyYAML 官方文档</a></li>
<li><a target="_blank" rel="noopener" href="https://yaml.org/spec/">YAML 语法教程</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89json%20yaml%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/">https://brian-lin-c.github.io/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89json%20yaml%20%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/json/">json</a><a class="post-meta__tags" href="/tags/yaml/">yaml</a><a class="post-meta__tags" href="/tags/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/">配置文件</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Python 常用库（三）logging 日志模块</div></div><div class="info-2"><div class="info-item-1">Python 常用库（三）logging 日志模块日志是程序调试、监控和问题排查的重要工具。本篇将详细介绍 Python 内置的 logging 模块。 一、logging 简介1.1 为什么使用 logging？ 标准库：无需安装，开箱即用 灵活配置：可配置输出格式、级别、目标等 高性能：内置优化，适合生产环境 可扩展：支持自定义 Handler、Formatter、Filter  1.2 日志级别   级别 数值 说明 使用场景    DEBUG 10 调试信息 开发调试时的详细信息   INFO 20 一般信息 程序正常运行的信息   WARNING 30 警告信息 不影响运行但需要注意   ERROR 40 错误信息 程序错误但不影响继续运行   CRITICAL 50 严重错误 严重错误，程序可能无法继续   1234567import logginglogging.debug(&quot;调试信息&quot;)logging.info(&quot;一般信息&quot;)logging.warning(&quot;警告信息&quot;)logging.error(&qu...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89requests%20API%20%E8%B0%83%E7%94%A8/" title="Python 常用库（一）requests API 调用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">Python 常用库（一）requests API 调用</div></div><div class="info-2"><div class="info-item-1">Python 常用库（一）requests API 调用requests 是 Python 最流行的 HTTP 客户端库。本篇将介绍如何使用 requests 进行 API 调用、处理响应、文件上传等实用技能。 一、requests 简介1.1 为什么使用 requests？ 简洁 API：人性化设计，代码简单易读 功能强大：支持各种 HTTP 方法、认证、会话等 生态完善：文档丰富，社区活跃 自动处理：自动处理 URL 编码、Cookie、Session 等  1.2 安装与导入1pip install requests  1234import requests# 查看版本print(requests.__version__)  二、基础请求2.1 GET 请求12345678910111213141516171819202122232425262728import requests# 最简单的 GET 请求response = requests.get(&#x27;https://api.example.com/data&#x27;)# 带参数的 GET 请求params =...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%80%EF%BC%89%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E5%85%A5%E9%97%A8/" title="Python 基础教程（一）基础语法入门"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（一）基础语法入门</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（一）基础语法入门欢迎来到 Python 基础教程系列！本篇将从零开始介绍 Python 的基础语法，帮助你快速上手 Python 编程。 一、Python 简介1.1 为什么选择 Python？ 语法简洁：代码可读性强，接近自然语言 生态丰富：拥有庞大的第三方库生态系统 应用广泛：Web 开发、数据分析、人工智能、自动化脚本等 跨平台：Windows、Linux、macOS 均可运行 社区活跃：遇到问题容易找到解决方案  1.2 Python 版本选择 提醒自己：务必使用 Python 3.x（推荐 3.8+），Python 2 已停止维护。  二、环境搭建2.1 安装 PythonWindows：  访问 https://www.python.org/downloads/ 下载最新稳定版（如 3.11.x） 安装时勾选 “Add Python to PATH”  验证安装： 123python --version# 或python3 --version  2.2 包管理工具 pip1234567891011121314151617181920212223...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%BA%8C%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/" title="Python 基础教程（二）面向对象编程"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（二）面向对象编程</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（二）面向对象编程面向对象编程（OOP）是 Python 的核心编程范式之一。本篇将详细介绍 Python 中的类与对象、继承、多态等核心概念。 一、面向对象基础1.1 什么是面向对象？面向对象编程（Object-Oriented Programming, OOP） 是一种编程范式，它将数据和处理数据的方法封装在一起，形成”对象”。 核心概念：  类（Class）：对象的模板&#x2F;蓝图，定义对象的属性和方法 对象（Object）：类的实例，具体的实体 属性（Attribute）：对象的特征&#x2F;数据 方法（Method）：对象的行为&#x2F;操作  比喻理解：  类 &#x3D; 房屋设计图 对象 &#x3D; 根据设计图建造的具体房屋  1.2 为什么使用面向对象？ 提醒自己：  代码复用：继承机制减少重复代码 易于维护：封装使代码结构清晰 模块化：不同对象独立工作，降低耦合 模拟现实：更符合人类思维方式   二、类的定义与使用2.1 定义类123456789101112131415161718192021222324252627282930...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 常用库（三）logging 日志模块</div></div><div class="info-2"><div class="info-item-1">Python 常用库（三）logging 日志模块日志是程序调试、监控和问题排查的重要工具。本篇将详细介绍 Python 内置的 logging 模块。 一、logging 简介1.1 为什么使用 logging？ 标准库：无需安装，开箱即用 灵活配置：可配置输出格式、级别、目标等 高性能：内置优化，适合生产环境 可扩展：支持自定义 Handler、Formatter、Filter  1.2 日志级别   级别 数值 说明 使用场景    DEBUG 10 调试信息 开发调试时的详细信息   INFO 20 一般信息 程序正常运行的信息   WARNING 30 警告信息 不影响运行但需要注意   ERROR 40 错误信息 程序错误但不影响继续运行   CRITICAL 50 严重错误 严重错误，程序可能无法继续   1234567import logginglogging.debug(&quot;调试信息&quot;)logging.info(&quot;一般信息&quot;)logging.warning(&quot;警告信息&quot;)logging.error(&qu...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89requests%20API%20%E8%B0%83%E7%94%A8/" title="Python 常用库（一）requests API 调用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 常用库（一）requests API 调用</div></div><div class="info-2"><div class="info-item-1">Python 常用库（一）requests API 调用requests 是 Python 最流行的 HTTP 客户端库。本篇将介绍如何使用 requests 进行 API 调用、处理响应、文件上传等实用技能。 一、requests 简介1.1 为什么使用 requests？ 简洁 API：人性化设计，代码简单易读 功能强大：支持各种 HTTP 方法、认证、会话等 生态完善：文档丰富，社区活跃 自动处理：自动处理 URL 编码、Cookie、Session 等  1.2 安装与导入1pip install requests  1234import requests# 查看版本print(requests.__version__)  二、基础请求2.1 GET 请求12345678910111213141516171819202122232425262728import requests# 最简单的 GET 请求response = requests.get(&#x27;https://api.example.com/data&#x27;)# 带参数的 GET 请求params =...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%80%EF%BC%89NumPy%20%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" title="Python 数据科学（一）NumPy 数值计算"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 数据科学（一）NumPy 数值计算</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（一）NumPy 数值计算NumPy 是 Python 数据科学的基石。本篇将介绍 NumPy 的核心功能，包括 ndarray 数组、向量化计算、广播机制等。 一、NumPy 简介1.1 为什么使用 NumPy？ 性能优势：底层用 C 实现，比纯 Python 快 10-100 倍 内存效率：连续存储，占用更少内存 向量化操作：无需循环，代码更简洁 生态基础：Pandas、SciPy、scikit-learn 等都基于 NumPy  1.2 安装与导入1pip install numpy  1234import numpy as np# 查看版本print(np.__version__)  二、ndarray 数组2.1 创建数组123456789101112131415161718192021222324252627282930313233import numpy as np# 从列表创建arr1 = np.array([1, 2, 3, 4, 5])arr2 = np.array([[1, 2, 3], [4, 5, 6]])  # 二维数组# 特殊数...</div></div></div></a><a class="pagination-related" href="/2026/02/24/Python%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B%EF%BC%88%E4%B8%89%EF%BC%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" title="Python 基础教程（三）异常处理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">Python 基础教程（三）异常处理</div></div><div class="info-2"><div class="info-item-1">Python 基础教程（三）异常处理异常处理是编写健壮程序的关键。本篇将介绍 Python 中的异常处理机制，以及如何优雅地处理错误。 一、异常基础1.1 什么是异常？异常（Exception） 是程序运行过程中发生的错误事件。当 Python 无法正常执行代码时，会抛出异常。 12345678910111213141516171819202122232425262728# 常见异常示例# ZeroDivisionError: 除以零result = 10 / 0# FileNotFoundError: 文件不存在with open(&quot;不存在的文件.txt&quot;, &quot;r&quot;) as f:    content = f.read()# IndexError: 索引超出范围lst = [1, 2, 3]print(lst[10])# KeyError: 字典键不存在d = &#123;&quot;a&quot;: 1, &quot;b&quot;: 2&#125;print(d[&quot;c&quot;])# ValueError: 值错误num ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Python-%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89json-yaml-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Python 常用库（二）json&#x2F;yaml 配置文件处理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81JSON-%E5%9F%BA%E7%A1%80"><span class="toc-number">1.1.</span> <span class="toc-text">一、JSON 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-JSON-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 JSON 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-JSON-%E4%B8%8E-Python-%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 JSON 与 Python 类型对应</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81json-%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">二、json 模块使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 序列化与反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 文件读写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 自定义序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 自定义反序列化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81YAML-%E5%9F%BA%E7%A1%80"><span class="toc-number">1.3.</span> <span class="toc-text">三、YAML 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-YAML-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 YAML 简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-YAML-%E8%AF%AD%E6%B3%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 YAML 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%AE%89%E8%A3%85-PyYAML"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 安装 PyYAML</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81yaml-%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">四、yaml 模块使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E8%AF%BB%E5%8F%96-YAML"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 读取 YAML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%86%99%E5%85%A5-YAML"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 写入 YAML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E5%A4%84%E7%90%86"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 自定义类型处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.5.</span> <span class="toc-text">五、配置文件管理实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 配置文件示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD%E7%B1%BB"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 配置加载类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.3 多环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-%E9%85%8D%E7%BD%AE%E9%AA%8C%E8%AF%81"><span class="toc-number">1.5.4.</span> <span class="toc-text">5.4 配置验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81JSON-vs-YAML-%E5%AF%B9%E6%AF%94"><span class="toc-number">1.6.</span> <span class="toc-text">六、JSON vs YAML 对比</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">1.7.</span> <span class="toc-text">七、最佳实践</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E7%BB%83%E4%B9%A0"><span class="toc-number">1.8.</span> <span class="toc-text">八、练习</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%B8%80%EF%BC%89Linux%20%E5%9F%BA%E7%A1%80%E4%B8%8E%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="Linux 与 Shell（一）Linux 基础与常用命令">Linux 与 Shell（一）Linux 基础与常用命令</a><time datetime="2026-02-24T12:00:00.000Z" title="发表于 2026-02-24 20:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Python%20%E5%B8%B8%E7%94%A8%E5%BA%93%EF%BC%88%E4%B8%89%EF%BC%89logging%20%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" title="Python 常用库（三）logging 日志模块">Python 常用库（三）logging 日志模块</a><time datetime="2026-02-24T11:00:00.000Z" title="发表于 2026-02-24 19:00:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>