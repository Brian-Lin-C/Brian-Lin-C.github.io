<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>MySQL 进阶教程 13-01 存储过程与函数 | 过拟合的炸鱼薯条</title><meta name="author" content="过拟合的炸鱼薯条"><meta name="copyright" content="过拟合的炸鱼薯条"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL 进阶教程 13-01 存储过程与函数存储过程和函数是存储在数据库中的程序，可以封装复杂业务逻辑、提高代码复用性。本文将详细介绍存储过程与函数的语法、变量、流程控制和游标使用。 一、存储过程介绍1.1 什么是存储过程？存储过程（Stored Procedure） 是预编译并存储在数据库中的 SQL 程序，可以接受参数、执行复杂逻辑、返回结果。 1.2 存储过程的优点   优点 说明">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 进阶教程 13-01 存储过程与函数">
<meta property="og:url" content="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2013-01%20%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0/index.html">
<meta property="og:site_name" content="过拟合的炸鱼薯条">
<meta property="og:description" content="MySQL 进阶教程 13-01 存储过程与函数存储过程和函数是存储在数据库中的程序，可以封装复杂业务逻辑、提高代码复用性。本文将详细介绍存储过程与函数的语法、变量、流程控制和游标使用。 一、存储过程介绍1.1 什么是存储过程？存储过程（Stored Procedure） 是预编译并存储在数据库中的 SQL 程序，可以接受参数、执行复杂逻辑、返回结果。 1.2 存储过程的优点   优点 说明">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg">
<meta property="article:published_time" content="2026-02-24T08:00:00.000Z">
<meta property="article:modified_time" content="2026-02-24T10:46:48.874Z">
<meta property="article:author" content="过拟合的炸鱼薯条">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="存储函数">
<meta property="article:tag" content="存储过程">
<meta property="article:tag" content="游标">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MySQL 进阶教程 13-01 存储过程与函数",
  "url": "https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2013-01%20%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0/",
  "image": "https://brian-lin-c.github.io/img/%E5%A4%B4%E5%83%8F.jpg",
  "datePublished": "2026-02-24T08:00:00.000Z",
  "dateModified": "2026-02-24T10:46:48.874Z",
  "author": [
    {
      "@type": "Person",
      "name": "过拟合的炸鱼薯条",
      "url": "https://brian-lin-c.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2013-01%20%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.4"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.13.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL 进阶教程 13-01 存储过程与函数',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">过拟合的炸鱼薯条</span></a><a class="nav-page-title" href="/"><span class="site-name">MySQL 进阶教程 13-01 存储过程与函数</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">MySQL 进阶教程 13-01 存储过程与函数</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-02-24T08:00:00.000Z" title="发表于 2026-02-24 16:00:00">2026-02-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-24T10:46:48.874Z" title="更新于 2026-02-24 18:46:48">2026-02-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL-%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B/">MySQL 进阶教程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="MySQL-进阶教程-13-01-存储过程与函数"><a href="#MySQL-进阶教程-13-01-存储过程与函数" class="headerlink" title="MySQL 进阶教程 13-01 存储过程与函数"></a>MySQL 进阶教程 13-01 存储过程与函数</h1><p>存储过程和函数是存储在数据库中的程序，可以封装复杂业务逻辑、提高代码复用性。本文将详细介绍存储过程与函数的语法、变量、流程控制和游标使用。</p>
<h2 id="一、存储过程介绍"><a href="#一、存储过程介绍" class="headerlink" title="一、存储过程介绍"></a>一、存储过程介绍</h2><h3 id="1-1-什么是存储过程？"><a href="#1-1-什么是存储过程？" class="headerlink" title="1.1 什么是存储过程？"></a>1.1 什么是存储过程？</h3><p><strong>存储过程（Stored Procedure）</strong> 是预编译并存储在数据库中的 SQL 程序，可以接受参数、执行复杂逻辑、返回结果。</p>
<h3 id="1-2-存储过程的优点"><a href="#1-2-存储过程的优点" class="headerlink" title="1.2 存储过程的优点"></a>1.2 存储过程的优点</h3><table>
<thead>
<tr>
<th>优点</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>代码复用</td>
<td>一次编写，多次调用</td>
</tr>
<tr>
<td>性能提升</td>
<td>预编译，减少网络传输</td>
</tr>
<tr>
<td>安全性高</td>
<td>可以限制直接访问表</td>
</tr>
<tr>
<td>维护方便</td>
<td>逻辑集中在数据库层</td>
</tr>
</tbody></table>
<h3 id="1-3-存储过程的缺点"><a href="#1-3-存储过程的缺点" class="headerlink" title="1.3 存储过程的缺点"></a>1.3 存储过程的缺点</h3><table>
<thead>
<tr>
<th>缺点</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>可移植性差</td>
<td>不同数据库语法不同</td>
</tr>
<tr>
<td>调试困难</td>
<td>缺乏好的调试工具</td>
</tr>
<tr>
<td>服务器压力</td>
<td>逻辑在数据库层执行</td>
</tr>
</tbody></table>
<h2 id="二、存储过程基本语法"><a href="#二、存储过程基本语法" class="headerlink" title="二、存储过程基本语法"></a>二、存储过程基本语法</h2><h3 id="2-1-创建存储过程"><a href="#2-1-创建存储过程" class="headerlink" title="2.1 创建存储过程"></a>2.1 创建存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基本语法</span></span><br><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> procedure_name([<span class="keyword">IN</span><span class="operator">|</span><span class="keyword">OUT</span><span class="operator">|</span><span class="keyword">INOUT</span>] param_name type, ...)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- 存储过程体</span></span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 示例：无参数存储过程</span></span><br><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_all_employees()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="keyword">CALL</span> get_all_employees();</span><br></pre></td></tr></table></figure>

<h3 id="2-2-为什么需要-DELIMITER？"><a href="#2-2-为什么需要-DELIMITER？" class="headerlink" title="2.2 为什么需要 DELIMITER？"></a>2.2 为什么需要 DELIMITER？</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL 默认分隔符是 ;</span></span><br><span class="line"><span class="comment">-- 存储过程内部也有 ;，需要临时更改分隔符</span></span><br><span class="line"></span><br><span class="line">DELIMITER $$  <span class="comment">-- 将分隔符改为 $$</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> proc()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users;  <span class="comment">-- 这里的;不会结束语句</span></span><br><span class="line"><span class="keyword">END</span>$$                       <span class="comment">-- $$ 结束整个 CREATE 语句</span></span><br><span class="line">DELIMITER ;  <span class="comment">-- 恢复默认分隔符</span></span><br></pre></td></tr></table></figure>

<h3 id="2-3-查看存储过程"><a href="#2-3-查看存储过程" class="headerlink" title="2.3 查看存储过程"></a>2.3 查看存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看所有存储过程</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PROCEDURE</span> STATUS;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看特定存储过程</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PROCEDURE</span> STATUS <span class="keyword">WHERE</span> Name <span class="operator">=</span> <span class="string">&#x27;get_all_employees&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看创建语句</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_all_employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 从 information_schema 查询</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> information_schema.ROUTINES</span><br><span class="line"><span class="keyword">WHERE</span> ROUTINE_TYPE <span class="operator">=</span> <span class="string">&#x27;PROCEDURE&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-修改和删除存储过程"><a href="#2-4-修改和删除存储过程" class="headerlink" title="2.4 修改和删除存储过程"></a>2.4 修改和删除存储过程</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- MySQL 不支持直接修改存储过程</span></span><br><span class="line"><span class="comment">-- 需要先删除再创建</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> IF <span class="keyword">EXISTS</span> get_all_employees;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_all_employees()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除存储过程</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> IF <span class="keyword">EXISTS</span> procedure_name;</span><br></pre></td></tr></table></figure>

<h2 id="三、系统变量"><a href="#三、系统变量" class="headerlink" title="三、系统变量"></a>三、系统变量</h2><h3 id="3-1-查看系统变量"><a href="#3-1-查看系统变量" class="headerlink" title="3.1 查看系统变量"></a>3.1 查看系统变量</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查看所有系统变量</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看特定变量</span></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;max_connections&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看会话级变量</span></span><br><span class="line"><span class="keyword">SHOW</span> SESSION VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;autocommit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看全局变量</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;max_connections&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-设置系统变量"><a href="#3-2-设置系统变量" class="headerlink" title="3.2 设置系统变量"></a>3.2 设置系统变量</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 设置会话级变量</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> SESSION autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置全局变量（需要 SUPER 权限）</span></span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> max_connections <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">SET</span> @<span class="variable">@GLOBAL</span>.max_connections <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置当前会话变量</span></span><br><span class="line"><span class="keyword">SET</span> @<span class="variable">@SESSION</span>.autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> @<span class="variable">@autocommit</span> <span class="operator">=</span> <span class="number">0</span>;  <span class="comment">-- 默认当前会话</span></span><br></pre></td></tr></table></figure>

<h2 id="四、用户定义变量"><a href="#四、用户定义变量" class="headerlink" title="四、用户定义变量"></a>四、用户定义变量</h2><h3 id="4-1-用户变量语法"><a href="#4-1-用户变量语法" class="headerlink" title="4.1 用户变量语法"></a>4.1 用户变量语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 用户变量以 @ 开头</span></span><br><span class="line"><span class="comment">-- 会话级别，连接断开后失效</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-用户变量使用"><a href="#4-2-用户变量使用" class="headerlink" title="4.2 用户变量使用"></a>4.2 用户变量使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 定义变量</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@name</span> <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@age</span> <span class="operator">=</span> <span class="number">25</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@salary</span> :<span class="operator">=</span> <span class="number">10000</span>;  <span class="comment">-- 使用 := 赋值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询赋值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@count</span> :<span class="operator">=</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用变量</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@name</span>, <span class="variable">@age</span>, <span class="variable">@salary</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在查询中使用</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="variable">@salary</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-用户变量应用"><a href="#4-3-用户变量应用" class="headerlink" title="4.3 用户变量应用"></a>4.3 用户变量应用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 行号</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@rownum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@rownum</span> :<span class="operator">=</span> <span class="variable">@rownum</span> <span class="operator">+</span> <span class="number">1</span> <span class="keyword">AS</span> rownum, name <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 累计求和</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">SELECT</span> name, salary, <span class="variable">@sum</span> :<span class="operator">=</span> <span class="variable">@sum</span> <span class="operator">+</span> salary <span class="keyword">AS</span> running_total</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<h2 id="五、局部变量"><a href="#五、局部变量" class="headerlink" title="五、局部变量"></a>五、局部变量</h2><h3 id="5-1-声明局部变量"><a href="#5-1-声明局部变量" class="headerlink" title="5.1 声明局部变量"></a>5.1 声明局部变量</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 局部变量在 BEGIN...END 中声明</span></span><br><span class="line"><span class="comment">-- 使用 DECLARE 关键字</span></span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> var_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- 声明变量</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> v_age <span class="type">INT</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> v_salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 声明并初始化</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_count <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 赋值</span></span><br><span class="line">    <span class="keyword">SET</span> v_name <span class="operator">=</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line">    <span class="keyword">SET</span> v_age <span class="operator">=</span> <span class="number">25</span>;</span><br><span class="line">    <span class="keyword">SET</span> v_salary <span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">SELECT</span> v_name, v_age, v_salary;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-SELECT-INTO-赋值"><a href="#5-2-SELECT-INTO-赋值" class="headerlink" title="5.2 SELECT INTO 赋值"></a>5.2 SELECT INTO 赋值</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> select_into_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> v_salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- SELECT INTO 赋值</span></span><br><span class="line">    <span class="keyword">SELECT</span> name, salary <span class="keyword">INTO</span> v_name, v_salary</span><br><span class="line">    <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">SELECT</span> v_name, v_salary;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h2 id="六、IF-判断"><a href="#六、IF-判断" class="headerlink" title="六、IF 判断"></a>六、IF 判断</h2><h3 id="6-1-IF-语句语法"><a href="#6-1-IF-语句语法" class="headerlink" title="6.1 IF 语句语法"></a>6.1 IF 语句语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基本语法</span></span><br><span class="line">IF <span class="keyword">condition</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="comment">-- 语句</span></span><br><span class="line">ELSEIF <span class="keyword">condition</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="comment">-- 语句</span></span><br><span class="line"><span class="keyword">ELSE</span></span><br><span class="line">    <span class="comment">-- 语句</span></span><br><span class="line"><span class="keyword">END</span> IF;</span><br></pre></td></tr></table></figure>

<h3 id="6-2-IF-语句示例"><a href="#6-2-IF-语句示例" class="headerlink" title="6.2 IF 语句示例"></a>6.2 IF 语句示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> salary_level(<span class="keyword">IN</span> v_salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    IF v_salary <span class="operator">&gt;=</span> <span class="number">20000</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;高收入&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">    ELSEIF v_salary <span class="operator">&gt;=</span> <span class="number">10000</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;中高收入&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">    ELSEIF v_salary <span class="operator">&gt;=</span> <span class="number">5000</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;中等收入&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">    <span class="keyword">ELSE</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;低收入&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line"><span class="keyword">CALL</span> salary_level(<span class="number">15000</span>);  <span class="comment">-- 中高收入</span></span><br></pre></td></tr></table></figure>

<h2 id="七、参数-IN-OUT-INOUT"><a href="#七、参数-IN-OUT-INOUT" class="headerlink" title="七、参数 IN&#x2F;OUT&#x2F;INOUT"></a>七、参数 IN&#x2F;OUT&#x2F;INOUT</h2><h3 id="7-1-IN-参数（输入）"><a href="#7-1-IN-参数（输入）" class="headerlink" title="7.1 IN 参数（输入）"></a>7.1 IN 参数（输入）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_employee(<span class="keyword">IN</span> v_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> id <span class="operator">=</span> v_id;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line"><span class="keyword">CALL</span> get_employee(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="7-2-OUT-参数（输出）"><a href="#7-2-OUT-参数（输出）" class="headerlink" title="7.2 OUT 参数（输出）"></a>7.2 OUT 参数（输出）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_emp_count(<span class="keyword">OUT</span> v_count <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> v_count <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line"><span class="keyword">CALL</span> get_emp_count(<span class="variable">@count</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@count</span>;  <span class="comment">-- 查看结果</span></span><br></pre></td></tr></table></figure>

<h3 id="7-3-INOUT-参数（输入输出）"><a href="#7-3-INOUT-参数（输入输出）" class="headerlink" title="7.3 INOUT 参数（输入输出）"></a>7.3 INOUT 参数（输入输出）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> increment(<span class="keyword">INOUT</span> v_value <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SET</span> v_value <span class="operator">=</span> v_value <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@num</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line"><span class="keyword">CALL</span> increment(<span class="variable">@num</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@num</span>;  <span class="comment">-- 11</span></span><br></pre></td></tr></table></figure>

<h2 id="八、CASE-语句"><a href="#八、CASE-语句" class="headerlink" title="八、CASE 语句"></a>八、CASE 语句</h2><h3 id="8-1-简单-CASE"><a href="#8-1-简单-CASE" class="headerlink" title="8.1 简单 CASE"></a>8.1 简单 CASE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> case_simple(<span class="keyword">IN</span> v_dept_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">CASE</span> v_dept_id</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="string">&#x27;技术部&#x27;</span> <span class="keyword">AS</span> dept_name;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">2</span> <span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="string">&#x27;市场部&#x27;</span> <span class="keyword">AS</span> dept_name;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">3</span> <span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="string">&#x27;财务部&#x27;</span> <span class="keyword">AS</span> dept_name;</span><br><span class="line">        <span class="keyword">ELSE</span> <span class="keyword">SELECT</span> <span class="string">&#x27;其他部门&#x27;</span> <span class="keyword">AS</span> dept_name;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="8-2-搜索-CASE"><a href="#8-2-搜索-CASE" class="headerlink" title="8.2 搜索 CASE"></a>8.2 搜索 CASE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> case_search(<span class="keyword">IN</span> v_salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">CASE</span></span><br><span class="line">        <span class="keyword">WHEN</span> v_salary <span class="operator">&gt;=</span> <span class="number">20000</span> <span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="string">&#x27;高薪&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">        <span class="keyword">WHEN</span> v_salary <span class="operator">&gt;=</span> <span class="number">10000</span> <span class="keyword">THEN</span> <span class="keyword">SELECT</span> <span class="string">&#x27;中等&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">        <span class="keyword">ELSE</span> <span class="keyword">SELECT</span> <span class="string">&#x27;低薪&#x27;</span> <span class="keyword">AS</span> level;</span><br><span class="line">    <span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h2 id="九、WHILE-循环"><a href="#九、WHILE-循环" class="headerlink" title="九、WHILE 循环"></a>九、WHILE 循环</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> while_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    WHILE v_i <span class="operator">&lt;=</span> <span class="number">5</span> DO</span><br><span class="line">        <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;第&#x27;</span>, v_i, <span class="string">&#x27;次循环&#x27;</span>) <span class="keyword">AS</span> msg;</span><br><span class="line">        <span class="keyword">SET</span> v_i <span class="operator">=</span> v_i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> while_demo();</span><br></pre></td></tr></table></figure>

<h2 id="十、REPEAT-循环"><a href="#十、REPEAT-循环" class="headerlink" title="十、REPEAT 循环"></a>十、REPEAT 循环</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> repeat_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    REPEAT</span><br><span class="line">        <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;第&#x27;</span>, v_i, <span class="string">&#x27;次循环&#x27;</span>) <span class="keyword">AS</span> msg;</span><br><span class="line">        <span class="keyword">SET</span> v_i <span class="operator">=</span> v_i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    UNTIL v_i <span class="operator">&gt;</span> <span class="number">5</span></span><br><span class="line">    <span class="keyword">END</span> REPEAT;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> repeat_demo();</span><br></pre></td></tr></table></figure>

<h2 id="十一、LOOP-循环"><a href="#十一、LOOP-循环" class="headerlink" title="十一、LOOP 循环"></a>十一、LOOP 循环</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> loop_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    loop_label: LOOP</span><br><span class="line">        IF v_i <span class="operator">&gt;</span> <span class="number">5</span> <span class="keyword">THEN</span></span><br><span class="line">            LEAVE loop_label;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;第&#x27;</span>, v_i, <span class="string">&#x27;次循环&#x27;</span>) <span class="keyword">AS</span> msg;</span><br><span class="line">        <span class="keyword">SET</span> v_i <span class="operator">=</span> v_i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> loop_demo();</span><br></pre></td></tr></table></figure>

<h2 id="十二、游标-CURSOR"><a href="#十二、游标-CURSOR" class="headerlink" title="十二、游标 CURSOR"></a>十二、游标 CURSOR</h2><h3 id="12-1-游标使用步骤"><a href="#12-1-游标使用步骤" class="headerlink" title="12.1 游标使用步骤"></a>12.1 游标使用步骤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> cursor_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_id <span class="type">INT</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> v_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> done <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 1. 声明游标</span></span><br><span class="line">    <span class="keyword">DECLARE</span> cur_emp <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> id, name <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 2. 声明继续处理器</span></span><br><span class="line">    <span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND <span class="keyword">SET</span> done <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 3. 打开游标</span></span><br><span class="line">    <span class="keyword">OPEN</span> cur_emp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 4. 读取数据</span></span><br><span class="line">    read_loop: LOOP</span><br><span class="line">        <span class="keyword">FETCH</span> cur_emp <span class="keyword">INTO</span> v_id, v_name;</span><br><span class="line"></span><br><span class="line">        IF done <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">            LEAVE read_loop;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;ID:&#x27;</span>, v_id, <span class="string">&#x27; Name:&#x27;</span>, v_name) <span class="keyword">AS</span> emp_info;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 5. 关闭游标</span></span><br><span class="line">    <span class="keyword">CLOSE</span> cur_emp;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="12-2-游标嵌套"><a href="#12-2-游标嵌套" class="headerlink" title="12.2 游标嵌套"></a>12.2 游标嵌套</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> cursor_nested()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_dept_id <span class="type">INT</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> v_dept_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> v_emp_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="keyword">DECLARE</span> done_dept <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">DECLARE</span> done_emp <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 外层游标</span></span><br><span class="line">    <span class="keyword">DECLARE</span> cur_dept <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> id, name <span class="keyword">FROM</span> departments;</span><br><span class="line">    <span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND <span class="keyword">SET</span> done_dept <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">OPEN</span> cur_dept;</span><br><span class="line"></span><br><span class="line">    dept_loop: LOOP</span><br><span class="line">        <span class="keyword">FETCH</span> cur_dept <span class="keyword">INTO</span> v_dept_id, v_dept_name;</span><br><span class="line">        IF done_dept <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">            LEAVE dept_loop;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;部门:&#x27;</span>, v_dept_name) <span class="keyword">AS</span> dept_info;</span><br><span class="line"></span><br><span class="line">        <span class="comment">-- 内层游标</span></span><br><span class="line">        <span class="keyword">BEGIN</span></span><br><span class="line">            <span class="keyword">DECLARE</span> cur_emp <span class="keyword">CURSOR</span> <span class="keyword">FOR</span></span><br><span class="line">                <span class="keyword">SELECT</span> name <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> dept_id <span class="operator">=</span> v_dept_id;</span><br><span class="line">            <span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND <span class="keyword">SET</span> done_emp <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">OPEN</span> cur_emp;</span><br><span class="line"></span><br><span class="line">            emp_loop: LOOP</span><br><span class="line">                <span class="keyword">FETCH</span> cur_emp <span class="keyword">INTO</span> v_emp_name;</span><br><span class="line">                IF done_emp <span class="operator">=</span> <span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">                    <span class="keyword">SET</span> done_emp <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">                    LEAVE emp_loop;</span><br><span class="line">                <span class="keyword">END</span> IF;</span><br><span class="line">                <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;  员工:&#x27;</span>, v_emp_name) <span class="keyword">AS</span> emp_info;</span><br><span class="line">            <span class="keyword">END</span> LOOP;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">CLOSE</span> cur_emp;</span><br><span class="line">        <span class="keyword">END</span>;</span><br><span class="line">    <span class="keyword">END</span> LOOP;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLOSE</span> cur_dept;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h2 id="十三、条件处理程序-HANDLER"><a href="#十三、条件处理程序-HANDLER" class="headerlink" title="十三、条件处理程序 HANDLER"></a>十三、条件处理程序 HANDLER</h2><h3 id="13-1-HANDLER-语法"><a href="#13-1-HANDLER-语法" class="headerlink" title="13.1 HANDLER 语法"></a>13.1 HANDLER 语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基本语法</span></span><br><span class="line"><span class="keyword">DECLARE</span> handler_type HANDLER <span class="keyword">FOR</span> condition_value statement</span><br><span class="line"></span><br><span class="line"><span class="comment">-- handler_type:</span></span><br><span class="line"><span class="comment">--   CONTINUE    - 继续执行</span></span><br><span class="line"><span class="comment">--   EXIT        - 退出</span></span><br><span class="line"><span class="comment">--   UNDO        - 回滚（MySQL 不支持）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- condition_value:</span></span><br><span class="line"><span class="comment">--   SQLSTATE &#x27;error_code&#x27;</span></span><br><span class="line"><span class="comment">--   SQLWARNING</span></span><br><span class="line"><span class="comment">--   NOT FOUND</span></span><br><span class="line"><span class="comment">--   SQLEXCEPTION</span></span><br></pre></td></tr></table></figure>

<h3 id="13-2-HANDLER-示例"><a href="#13-2-HANDLER-示例" class="headerlink" title="13.2 HANDLER 示例"></a>13.2 HANDLER 示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> handler_demo()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_result <span class="type">INT</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 声明继续处理器</span></span><br><span class="line">    <span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">SQLEXCEPTION</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;发生错误&#x27;</span> <span class="keyword">AS</span> msg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 声明退出处理器</span></span><br><span class="line">    <span class="keyword">DECLARE</span> EXIT HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="string">&#x27;未找到数据&#x27;</span> <span class="keyword">AS</span> msg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 可能出错的语句</span></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="number">1</span><span class="operator">/</span><span class="number">0</span> <span class="keyword">INTO</span> v_result;  <span class="comment">-- 除零错误</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">SELECT</span> <span class="string">&#x27;继续执行&#x27;</span> <span class="keyword">AS</span> msg;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h2 id="十四、存储函数"><a href="#十四、存储函数" class="headerlink" title="十四、存储函数"></a>十四、存储函数</h2><h3 id="14-1-存储函数语法"><a href="#14-1-存储函数语法" class="headerlink" title="14.1 存储函数语法"></a>14.1 存储函数语法</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> function_name(param_name type)</span><br><span class="line"><span class="keyword">RETURNS</span> return_type</span><br><span class="line"><span class="keyword">DETERMINISTIC</span>  <span class="comment">-- 或 NO SQL / READS SQL DATA / MODIFIES SQL DATA</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="comment">-- 函数体</span></span><br><span class="line">    <span class="keyword">RETURN</span> <span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="14-2-存储函数示例"><a href="#14-2-存储函数示例" class="headerlink" title="14.2 存储函数示例"></a>14.2 存储函数示例</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> get_dept_name(v_dept_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line"><span class="keyword">READS</span> <span class="keyword">SQL</span> DATA</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">DECLARE</span> v_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">    <span class="keyword">SELECT</span> dept_name <span class="keyword">INTO</span> v_name <span class="keyword">FROM</span> departments <span class="keyword">WHERE</span> id <span class="operator">=</span> v_dept_id;</span><br><span class="line">    <span class="keyword">RETURN</span> v_name;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用</span></span><br><span class="line"><span class="keyword">SELECT</span> get_dept_name(<span class="number">1</span>) <span class="keyword">AS</span> dept_name;</span><br><span class="line"><span class="keyword">SELECT</span> id, name, get_dept_name(dept_id) <span class="keyword">AS</span> dept <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<h3 id="14-3-函数与存储过程的区别"><a href="#14-3-函数与存储过程的区别" class="headerlink" title="14.3 函数与存储过程的区别"></a>14.3 函数与存储过程的区别</h3><table>
<thead>
<tr>
<th>区别</th>
<th>存储过程</th>
<th>存储函数</th>
</tr>
</thead>
<tbody><tr>
<td>返回值</td>
<td>可以有多个 OUT 参数</td>
<td>必须有一个返回值</td>
</tr>
<tr>
<td>调用方式</td>
<td>CALL</td>
<td>SELECT</td>
</tr>
<tr>
<td>使用场景</td>
<td>复杂业务逻辑</td>
<td>计算、转换</td>
</tr>
</tbody></table>
<h2 id="十五、小结"><a href="#十五、小结" class="headerlink" title="十五、小结"></a>十五、小结</h2><h3 id="核心知识点"><a href="#核心知识点" class="headerlink" title="核心知识点"></a>核心知识点</h3><ol>
<li><strong>存储过程</strong>：预编译的 SQL 程序，使用 CALL 调用</li>
<li><strong>变量</strong>：系统变量、用户变量、局部变量</li>
<li><strong>流程控制</strong>：IF、CASE、WHILE、REPEAT、LOOP</li>
<li><strong>游标</strong>：遍历查询结果集</li>
<li><strong>HANDLER</strong>：异常处理机制</li>
<li><strong>存储函数</strong>：有返回值，使用 SELECT 调用</li>
</ol>
<h3 id="使用建议"><a href="#使用建议" class="headerlink" title="使用建议"></a>使用建议</h3><table>
<thead>
<tr>
<th>场景</th>
<th>推荐</th>
</tr>
</thead>
<tbody><tr>
<td>复杂业务逻辑</td>
<td>存储过程</td>
</tr>
<tr>
<td>代码复用</td>
<td>存储过程&#x2F;函数</td>
</tr>
<tr>
<td>计算转换</td>
<td>存储函数</td>
</tr>
<tr>
<td>批量处理</td>
<td>存储过程</td>
</tr>
</tbody></table>
<h3 id="下一章预告"><a href="#下一章预告" class="headerlink" title="下一章预告"></a>下一章预告</h3><p>下一篇文章将介绍<strong>触发器</strong>，包括：</p>
<ul>
<li>触发器概念</li>
<li>INSERT&#x2F;UPDATE&#x2F;DELETE 触发器</li>
<li>触发器应用场景</li>
</ul>
<hr>
<p><strong>下一篇</strong>：[MySQL 进阶教程 14-01 触发器详解](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 进阶教程 14-01 触发器详解&#x2F;)</p>
<p><strong>上一篇</strong>：[MySQL 进阶教程 12-01 视图详解](&#x2F;2026&#x2F;02&#x2F;24&#x2F;MySQL 进阶教程 12-01 视图详解&#x2F;)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io">过拟合的炸鱼薯条</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2013-01%20%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0/">https://brian-lin-c.github.io/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2013-01%20%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://brian-lin-c.github.io" target="_blank">过拟合的炸鱼薯条</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a><a class="post-meta__tags" href="/tags/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/">存储过程</a><a class="post-meta__tags" href="/tags/%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0/">存储函数</a><a class="post-meta__tags" href="/tags/%E6%B8%B8%E6%A0%87/">游标</a></div><div class="post-share"><div class="social-share" data-image="/img/%E5%A4%B4%E5%83%8F.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2026/02/24/Python%20%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%EF%BC%88%E4%B8%89%EF%BC%89PyArrow%20%E9%AB%98%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C/" title="Python 数据科学（三）PyArrow 高性能数据操作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Python 数据科学（三）PyArrow 高性能数据操作</div></div><div class="info-2"><div class="info-item-1">Python 数据科学（三）PyArrow 高性能数据操作PyArrow 是一个高性能的数据处理库，提供列式内存格式和快速的数据 I&#x2F;O。本篇将介绍 PyArrow 的核心功能和使用技巧。 一、PyArrow 简介1.1 为什么使用 PyArrow？ 高性能：列式存储，比 Pandas 快数倍到数十倍 零拷贝：与 Pandas、NumPy 无缝集成，无需数据复制 跨语言：支持 Python、C++、Java、R 等 大文件处理：支持流式处理超大文件 现代格式：Parquet、Feather 等高效格式支持  1.2 安装与导入1pip install pyarrow  1234567import pyarrow as paimport pyarrow.parquet as pqimport pyarrow.csv as csvimport pandas as pd# 查看版本print(pa.__version__)  二、PyArrow 数据结构2.1 Table（表格）1234567891011121314151617181920import pyarrow as ...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2004-07%20%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" title="MySQL 进阶教程 04-07 窗口函数实战案例"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">MySQL 进阶教程 04-07 窗口函数实战案例</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 04-07 窗口函数实战案例本文通过综合实战案例，展示如何运用窗口函数解决实际业务问题。案例涵盖连续登录、Top N 问题、累计分析、复杂报表等常见场景。 一、连续登录问题1.1 问题描述场景：用户签到系统，找出连续签到 3 天以上的用户。 1234567891011121314-- 准备签到数据DROP TABLE IF EXISTS user_signin;CREATE TABLE user_signin (    id INT PRIMARY KEY AUTO_INCREMENT,    user_id INT NOT NULL,    signin_date DATE NOT NULL,    UNIQUE KEY uk_user_date (user_id, signin_date)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;INSERT INTO user_signin (user_id, signin_date) VALUES(1, &#x27;2024-01-01&#x27;), (1, &#x27;202...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-09%20MyCat%20%E4%B8%80%E8%87%B4%E6%80%A7%20Hash/" title="MySQL 运维篇 04-09 MyCat 一致性 Hash"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 04-09 MyCat 一致性 Hash</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 04-09 MyCat 一致性 Hash一致性 Hash 是一种分布式哈希技术，可以减少扩容时的数据迁移量。本文将介绍一致性 Hash 的原理和在 MyCat 中的应用。 一、一致性 Hash 介绍1.1 什么是一致性 Hash一致性 Hash：将数据和节点映射到一个哈希环上，数据存储在顺时针方向最近的节点上。 1234567传统 Hash 问题：- 扩容时需要 rehash 所有数据- 数据迁移量大一致性 Hash 优势：- 扩容时只影响相邻节点- 数据迁移量小  1.2 原理123456789101112131415哈希环示意图：          节点 A (hash=100)         /         \        /           \  数据 X            数据 Y (hash=50)        (hash=200)      |             |      |             |  节点 C         节点 B (hash=0)      (hash=300)数据存储规则：- 数据 X (...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B%2012-01%20%E8%A7%86%E5%9B%BE%E8%AF%A6%E8%A7%A3/" title="MySQL 进阶教程 12-01 视图详解"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 进阶教程 12-01 视图详解</div></div><div class="info-2"><div class="info-item-1">MySQL 进阶教程 12-01 视图详解视图是数据库中的虚拟表，可以简化复杂查询、提高安全性。本文将详细介绍视图的概念、创建、使用和限制。 一、视图介绍及语法1.1 什么是视图？视图（View） 是基于 SQL 查询结果的虚拟表，视图本身不存储数据，只存储查询定义。 123视图 vs 表：├── 表：存储实际数据└── 视图：存储查询定义，数据来自基表  1.2 视图的作用   作用 说明    简化查询 将复杂查询封装为视图   数据安全 只暴露部分字段给用户   逻辑独立 基表结构变化不影响应用   重用 SQL 避免重复编写相同查询   1.3 创建视图语法12345678910111213-- 基本语法CREATE [OR REPLACE] VIEW view_name [(column_list)]AS select_statement[WITH [CASCADED | LOCAL] CHECK OPTION];-- 示例：创建员工信息视图CREATE VIEW v_emp_info ASSELECT e.id, e.name, e.salary, d.dept_na...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-05%20%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97/" title="MySQL 运维篇 01-05 慢查询日志"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 01-05 慢查询日志</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 01-05 慢查询日志慢查询日志（Slow Query Log）是 MySQL 性能优化的重要工具，用于记录执行时间超过指定阈值的 SQL 语句。通过分析慢查询日志，可以发现和优化性能瓶颈。 一、慢查询日志介绍1.1 什么是慢查询日志？慢查询日志记录执行时间超过指定阈值的 SQL 语句： 12345慢查询日志记录内容：├── 执行时间超过 long_query_time 的 SQL├── 未使用索引的查询（可选）├── 不使用索引的 JOIN（可选）└── 包含：执行时间、锁定时间、发送行数、扫描行数  1.2 慢查询的作用   作用 说明    性能瓶颈定位 找到执行慢的 SQL   索引优化依据 发现需要索引的字段   SQL 优化参考 分析低效的 SQL 写法   性能监控 定期分析性能趋势   1.3 与进阶篇的区别   内容 进阶篇（09-08） 运维篇（01-05）    重点 基础使用和案例 深入配置和分析   开启方法 基础命令 详细参数配置   分析工具 简单介绍 详细使用   实战案例 单个案例 多种场景   二、慢查询日志配置2.1 基本...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2001-02%20%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97/" title="MySQL 运维篇 01-02 错误日志"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 01-02 错误日志</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 01-02 错误日志错误日志（Error Log）是 MySQL 最重要的日志，记录了数据库启动、运行和停止过程中的错误、警告和提示信息。它是故障排查的首选工具。 一、错误日志介绍1.1 什么是错误日志？错误日志记录 MySQL 服务器运行过程中遇到的各种错误和异常情况： 1234567错误日志记录内容：├── 服务器启动/停止信息├── 严重错误（如表损坏、磁盘满）├── 警告信息（如配置问题）├── 连接错误（如认证失败）├── 复制错误└── InnoDB 引擎错误  1.2 错误级别   级别 说明 示例    ERROR 严重错误，需要立即处理 磁盘满、表损坏   WARNING 警告，可能影响运行 配置参数不推荐   NOTE 提示信息，一般无需处理 正常启动信息   1.3 错误日志格式12345678# MySQL 5.7 格式2024-02-24T10:30:45.123456Z 0 [ERROR] InnoDB: Unable to lock ./ibdata1 error: 11# MySQL 8.0 格式（组件化）2024-02-24T...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-04%20MyCat%20%E5%9E%82%E7%9B%B4%E5%88%86%E5%BA%93/" title="MySQL 运维篇 04-04 MyCat 垂直分库"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 04-04 MyCat 垂直分库</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 04-04 MyCat 垂直分库垂直分库是将不同的业务表分布到不同的数据库中。本文将介绍如何使用 MyCat 实现垂直分库。 一、垂直分库介绍1.1 什么是垂直分库垂直分库：按照业务模块将表拆分到不同的数据库中。 1234567原始架构：single_db (users, orders, products, logs, ...)垂直分库后：user_db (users, user_profile, user_login, ...)order_db (orders, order_detail, order_log, ...)product_db (products, category, brand, ...)  1.2 适用场景   场景 说明    业务模块清晰 各模块相对独立   表数量过多 单库表数量超过 100   访问量差异大 热门表和冷门表分离   团队分工 不同团队负责不同模块   1.3 优缺点优点：  业务清晰，便于管理 减少单库压力 便于水平扩展  缺点：  跨库 JOIN 复杂 事务处理困难 增加运维成本  二、环境准备2.1 数据库规划 ...</div></div></div></a><a class="pagination-related" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2002-04%20%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E4%BB%8E%E5%BA%93%E9%85%8D%E7%BD%AE/" title="MySQL 运维篇 02-04 主从复制从库配置"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2026-02-24</div><div class="info-item-2">MySQL 运维篇 02-04 主从复制从库配置</div></div><div class="info-2"><div class="info-item-1">MySQL 运维篇 02-04 主从复制从库配置本文将详细讲解主从复制中从库的配置步骤，包括配置文件修改、数据恢复、复制连接等。 一、配置前准备1.1 环境信息   服务器 IP 地址 角色 server_id    master 192.168.1.100 主库 1   slave1 192.168.1.101 从库 2   1.2 主库配置完成确认在配置从库前，确保主库已完成：   binlog 已开启  server_id 已设置  复制用户已创建  防火墙已配置  已记录 binlog 位置（File 和 Position）  二、从库配置文件修改2.1 必需配置项1234567891011121314151617181920[mysqld]# ===== 复制必需配置 =====# 1. server_id（必须唯一，不能与主库和其他从库重复）server_id = 2# 2. relay log 配置relay_log = /var/log/mysql/mysql-relay-bin.logrelay_log_index = /var/log/mysql/mysql-...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">过拟合的炸鱼薯条</div><div class="author-info-description">好好学习，天天向上</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">68</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">157</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Brian-Lin-C"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Brian-Lin-C" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的个人博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-%E8%BF%9B%E9%98%B6%E6%95%99%E7%A8%8B-13-01-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E5%87%BD%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text">MySQL 进阶教程 13-01 存储过程与函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">一、存储过程介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 什么是存储过程？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 存储过程的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 存储过程的缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">二、存储过程基本语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 创建存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-DELIMITER%EF%BC%9F"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 为什么需要 DELIMITER？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%9F%A5%E7%9C%8B%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">2.3 查看存储过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">2.4 修改和删除存储过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">1.3.</span> <span class="toc-text">三、系统变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 查看系统变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E8%AE%BE%E7%BD%AE%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 设置系统变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">1.4.</span> <span class="toc-text">四、用户定义变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%E8%AF%AD%E6%B3%95"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 用户变量语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 用户变量使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F%E5%BA%94%E7%94%A8"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.3 用户变量应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">1.5.</span> <span class="toc-text">五、局部变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%A3%B0%E6%98%8E%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 声明局部变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-SELECT-INTO-%E8%B5%8B%E5%80%BC"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.2 SELECT INTO 赋值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81IF-%E5%88%A4%E6%96%AD"><span class="toc-number">1.6.</span> <span class="toc-text">六、IF 判断</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-IF-%E8%AF%AD%E5%8F%A5%E8%AF%AD%E6%B3%95"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 IF 语句语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-IF-%E8%AF%AD%E5%8F%A5%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 IF 语句示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%8F%82%E6%95%B0-IN-OUT-INOUT"><span class="toc-number">1.7.</span> <span class="toc-text">七、参数 IN&#x2F;OUT&#x2F;INOUT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-IN-%E5%8F%82%E6%95%B0%EF%BC%88%E8%BE%93%E5%85%A5%EF%BC%89"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 IN 参数（输入）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-OUT-%E5%8F%82%E6%95%B0%EF%BC%88%E8%BE%93%E5%87%BA%EF%BC%89"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 OUT 参数（输出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-INOUT-%E5%8F%82%E6%95%B0%EF%BC%88%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%EF%BC%89"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 INOUT 参数（输入输出）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81CASE-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.8.</span> <span class="toc-text">八、CASE 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E7%AE%80%E5%8D%95-CASE"><span class="toc-number">1.8.1.</span> <span class="toc-text">8.1 简单 CASE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-%E6%90%9C%E7%B4%A2-CASE"><span class="toc-number">1.8.2.</span> <span class="toc-text">8.2 搜索 CASE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81WHILE-%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.9.</span> <span class="toc-text">九、WHILE 循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81REPEAT-%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.10.</span> <span class="toc-text">十、REPEAT 循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81LOOP-%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.11.</span> <span class="toc-text">十一、LOOP 循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E6%B8%B8%E6%A0%87-CURSOR"><span class="toc-number">1.12.</span> <span class="toc-text">十二、游标 CURSOR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-1-%E6%B8%B8%E6%A0%87%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.12.1.</span> <span class="toc-text">12.1 游标使用步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-2-%E6%B8%B8%E6%A0%87%E5%B5%8C%E5%A5%97"><span class="toc-number">1.12.2.</span> <span class="toc-text">12.2 游标嵌套</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F-HANDLER"><span class="toc-number">1.13.</span> <span class="toc-text">十三、条件处理程序 HANDLER</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#13-1-HANDLER-%E8%AF%AD%E6%B3%95"><span class="toc-number">1.13.1.</span> <span class="toc-text">13.1 HANDLER 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-2-HANDLER-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.13.2.</span> <span class="toc-text">13.2 HANDLER 示例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.</span> <span class="toc-text">十四、存储函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#14-1-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E8%AF%AD%E6%B3%95"><span class="toc-number">1.14.1.</span> <span class="toc-text">14.1 存储函数语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-2-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.14.2.</span> <span class="toc-text">14.2 存储函数示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-3-%E5%87%BD%E6%95%B0%E4%B8%8E%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.14.3.</span> <span class="toc-text">14.3 函数与存储过程的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%94%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.15.</span> <span class="toc-text">十五、小结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.15.1.</span> <span class="toc-text">核心知识点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">1.15.2.</span> <span class="toc-text">使用建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E4%B8%80%E7%AB%A0%E9%A2%84%E5%91%8A"><span class="toc-number">1.15.3.</span> <span class="toc-text">下一章预告</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/IDE%20%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE%EF%BC%9AVS%20Code%20+%20Jupyter%20+%20DataGrip/" title="IDE 工具配置：VS Code + Jupyter + DataGrip">IDE 工具配置：VS Code + Jupyter + DataGrip</a><time datetime="2026-02-24T15:00:00.000Z" title="发表于 2026-02-24 23:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Git%20%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E4%B8%8E%E5%9B%A2%E9%98%9F%E5%8D%8F%E4%BD%9C/" title="Git 版本控制与团队协作">Git 版本控制与团队协作</a><time datetime="2026-02-24T14:00:00.000Z" title="发表于 2026-02-24 22:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/Linux%20%E4%B8%8E%20Shell%EF%BC%88%E4%BA%8C%EF%BC%89Shell%20%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/" title="Linux 与 Shell（二）Shell 脚本编写">Linux 与 Shell（二）Shell 脚本编写</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E8%AF%A6%E8%A7%A3%20-%20%E7%BB%B4%E5%BA%A6%E5%BB%BA%E6%A8%A1%E3%80%81%E6%95%B0%E6%8D%AE%E5%88%86%E5%B1%82%E4%B8%8E%20SCD%20%E5%A4%84%E7%90%86/" title="数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理">数据仓库核心概念详解 - 维度建模、数据分层与 SCD 处理</a><time datetime="2026-02-24T13:00:00.000Z" title="发表于 2026-02-24 21:00:00">2026-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2026/02/24/MySQL%20%E8%BF%90%E7%BB%B4%E7%AF%87%2004-10%20MyCat%20%E7%AE%A1%E7%90%86%E4%B8%8E%E7%9B%91%E6%8E%A7/" title="MySQL 运维篇 04-10 MyCat 管理与监控">MySQL 运维篇 04-10 MyCat 管理与监控</a><time datetime="2026-02-24T12:05:00.000Z" title="发表于 2026-02-24 20:05:00">2026-02-24</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 过拟合的炸鱼薯条</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.4</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.4"></script><script src="/js/main.js?v=5.5.4"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索..." type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.4"></script></div></div></body></html>